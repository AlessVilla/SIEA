<!DOCTYPE html>
<html lang="en">
<!-- Descargar SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css">
<head>
  <!-- Agrega la biblioteca Google API Client Library para JavaScript -->
  <script src="https://apis.google.com/js/api.js"></script>
  <!-- incluir el plugin de anotación de Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.min.js"></script>
  <!-- Agrega el SDK de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
  <!-- Agrega el bloque del SDK de Firebase Realtime Database -->
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-database.js"></script>
  <!-- Agrega el bloque del SDK de Firebase Authentication -->
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-auth.js"></script>
  <!-- Agrega el bloque del SDK de Firebase Cloud Firestore -->
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-firestore.js"></script>
  <!-- Agrega la biblioteca para enviar correos en Email.js -->  
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <!-- Agrega la biblioteca para enviar correos por API Gmail -->  
  <script src="https://apis.google.com/js/client.js"></script>
  <!-- Agrega la biblioteca para enviar correos por SMTPJS -->  
  <script src="https://smtpjs.com/v3/smtp.js"></script>
  <!-- Importar el google auth provider para autenticar con google -->  
  <!-- <script import { GoogleAuthProvider } from "firebase/auth"></script> -->  
  <!-- Agrega la biblioteca para enviar correos por SMTPJS -->  
  <script src="https://smtpjs.com/v3/smtp.js"></script>
  <!-- Agrega la biblioteca Google API Client -->  
  <script src="https://apis.google.com/js/api.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <meta charset="utf-8">
  <link rel="stylesheet" href="style.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIEA 💚💙</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Incluir Chart.js desde una CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Incluir el archivo JavaScript desde la carpeta config dentro del repositorio -->
  <script>
    // firebase-config.js
    var firebaseConfig = {
        apiKey: "AIzaSyBoPvkQzuVG5LA_HXqw34MiHzB4Y3ro7Kw",
        authDomain: "bddreservaaneiapuninorte.firebaseapp.com",
        projectId: "bddreservaaneiapuninorte",
        storageBucket: "bddreservaaneiapuninorte.appspot.com",
        messagingSenderId: "227754886829",
        appId: "1:227754886829:web:00047755b1aaa727242824",
        measurementId: "G-S0LH1M6FQ4" // Esta línea es opcional, solo si estás utilizando Firebase Analytics
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
    const firestore = firebase.firestore();
  </script>

  <title>SIEA (Sistema Integral de Espacios ANEIAP)</title>
  <style>
    @font-face {
      font-family: 'Century Gothic';
      src: url('ruta/a/la/fuente/CenturyGothic.woff2') format('woff2'),
          url('ruta/a/la/fuente/CenturyGothic.woff') format('woff');
      /* Agrega más formatos de fuentes si es necesario */
      font-weight: normal;
      font-style: normal;
    }
    /* Estilos para el contenedor de la imagen */
    .centered-text {
      text-align: center;
    }
    .image-container {
      display: flex;
      justify-content: center;
      animation: slide-in 2s ease-in-out;
    }
    @keyframes slide-in {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(0);
      }
    }
    .image-container img {
      max-width: 15%;
      height: auto;
      transition: transform 6s ease-in-out;
    }
    .image-container img:hover {
      transform: rotate(4320deg);
    }
    /* Estilos para el cuadro de datos generales del evento */
    .datos-generales,
    .datos-organizador,
    .datos-ponente {
      background-color: rgb(253, 198, 166);
      padding: 10px;
      margin-bottom: 20px;
    }
    /* Estilos para los campos de formulario */
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      font-size: 18px;
    }
    select, textarea, input[type="text"], input[type="date"], input[type="email"], input[type="tel"] {
      width: 100%;
      margin-top: 5px;
      font-size: 18px;
    }
    h2 {
      font-size: 22px;
      text-transform: uppercase;
    }
    .reserva {
      background-color: darkgreen;
      color: white;
      padding: 5px 10px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      font-size: 20px;
    }
    .row {
      display: flex;
      justify-content: space-between;
    }
    .row .half {
      width: 48%;
    }
    .third {
      flex-basis: 33.33%;
      padding: 0 15px;
      box-sizing: border-box;
    }
    .disponibilidad-group {
      margin-bottom: 15px;
      background-color: #c3d6ff; /* Color de fondo azul muy claro */
      padding: 10px;
      border: 1px solid #0004ff; /* Borde azul */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }    
    .reservar-group {
      margin-bottom: 15px;
      background-color: #a8f7a1; /* Color de fondo verde muy claro */
      padding: 10px;
      border: 1px solid #15ff00; /* Borde verde claro */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }
    .editar-group {
      margin-bottom: 15px;
      background-color: #ffc67c; /* Color de fondo naranja muy claro */
      padding: 10px;
      border: 1px solid #ff9100; /* Borde naranja claro */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }
    .eliminar-group {
      margin-bottom: 15px;
      background-color: #fd8c8ca4; /* Color de fondo rojo muy claro */
      padding: 10px;
      border: 1px solid #ff0000a4; /* Borde rojo */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }
    .acordeon4-content-inner {
      margin-bottom: 15px;
      background-color: #D55DFF; /* Color de fondo rojo muy claro */
      padding: 10px;
      border: 1px solid #9900CC; /* Borde rojo */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }
    .actualizar-group {
      margin-bottom: 15px;
      background-color: #cccccc; /* Color de fondo rojo muy claro */
      padding: 10px;
      border: 1px solid #4d4d4d; /* Borde rojo */
      border-radius: 8px; /* Bordes redondeados para el contenedor */
    }
    .radio-buttons-container {
      display: flex;
      justify-content: center;
      gap: 20px; /* Espacio entre los botones SÍ y NO */
    }
    .custom-file-input {
      display: inline-block;
      position: relative;
    }
    .custom-file-input input[type="file"] {
      opacity: 0;
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      cursor: pointer;
    }
    .custom-file-input label {
      background-color: #3498db;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }    
    .field-container {
      background-color: #fff;
      padding: 10px; /* Ajusta el valor según el espacio deseado entre el contenido y el borde */
      border-radius: 5px; /* Ajusta el valor para cambiar la curvatura de las esquinas */
    }
    /* Estilos para los acordeones */
    .acordeon0, .acordeon1, .acordeon2, .acordeon3, .acordeon4, .acordeon5 {
      color: white;
      padding: 5px 10px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      font-size: 20px;
      margin-bottom: 10px;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    .acordeon0 {
      background-color: #307B98;
    }
    .acordeon0-content, .acordeon1-content, .acordeon2-content, .acordeon3-content, .acordeon4-content, .acordeon5-content {
      background-color: white;
      padding: 10px;
      margin-bottom: 20px;
    }
    .acordeon1 {
      background-color: #00B30F;
    }
    .acordeon2 {
      background-color: #F47B28;
    }
    .acordeon3 {
      background-color: #DC1E1E;
    }
    .acordeon4 {
      background-color: #600082;
    }
    .acordeon5 {
      background-color: #4d4d4d;
    }
    .button-consultar-disponibilidad, .button-reservar, .button-consultar, .button-consultar, .button-evaluar, .button-eliminar, .button-actualizar {
      color: white;
      padding: 5px 10px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      font-size: 18px;
      margin-bottom: 10px; /* Añadido para separar el botón de los campos */
      width: 353px; /* Ocupar el ancho del contenedor */
    }
    .button-consultar-disponibilidad {
      background-color: rgb(0, 4, 255);
    }
    .button-reservar {
      background-color: rgb(0, 141, 37);
    }
    .button-consultar {
      background-color: orange;
    }
    .button-eliminar {
      background-color: red;
    }
    .button-evaluar {
      background-color: #600082;
    }
    .button-actualizar {
      background-color: #4d4d4d;
    }
    /* Estilo para los campos de correo del forms y contraseña */
    input[type="email"],
    input[type="password"] {
      font-size: 18px; /* Mismo tamaño de fuente que el botón */
      padding: 5px 10px;
      margin-bottom: 10px; /* Espaciado inferior */
      width: 150px; /* Ocupar el ancho del contenedor */
    }
    .disponibilidad-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .disponibilidad-item {
      width: 100px;
      height: 50px;
      margin: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-weight: bold;
      font-size: 16px;
    }
    .disponibilidad-item.green {
      background-color: green;
    }
    .disponibilidad-item.red {
      background-color: red;
    }
    .disponibilidad-item.gray {
      background-color: rgb(185, 185, 185);
    }
    /* Estilos para las pestañas */
    .tab-container {
      display: flex;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border: 1px solid #9900CC;
      background-color: #f7d1f3;
      border-radius: 8px 8px 0 0;
    }
    .tab:hover {
      background-color: #f0f0f0;
    }
    /* Estilos para los contenidos de las pestañas */
    .tab-content {
      display: none;
      padding: 10px;
      border: 3px solid #D55DFF;
      background-color: #f7d1f3;
      border-radius: 20 20px 20px 20px;
      width: 100%
    }
    /* Mostrar el contenido de la pestaña activa */
    .tab-content.active {
      display: block;
    }    
    /* Estilos para el botón */
    #modo-switch {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 60px; /* Aumenta el ancho del botón */
      height: 40px; /* Aumenta la altura del botón */
      background-color: #777777; /* Color de fondo del botón en light mode */
      border-radius: 50%; /* Hace que el botón sea circular */
      cursor: pointer;
      border: none;
      outline: none;
      padding: 2px;
      display: flex; /* Para centrar verticalmente el emoji */
      justify-content: center; /* Para centrar horizontalmente el emoji */
      align-items: center; /* Para centrar verticalmente el emoji */
    }
    /* Estilos para el ícono del sol */
    .icon::before {
      content: "\2600"; /* Código Unicode para el sol */
      font-size: 28px; /* Aumenta el tamaño del emoji */
      color: #ffcc00; /* Color del sol en light mode */
      display: inline-block;
    }
    /* Estilos para el ícono de la luna */
    .dark-mode .icon::before {
      content: "\1F319"; /* Código Unicode para la luna */
      color: #333; /* Color de la luna en dark mode */
    }
    body.light-mode {
      background-color: white; /* Fondo blanco en el modo claro */
      transition: background-color 1s ease; /* Efecto de transición suave */
    }
    body.dark-mode {
      background-color: rgb(29, 29, 29); /* Fondo negro en el modo oscuro */
      transition: background-color 1s ease; /* Efecto de transición suave */
    }
    body {
      transition: background-color 1s ease; /* Efecto de transición suave para todo el cuerpo */
      font-family: 'Century Gothic', sans-serif;
    }
    /* Estilo del texto en modo claro */
    .light-mode {
      color: black; /* Color del texto en modo claro */
    }
    .logo.dark-mode {
      display: none; /* Oculta el logo del dark mode por defecto */
    }
    /* Estilo del texto en modo oscuro */
    .dark-mode .light-mode {
      color: white; /* Color del texto en modo oscuro */
    }
    /* Estilos para los títulos de documentos */
    .document-title a {
      text-decoration: none;
      color: black;
      font-weight: bold;
    }
    /* Estilos para los enlaces "AQUÍ" */
    .document-link a {
      text-decoration: none;
      color: blue;
      font-weight: bold;
    }
    /* Estilos para el icono de Word */
    .document-link img {
      width: 16px;
      height: 16px;
      margin-left: 5px;
    }
    .swal2-content {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .swal2-input {
      width: 100%;
      box-sizing: border-box;
      margin-bottom: 10px; /* Ajusta según sea necesario */
    }
    /* Estilos para la tabla resumen */
    #tabla-resumen {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        overflow-x: auto; /* Permitir desplazamiento horizontal */
    }
    #tabla-resumen-container {
    width: 100%;
    overflow-x: auto; /* Permitir desplazamiento horizontal si es necesario */
    }
    #tabla-resumen th,
    #tabla-resumen td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }
    #tabla-resumen th {
        background-color: #76c04e;
    }
    #tabla-resumen tbody tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    #tabla-resumen tbody tr:hover {
        background-color: #76c04e;
        transition: background-color 0.3s ease;
    }
    #tabla-resumen td:nth-child(n + 8) {
        text-align: center;
    }
    #tabla-resumen td:nth-child(13) {

        font-size: 10px;
        overflow: hidden;
    }
    /* Ajuste de anchos de columnas */
    #tabla-resumen th,
    #tabla-resumen td {
        width: auto; /* Permitir que las columnas se ajusten automáticamente */
    }
    #tabla-evaluaciones {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    overflow-x: auto; /* Permitir desplazamiento horizontal */
    }
    #tabla-evaluaciones th,
    #tabla-evaluaciones td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }
    #tabla-evaluaciones th {
        background-color: #76c04e;
    }
    #tabla-evaluaciones tbody tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    #tabla-evaluaciones tbody tr:hover {
        background-color: #76c04e;
        transition: background-color 0.3s ease;
    }
    /* Ajuste de anchos de columnas */
    #tabla-evaluaciones th,
    #tabla-evaluaciones td {
        width: auto; /* Permitir que las columnas se ajusten automáticamente */
    }
    /* Alineación de columnas */
    #tabla-evaluaciones td:nth-child(1),
    #tabla-evaluaciones td:nth-child(2),
    #tabla-evaluaciones td:nth-child(7) {
        text-align: left; /* Columnas de nombre del asistente, correo asistente y comentarios alineadas a la izquierda */
    }
    #tabla-evaluaciones td {
        text-align: center; /* Resto de columnas centradas */
    }
    /* Estilos para el contenedor del calendario */
    #calendario-semanal {
      margin: 20px auto; /* Margen externo para centrar el calendario */
      width: 100%; /* Ancho del calendario */
    }
    /* Estilos para la tabla del calendario */
    .calendario-semanal-table {
      width: 100%; /* Ancho de la tabla */
      border-collapse: collapse; /* Colapso de bordes de celda */
    }
    /* Estilos para las celdas del encabezado */
    .calendario-semanal-table th {
      background-color: #618796; /* Color de fondo */
      padding: 10px; /* Espaciado interno */
      text-align: left; /* Alineación de texto a la izquierda */
      border-bottom: 1px solid #ddd; /* Borde inferior */
      color: #fff; /* Color del texto */
    }
    /* Estilos para las celdas del cuerpo */
    .calendario-semanal-table td {
      padding: 10px; /* Espaciado interno */
      border-bottom: 1px solid #ddd; /* Borde inferior */
    }
    /* Estilos para las filas impares del cuerpo */
    .calendario-semanal-table tbody tr:nth-child(odd) {
      background-color: #f9f9f9; /* Color de fondo para filas impares */
    }
    /* Estilos para la primera columna (día de la semana) */
    .calendario-semanal-table tbody td:first-child {
      width: 15%; /* Ancho del 10% para la primera columna */
    }
    /* Estilos para la segunda columna (eventos reservados) */
    .calendario-semanal-table tbody td:nth-child(2) {
      width: 85%; /* Ancho del 90% para la segunda columna */
      margin: 0; /* Eliminar margen interno del párrafo */
    }
    /* Estilos para las filas al pasar el mouse */
    .calendario-semanal-table tbody tr:hover {
      background-color: #76c04e; /* Cambio de color al pasar el mouse */
      cursor: pointer; /* Cambio de cursor al pasar el mouse */
    }
    /* Estilos para centrar los encabezados */
    .calendario-semanal-table th {
      text-align: center; /* Alineación centrada */
    }

  </style>
</head>
<body class="dark-mode">

  <!-- Formulario con campos de correo, contraseña y botón para inicar sesión-->
  <form>
    <input type="email" id="correo" name="correo" required placeholder="Correo ANEIAP">
    <input type="password" id="contrasena" name="contrasena" required placeholder="Contraseña">
  </form>
  <button type="button" class="button-consultar" onclick="validar_login()">Iniciar Sesión</button>
  <!-- Elemento para mostrar el saludo -->
  <div id="saludoUsuario" style="color: orange;">¡Hola, ANEIAPo!</div>

  <!-- Proceso para insertar el logo de la herramienta de SIEA y adicionalmente detalles iniciales y generales de la página -->
  <h1 style="text-align: center;" class="light-mode">Bienvenido a SIEA (Sistema Integral de Espacios ANEIAP)</h1>

    <!-- Botón de modo de visualización-->
    <button id="modo-switch" class="light-mode">
      <span class="icon"></span>
    </button>
  <div class="image-container">
    <img src="https://i.ibb.co/WGC5G0Y/Copia-de-Logos-proyectos-2023-2-4.png" alt="Logo Light Mode" class="logo light-mode">
    <img src="https://i.ibb.co/Wt7rx9Y/Equipo-Nacional-de-Datos-1.png" alt="Logo Dark Mode" class="logo dark-mode">
  </div>
  <!-- Las pestañas para tener contactos,  -->
  <div class="tab-container">
    <div class="tab" onclick="showTab(1)"><b>CONTÁCTANOS</b></div>
    <div class="tab" onclick="showTab(2)"><b>CRÉDITOS</b></div>
    <div class="tab" onclick="showTab(3)"><b>⬅️</b></div>
    <!-- Agrega más pestañas según sea necesario -->

      <div id="tab-content-1" class="tab-content">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <h2 style="margin: 0;">GENERA UN TICKET PARA OBTENER AYUDA DEL ADMINISTRADOR 🎟️</h2>
          <div style="text-align: right;">
            <button style="width: 150px; height: 20px;" onclick="enviarTicket()">ENVIAR TICKET</button>
            <br>
            <button style="width: 150px; height: 20px;" onclick="limpiarTicket()">BORRAR TODO</button>
          </div>
        </div>
            <!-- PRIMERA FILA DE LA SECCIÓN TICKET CON NOMBRE, CORREO Y TIPO DE TICKET -->
            <div class="disponibilidad-group">
            <div class="row">
                <div class="third">
                    <!-- CAMPO PARA NOMBRE QUE ES OBLIGATORIO -->
                    <label for="nombre">Nombre Completo *</label>
                    <input type="text" id="nombre" name="nombre" required placeholder="Tu nombre completo">
                </div>
                <div class="third">
                    <!-- CAMPO PARA COLOCAR EL CORREO ANEIAP (DEBE TERMINAR EN @ANEIAP.CO) -->
                    <label for="correo-ticket">Correo ANEIAP *</label>
                    <input type="text" id="correo-ticket" name="correo" required placeholder="Tu correo ANEIAP para el caso" pattern="^[a-zA-Z0-9._%+-]+@aneiap\.co$">
                </div>
                <div class="third">
                    <!-- CAMPO PARA EL TIPO DEL TICKET (ES UNA LISTA DESPLEGABLE) -->
                    <label for="tipo-ticket">Tipo de Ticket *</label>
                    <select id="tipo-ticket" name="tipo-ticket" required>
                      <option value="" disabled selected>Seleccione un tipo</option>
                      <option value="Consulta General">Consulta General</option>
                      <option value="Problema Técnico">Problema Técnico</option>
                      <option value="Solicitud de Características">Solicitud de Características</option>
                      <option value="Error en la Aplicación">Error en la Aplicación</option>
                      <option value="Asistencia de Reserva">Asistencia de Cuenta</option>
                      <option value="Solicitud de Capacitación">Solicitud de Capacitación</option>
                      <option value="Reporte de Abuso o Violación de Políticas">Reporte de Abuso o Violación de Políticas</option>
                      <option value="Otros">Otros</option>
                        <!-- Agrega más opciones según sea necesario -->
                    </select>
                </div>
            </div>
            <!-- SEGUNDA FILA DE LA SECCIÓN TICKET CON EXPLICACIÓN DEL CASO, CELULAR Y LINK DE DRIVE PARA EVIDENCIAS -->
            <div class="row">
                <div class="third">
                    <!-- CAMPO DONDE EL USUARIO ESCRIBIRÁ DE FORMA MUY DETALLADA LO QUE OCURRIÓ EN EL CASO -->
                    <label for="explicacion">Explicación del Caso *</label>
                    <textarea id="explicacion" name="explicacion" rows="1" required placeholder="Describe detalladamente tu caso"></textarea>
                </div>
                <div class="third">
                    <!-- CAMPO DONDE EL USUARIO ESCRIBIRÁ SU NÚMERO DE CELUAR, DEBE SER UN VALOR QUE EMPIECE EN 3 Y TENGA EN TOTAL 10 DÍGITOS -->
                    <label for="celular">Número de Celular *</label>
                    <input type="tel" id="celular" name="celular" required placeholder="Digita tu número de celular" pattern="^3\d{9}$">
                </div>
                <div class="third">
                    <!-- CAMPO DONDE SE ADJUNTARÁ UN LINK DE GOOGLE DRIVE VÁLIDO (OPCIONAL) -->
                    <label for="link-drive">Drive Evidencias</label>
                    <textarea id="link-drive" name="link-drive" rows="1" required placeholder="Adjunta link de evidencias en Drive"></textarea>
                </div>
            </div>
          </div>
        </p>
        <h2>INSTRUCCIONES GENERALES 📖</h2>
        <p>
          <div class="disponibilidad-group">
            <div class="row">
            <div class="half">
            <label for="texto2"><b>1️⃣ Todo campo con un asterisco (*) es obligatorio.</b></label>
            <label for="texto3"><b>3️⃣ Las reservas se aprobarán o rechazarán automáticamente dependiendo de la disponibilidad.</b></label>
            </div>
            <div class="half">
            <label for="texto4"><b>2️⃣ Las claves de eventos son personales e intransferibles.</b></label>
            <label for="texto5"><b>4️⃣ Si eliminas una reserva, la perderás para siempre. Todas las reservas mantienen su prioridad incluso si las editas.</b></label>
            </div>
            </div>
          </div>
        </p>
      </div>

      <div id="tab-content-2" class="tab-content">
        <h2>CRÉDITOS, PROPIEDAD Y DOCUMENTACIÓN 💾</h2>
        <p>
          <div class="disponibilidad-group">
          <label for="texto6"><b>- Herramienta creada por Alessandro Villanueva Cantillo, miembro profesional capítulo UNINORTE, puedes dar tus sugerencias, preguntas, reclamos e inquietudes sobre la herramienta al dar click "<a href="http://wa.me/3002252099" target="_blank">AQUÍ</a>"</b></label>
          <label for="texto7"><b>- 🧡 Sé consciente de lo que tenemos y no abuses de la herramienta creando reservas de forma innecesaria o editándola muchas veces, la herramienta tiene limitaciones de almacenamiento y por cada transacción se va agotando 🧡.</b></label>
          <label for="texto8"><b>- Agradecimientos a Said Yanett UNINORTE (logo).</b></label>

          <h2>CONSULTA AQUÍ LA DOCUMENTACIÓN DE SIEA 👇🏽📚</h2>
          <p>
            <!--<div class="disponibilidad-group">-->
            <div class="row">
              <!-- Primer documento -->
              <div class="third">
                <div class="document">
                  <div class="document-info">
                    <div class="document-title">
                      <a href="https://docs.google.com/document/d/1iTie_bVnFOtKuowy-cCEVALB_oqwg13c/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">🤍 MANUAL DE USUARIO</a>
                    </div>
                    <div class="document-link">
                      <img src="https://i.ibb.co/6DmT312/microsoft-word-macos-bigsur-icon.png" alt="Icono de Word">
                      <a href="https://docs.google.com/document/d/1iTie_bVnFOtKuowy-cCEVALB_oqwg13c/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">AQUÍ</a>
                    </div>
                  </div>
                </div>
              </div>
        
              <!-- Segundo documento -->
              <div class="third">
                <div class="document">
                  <div class="document-info">
                    <div class="document-title">
                      <a href="https://docs.google.com/document/d/1xsZgOV8BIxjP31iFnsVrf9Qbf604Wqx_/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">💙 MANUAL ADMINISTRADOR</a>
                    </div>
                    <div class="document-link">
                      <img src="https://i.ibb.co/6DmT312/microsoft-word-macos-bigsur-icon.png" alt="Icono de Word">
                      <a href="https://docs.google.com/document/d/1xsZgOV8BIxjP31iFnsVrf9Qbf604Wqx_/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">AQUÍ</a>
                    </div>
                  </div>
                </div>
              </div>
        
              <!-- Tercer documento -->
              <div class="third">
                <div class="document">
                  <div class="document-info">
                    <div class="document-title">
                      <a href="https://docs.google.com/document/d/19dzW0FTPuVoviKiUzshE6tU1HedSrPox/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">🖤 POLÍTICAS DE DATOS</a>
                    </div>
                    <div class="document-link">
                      <img src="https://i.ibb.co/6DmT312/microsoft-word-macos-bigsur-icon.png" alt="Icono de Word">
                      <a href="https://docs.google.com/document/d/19dzW0FTPuVoviKiUzshE6tU1HedSrPox/edit?usp=drive_link&ouid=117265505210218235288&rtpof=true&sd=true" target="_blank">AQUÍ</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--</div>-->
          </p>
          
          </div>
        </p>
      </div>

      <div id="tab-content-3" class="tab-content">
        <h2></h2>
        <p>
        </p>
      </div>
      <!-- Agrega más contenidos de pestañas según sea necesario -->
  </div>

  <script src="script.js"></script>
  <div class="main-content">
    <!-- El contenido principal de tu página va aquí -->
  </div>

  <!-- DETALLES DEL ACORDEÓN 0 QUE CORRESPONDE A CONSULTAR LA DISPONIBILIDAD DEL CAPÍTULO EN CIERTA(S) FECHA(S)-->
  <div class="acordeon0" onclick="toggleConsultaDisponibilidad()">CLICK AQUÍ PARA CONSULTAR DISPONIBILIDAD 🔍</div>
  <div id="acordeon0-content" style="display: none;">
    <div class="acordeon0-content-inner">
      <div class="disponibilidad-group">
        <button id="alternarConsulta" class="boton-alternar-consulta" onclick="alternarConsulta()">Consultar disponibilidad semanal</button>
        <div id="consultaDiaria" style="display: block;">
          <div class="row">
            <!-- Mitad izquierda con el campo para seleccionar la fecha -->
            <div class="half">
              <label for="fecha-consulta"><b>Selecciona el día en el que deseas consultar la disponibilidad: *</b></label>
              <input type="date" id="fecha-consulta" placeholder="Selecciona la fecha para consultar la disponibilidad.">
            </div>
            <!-- Mitad derecha con el campo para seleccionar el capítulo -->
            <div class="half">
              <label for="capitulo-consulta"><b>Capítulo del que deseas consultar disponibilidad: *</b></label>
              <select id="capitulo-consulta">
                <option value="" disabled selected hidden>Selecciona el capítulo para el que aplica la reserva.</option>
                <option value="uniguajira">UNIGUAJIRA</option>
                <option value="unimagdalena">UNIMAGDALENA</option>
                <option value="uniatlantico">UNIATLÁNTICO</option>
                <option value="uninorte">UNINORTE</option>
                <option value="cuc">CUC</option>
                <option value="librequilla">LIBREQUILLA</option>
                <option value="utb">UTB</option>
                <option value="ufps">UFPS</option>
                <option value="unalmed">UNALMED</option>
                <option value="udea">UDEA</option>
                <option value="upbmed">UPBMED</option>
                <option value="utp">UTP</option>
                <option value="unalma">UNALMA</option>
                <option value="udistrital">UDISTRITAL</option>
                <option value="unalbog">UNALBOG</option>
                <option value="univalle">UNIVALLE</option>
                <option value="icesi">ICESI</option>
                <option value="usc">USC</option>
                <option value="librecali">LIBRECALI</option>
                <option value="nacional">ANEIAP NACIONAL</option>
              </select>
            </div>
          </div>
          <button class="button-consultar-disponibilidad" onclick="ConsultarDisponibilidadReservas()">Consultar disponibilidad diaria</button>
          <div class="disponibilidad-container">
            <!-- Lógica para mostrar la disponibilidad -->
            <div class="disponibilidad-item gray">08:00 - 08:30</div>
            <div class="disponibilidad-item gray">08:30 - 09:00</div>
            <div class="disponibilidad-item gray">09:00 - 09:30</div>
            <div class="disponibilidad-item gray">09:30 - 10:00</div>
            <div class="disponibilidad-item gray">10:00 - 10:30</div>
            <div class="disponibilidad-item gray">10:30 - 11:00</div>
            <div class="disponibilidad-item gray">11:00 - 11:30</div>
            <div class="disponibilidad-item gray">11:30 - 12:00</div>
            <div class="disponibilidad-item gray">12:00 - 12:30</div>
            <div class="disponibilidad-item gray">12:30 - 13:00</div>
            <div class="disponibilidad-item gray">13:00 - 13:30</div>
            <div class="disponibilidad-item gray">13:30 - 14:00</div>
            <div class="disponibilidad-item gray">14:00 - 14:30</div>
            <div class="disponibilidad-item gray">14:30 - 15:00</div>
            <div class="disponibilidad-item gray">15:00 - 15:30</div>
            <div class="disponibilidad-item gray">15:30 - 16:00</div>
            <div class="disponibilidad-item gray">16:00 - 16:30</div>
            <div class="disponibilidad-item gray">16:30 - 17:00</div>
            <div class="disponibilidad-item gray">17:00 - 17:30</div>
            <div class="disponibilidad-item gray">17:30 - 18:00</div>
            <div class="disponibilidad-item gray">18:00 - 18:30</div>
            <div class="disponibilidad-item gray">18:30 - 19:00</div>
            <div class="disponibilidad-item gray">19:00 - 19:30</div>
            <div class="disponibilidad-item gray">19:30 - 20:00</div>
            <div class="disponibilidad-item gray">20:00 - 20:30</div>
            <div class="disponibilidad-item gray">20:30 - 21:00</div>
            <div class="disponibilidad-item gray">21:00 - 21:30</div>
            <div class="disponibilidad-item gray">21:30 - 22:00</div>
          </div>
          <label for="eventos-programados"><b>Acá aparecerán la lista de eventos programados para el capítulo en esa fecha:</b></label>
          <div class="disponibilidad-group">
            <div id="eventos-programados"></div>
          </div>
        </div>
    <!-- Nueva sección semanal dentro del acordeón 0 -->
    <div id="consultaSemanal" style="display: none;">
        <div class="row">
          <!-- Parte para seleccionar la fecha -->
          <div class="half">
            <label for="fecha-consulta-semanal"><b>Selecciona el día en el que deseas consultar la disponibilidad: *</b></label>
            <input type="date" id="fecha-consulta-semanal" placeholder="Selecciona la fecha para consultar la disponibilidad.">
            <button class="button-consultar-disponibilidad" onclick="ConsultarDisponibilidadSemanal()">Consultar disponibilidad semanal</button>
          </div>
          <!-- Parte para seleccionar el capítulo -->
          <div class="half">
            <label for="capitulo-consulta-semanal"><b>Capítulo del que deseas consultar disponibilidad: *</b></label>
            <select id="capitulo-consulta-semanal">
              <option value="" disabled selected hidden>Selecciona el capítulo para el que aplica la reserva.</option>
              <option value="uniguajira">UNIGUAJIRA</option>
              <option value="unimagdalena">UNIMAGDALENA</option>
              <option value="uniatlantico">UNIATLÁNTICO</option>
              <option value="uninorte">UNINORTE</option>
              <option value="cuc">CUC</option>
              <option value="librequilla">LIBREQUILLA</option>
              <option value="utb">UTB</option>
              <option value="ufps">UFPS</option>
              <option value="unalmed">UNALMED</option>
              <option value="udea">UDEA</option>
              <option value="upbmed">UPBMED</option>
              <option value="utp">UTP</option>
              <option value="unalma">UNALMA</option>
              <option value="udistrital">UDISTRITAL</option>
              <option value="unalbog">UNALBOG</option>
              <option value="univalle">UNIVALLE</option>
              <option value="icesi">ICESI</option>
              <option value="usc">USC</option>
              <option value="librecali">LIBRECALI</option>
              <option value="nacional">ANEIAP NACIONAL</option>
            </select>
          </div>
        </div>
        <p id="semana-seleccionada"></p>
        <div id="calendario-semanal">
          <table class="calendario-semanal-table">
            <thead>
              <tr>
                <th style="width: 15%;">Día de la semana</th>
                <th style="width: 85%;">Eventos reservados</th>
              </tr>
            </thead>
            <tbody id="cuerpo-calendario-semanal">
              <!-- Las filas se generarán dinámicamente con JavaScript -->
            </tbody>
          </table>
        </div>
        <div id="espacios-programados-semanal">
          <!-- Aquí se mostrará la lista de espacios reservados para la semana -->
        </div>
      </div>
    </div>
    <!-- Fin de la sección semanal -->
    </div>
  </div>
  <!-- DETALLES DEL ACORDEÓN 1 QUE CORRESPONDE A REGISTRAR LA RESERVA DEL EVENTO-->
  <div class="acordeon1" onclick="window.location.href = 'https://alessvilla.github.io/SIEA/public/index_reservar.html'">CLICK AQUÍ PARA REGISTRAR TU EVENTO ✏️</div>
  <div id="acordeon1-content" style="display: none;">
    <div class="acordeon1-content-inner">
      <div class="reservar-group">
      <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS GENERALES DEL EVENTO 🦉</p></h2>
      <div class="row">
      <div class="half">
      <label for="nombre-evento"><b>Nombre del evento: *</b></label>
      <input type="text" id="nombre-evento" placeholder="Ingresa el nombre de tu evento.">
      <label for="fecha-evento"><b>Fecha del evento: *</b></label>
      <input type="date" id="fecha-evento">
      <label for="hora-evento"><b>Hora del evento: *</b></label>
      <select id="hora-evento">
        <option value="" disabled selected hidden>Selecciona la hora de la reserva.</option>
        <option value="480">08:00</option>
        <option value="510">08:30</option>
        <option value="540">09:00</option>
        <option value="570">09:30</option>
        <option value="600">10:00</option>
        <option value="630">10:30</option>
        <option value="660">11:00</option>
        <option value="690">11:30</option>
        <option value="720">12:00</option>
        <option value="750">12:30</option>
        <option value="780">13:00</option>
        <option value="810">13:30</option>
        <option value="840">14:00</option>
        <option value="870">14:30</option>
        <option value="900">15:00</option>
        <option value="930">15:30</option>
        <option value="960">16:00</option>
        <option value="990">16:30</option>
        <option value="1020">17:00</option>
        <option value="1050">17:30</option>
        <option value="1080">18:00</option>
        <option value="1110">18:30</option>
        <option value="1140">19:00</option>
        <option value="1170">19:30</option>
        <option value="1200">20:00</option>
        <option value="1230">20:30</option>
        <option value="1260">21:00</option>
      </select>
      </div>
      <div class="half">
      <label for="duracion-evento"><b>Duración del evento (en horas): *</b></label>
      <select id="duracion-evento">
        <option value="" disabled selected hidden>Selecciona la duración del evento.</option>
        <option value="30">media hora</option>
        <option value="60">1 hora</option>
        <option value="90">1 hora y media</option>
        <option value="120">2 horas</option>
        <option value="150">2 horas y media</option>
        <option value="180">3 horas</option>
        <option value="210">3 horas y media</option>
        <option value="240">4 horas</option>
        <option value="270">4 horas y media</option>
        <option value="300">5 horas</option>
        <option value="330">5 horas y media</option>
        <option value="360">6 horas</option>
      </select>
      <label for="modalidad-evento"><b>Modalidad del evento: *</b></label>
      <select id="modalidad-evento" onchange="toggleUbicacionPlataforma()">
        <option value="" disabled selected hidden>Selecciona la modalidad del evento.</option>
        <option value="virtual">Virtual</option>
        <option value="presencial">Presencial</option>
      </select>
      <div id="ubicacion-plataforma-container" style="display: none;">
        <label for="ubicacion-plataforma"><b>Ubicación/Plataforma en la reserva: *</b></label>
        <select id="ubicacion-plataforma">
          <option value="" disabled selected hidden>Selecciona la plataforma para el evento.</option>
          <option value="meet">Meet</option>
          <option value="zoom">Zoom</option>
          <option value="teams">Teams</option>
          <option value="otro">Otro</option>
        </select>
      </div>
      <div id="lugar-presencial-container" style="display: none;">
        <label for="lugar-presencial"><b>Especifica el lugar físico del evento en la reserva: *</b></label>
        <input type="text" id="lugar-presencial" placeholder="Escribe el lugar donde el evento se realizará.">
      </div>
      </div>
      </div>
      <div class="row">
      <div class="half">
      <label for="plan-evento"><b>Plan del evento: *</b></label>
      <textarea id="plan-evento" rows="5" placeholder="Detalla el paso a paso de lo que se realizará en el evento y cuáles son las estrategias para garantizar que este sí se lleve a cabo de forma exitosa."></textarea>
      </div>
      <div class="half">
      <label for="observaciones-evento"><b>Observaciones del evento:</b></label>
      <textarea id="observaciones-evento" rows="5" placeholder="Especifica cualquier observación adicional que desees que sea tenida en cuenta para el desarrollo del evento."></textarea>
      </div>
      </div>
      <div class="row">
        <div class="half">
          <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS DEL ORGANIZADOR</p></h2>
          <label for="nombre-organizador"><b>Nombre del organizador: *</b></label>
          <input type="text" id="nombre-organizador" placeholder="Ingresa tu nombre.">
          <div class="row">
            <div class="half">
                <label for="email-organizador"><b>Email del organizador: *</b></label>
                <input type="text" id="email-organizador" placeholder="Ingresa tu email.">
            </div>
            <div class="half">
                <label for="capitulo-organizador"><b>Capítulo del organizador: *</b></label>
                <select id="capitulo-organizador">
                  <option value="" disabled selected hidden>Selecciona el capítulo para el que aplica la reserva.</option>
                  <option value="uniguajira">UNIGUAJIRA</option>
                  <option value="unimagdalena">UNIMAGDALENA</option>
                  <option value="uniatlantico">UNIATLÁNTICO</option>
                  <option value="uninorte">UNINORTE</option>
                  <option value="cuc">CUC</option>
                  <option value="librequilla">LIBREQUILLA</option>
                  <option value="utb">UTB</option>
                  <option value="ufps">UFPS</option>
                  <option value="unalmed">UNALMED</option>
                  <option value="udea">UDEA</option>
                  <option value="upbmed">UPBMED</option>
                  <option value="utp">UTP</option>
                  <option value="unalma">UNALMA</option>
                  <option value="udistrital">UDISTRITAL</option>
                  <option value="unalbog">UNALBOG</option>
                  <option value="univalle">UNIVALLE</option>
                  <option value="icesi">ICESI</option>
                  <option value="usc">USC</option>
                  <option value="librecali">LIBRECALI</option>
                  <option value="nacional">ANEIAP NACIONAL</option>
                </select>
            </div>
          </div>
          <label for="telefono-organizador"><b>Teléfono del organizador: *</b></label>
          <input type="tel" id="telefono-organizador" placeholder="Ingresa tu número de teléfono.">
        </div>
        <div class="half">
          <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS DEL PONENTE</p></h2>
          <label for="nombre-ponente"><b>Nombre del ponente: *</b></label>
          <input type="text" id="nombre-ponente" placeholder="Ingresa el nombre del ponente.">
          <label for="email-ponente"><b>Email del ponente:</b></label>
          <input type="text" id="email-ponente" placeholder="Ingresa el email del ponente.">
          <label for="telefono-ponente"><b>Teléfono del ponente:</b></label>
          <input type="tel" id="telefono-ponente" placeholder="Ingresa el número de teléfono del ponente.">
        </div>
      </div>
      <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS PARA EL COMITÉ DE PIEZAS</p></h2>
      <div class="row">
        <div class="third">
          <label for="publicidad-comite"><b>¿Deseas que el comité de piezas capitular te realice la publicidad del espacio? *</b></label>
          <select id="publicidad-comite">
            <option value="si">SÍ</option>
            <option value="no">NO</option>
          </select>
        </div>
        <div class="third">
          <label for="observaciones-publicidad"><b>Observaciones a tener en cuenta para que el comité de piezas tenga en cuenta al hacer tu publicidad:</b></label>
          <textarea id="observaciones-publicidad" rows="1" placeholder="Ingresa observaciones para la publicidad del evento."></textarea>
        </div>
        <div class="third">
          <label for="foto-ponente"><b>Enlace de Google Drive de la foto del ponente para que el comité de publicidad la coloque en la pieza:</b></label>
          <input type="text" id="foto-ponente" placeholder="Ingresa el enlace de Google Drive, debe estar compartido para cualquier correo.">
        </div>
      </div>
      <button class="button-reservar" onclick="registrarEvento()">Registrar evento</button>
      </div>
    </div>
  </div>
  <!-- DETALLES DEL ACORDEÓN 2 QUE CORRESPONDE A CONSULTAR LA RESERVA DE UN EVENTO-->
  <div class="acordeon2" onclick="toggleEditarReserva()">CLICK AQUÍ PARA EDITAR TU RESERVA 📝</div>
  <div id="acordeon2-content" style="display: none;">
    <div class="acordeon2-content-inner">
      <div class="editar-group">
      <label for="clave-evento-reserva"><b>Digita la clave del evento en la reserva: *</b></label>
      <input type="text" id="clave-evento-reserva" placeholder="Ingresa la clave del evento que fue enviada a tu correo de forma automática al momento de reservar el espacio.">
      
      <button class="button-consultar" onclick="consultarReserva()">Consultar reserva</button>
      </div>

      <!-- Campos para la consulta de reserva -->
      <div id="datos-reserva-container" style="display: none;">
        <div class="editar-group">
        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS DE TU RESERVA 📚</p></h2>
        <div class="row">
        <div class="half">
        <label for="nombre-evento-reserva"><b>Nombre del evento en la reserva: *</b></label>
        <input type="text" id="nombre-evento-reserva" placeholder="Acá aparecerá el nombre del evento de la reserva.">
        <label for="fecha-evento-reserva"><b>Fecha del evento en la reserva: *</b></label>
        <input type="date" id="fecha-evento-reserva">
        <label for="hora-evento-reserva"><b>Hora del evento en la reserva: *</b></label>
        <select id="hora-evento-reserva">
            <option value="" disabled selected hidden>Selecciona la hora que tiene la reserva.</option>
            <option value="480">08:00</option>
            <option value="510">08:30</option>
            <option value="540">09:00</option>
            <option value="570">09:30</option>
            <option value="600">10:00</option>
            <option value="630">10:30</option>
            <option value="660">11:00</option>
            <option value="690">11:30</option>
            <option value="720">12:00</option>
            <option value="750">12:30</option>
            <option value="780">13:00</option>
            <option value="810">13:30</option>
            <option value="840">14:00</option>
            <option value="870">14:30</option>
            <option value="900">15:00</option>
            <option value="930">15:30</option>
            <option value="960">16:00</option>
            <option value="990">16:30</option>
            <option value="1020">17:00</option>
            <option value="1050">17:30</option>
            <option value="1080">18:00</option>
            <option value="1110">18:30</option>
            <option value="1140">19:00</option>
            <option value="1170">19:30</option>
            <option value="1200">20:00</option>
            <option value="1230">20:30</option>
            <option value="1260">21:00</option>
        </select>
        </div>
        <div class="half">
        <label for="duracion-evento-reserva"><b>Duración del evento en la reserva (en horas): *</b></label>
        <select id="duracion-evento-reserva">
            <option value="" disabled selected hidden>Selecciona la duración de la reserva.</option>
            <option value="30">media hora</option>
            <option value="60">1 hora</option>
            <option value="90">1 hora y media</option>
            <option value="120">2 horas</option>
            <option value="150">2 horas y media</option>
            <option value="180">3 horas</option>
            <option value="210">3 horas y media</option>
            <option value="240">4 horas</option>
            <option value="270">4 horas y media</option>
            <option value="300">5 horas</option>
            <option value="330">5 horas y media</option>
            <option value="360">6 horas</option>
        </select>
        <label for="modalidad-evento-reserva"><b>Modalidad del evento en la reserva: *</b></label>
        <select id="modalidad-evento-reserva" onchange="toggleUbicacionPlataformaReserva()">
            <option value="" disabled selected hidden>Selecciona la modalidad que colocaste en la reserva.</option>
          <option value="virtual">Virtual</option>
          <option value="presencial">Presencial</option>
        </select>
        <div id="ubicacion-plataforma-reserva-container" style="display: none;">
          <label for="ubicacion-plataforma-reserva"><b>Ubicación/Plataforma en la reserva: *</b></label>
          <select id="ubicacion-plataforma-reserva">
            <option value="" disabled selected hidden>Selecciona la plataforma que colocaste en la reserva.</option>
            <option value="meet">Meet</option>
            <option value="zoom">Zoom</option>
            <option value="teams">Teams</option>
            <option value="otro">Otro</option>
          </select>
        </div>
        <div id="lugar-presencial-reserva-container" style="display: none;">
          <label for="lugar-presencial-reserva"><b>Especifica el lugar físico del evento en la reserva: *</b></label>
          <input type="text" id="lugar-presencial-reserva" placeholder="Escribe el lugar donde el evento se realizará.">
        </div>
        </div>
        </div>
        <div class="row">
        <div class="half">
        <label for="plan-evento-reserva"><b>Plan del evento en la reserva: *</b></label>
        <textarea id="plan-evento-reserva" rows="5" placeholder="Acá aparecerá el plan del evento de la reserva."></textarea>
        </div>
        <div class="half">
        <label for="observaciones-evento-reserva"><b>Observaciones del evento en la reserva:</b></label>
        <textarea id="observaciones-evento-reserva" rows="5" placeholder="Acá aparecerán las observaciones adicionales de la reserva."></textarea>
        </div>    
        </div>
        <div class="row">
          <div class="half">
            <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS DEL ORGANIZADOR</p></h2>
            <label for="nombre-organizador-reserva"><b>Nombre del organizador en la reserva: *</b></label>
            <input type="text" id="nombre-organizador-reserva" placeholder="Acá aparecerá el nombre del organizador de la reserva.">
            <div class="row">
              <div class="half">
                <label for="email-organizador-reserva"><b>Email del organizador en la reserva: *</b></label>
                <input type="text" id="email-organizador-reserva" placeholder="Acá aparecerá el email del organizador de la reserva.">
              </div>
             <div class="half">
              <label for="capitulo-organizador-reserva"><b>Capítulo al que aplica la reserva: *</b></label>
              <select id="capitulo-organizador-reserva">
                <option value="" disabled selected hidden>Selecciona el capítulo para el que aplica la reserva.</option>
                <option value="uniguajira">UNIGUAJIRA</option>
                <option value="unimagdalena">UNIMAGDALENA</option>
                <option value="uniatlantico">UNIATLÁNTICO</option>
                <option value="uninorte">UNINORTE</option>
                <option value="cuc">CUC</option>
                <option value="librequilla">LIBREQUILLA</option>
                <option value="utb">UTB</option>
                <option value="ufps">UFPS</option>
                <option value="unalmed">UNALMED</option>
                <option value="udea">UDEA</option>
                <option value="upbmed">UPBMED</option>
                <option value="utp">UTP</option>
                <option value="unalma">UNALMA</option>
                <option value="udistrital">UDISTRITAL</option>
                <option value="unalbog">UNALBOG</option>
                <option value="univalle">UNIVALLE</option>
                <option value="icesi">ICESI</option>
                <option value="usc">USC</option>
                <option value="librecali">LIBRECALI</option>
                <option value="nacional">ANEIAP NACIONAL</option>
              </select>
              </div>
              </div>
            <label for="telefono-organizador-reserva"><b>Teléfono del organizador en la reserva: *</b></label>
            <input type="tel" id="telefono-organizador-reserva" placeholder="Acá aparecerá el número de teléfono del organizador de la reserva.">
          </div>
          <div class="half">
            <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS DEL PONENTE</p></h2>
            <label for="nombre-ponente-reserva"><b>Nombre del ponente en la reserva: *</b></label>
            <input type="text" id="nombre-ponente-reserva" placeholder="Acá aparecerá el nombre del ponente de la reserva.">
            <label for="email-ponente-reserva"><b>Email del ponente en la reserva:</b></label>
            <input type="text" id="email-ponente-reserva" placeholder="Acá aparecerá el email del ponente de la reserva.">
            <label for="telefono-ponente-reserva"><b>Teléfono del ponente en la reserva:</b></label>
            <input type="tel" id="telefono-ponente-reserva" placeholder="Acá aparecerá el número de teléfono del ponente de la reserva.">
          </div>
        </div>
        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS PARA EL COMITÉ DE PIEZAS</p></h2>
        <div class="row">
          <div class="third">
            <label for="publicidad-comite-reserva"><b>¿Deseas que el comité de piezas capitular te realice la publicidad del espacio? *</b></label>
            <select id="publicidad-comite-reserva">
              <option value="si">SÍ</option>
              <option value="no">NO</option>
            </select>
          </div>
          <div class="third">
            <label for="observaciones-publicidad-reserva"><b>Observaciones a tener en cuenta para que el comité de piezas tenga en cuenta al hacer tu publicidad:</b></label>
            <textarea id="observaciones-publicidad-reserva" rows="1" placeholder="Ingresa observaciones para la publicidad del evento."></textarea>
          </div>
          <div class="third">
            <label for="foto-ponente-reserva"><b>Enlace de Google Drive de la foto del ponente para que el comité de publicidad la coloque en la pieza:</b></label>
            <input type="text" id="foto-ponente-reserva" placeholder="Ingresa el enlace de Google Drive, debe estar compartido para cualquier correo.">
          </div>
        </div>
        <button class="button-consultar" onclick="editarReserva()">Enviar edición de reserva</button>
        </div>
      </div>
    </div>
  </div>
  <!-- DETALLES Y CAMPOS DEL ACORDEÓN 3 QUE CORRESPONDE A ELIMINAR (CANCELAR) LA RESERVA DE UN EVENTO-->
  <div class="acordeon3" onclick="toggleEliminarReserva()">CLICK AQUÍ PARA ELIMINAR TU RESERVA ⛔</div>
  <div id="acordeon3-content" style="display: none;">
    <div class="acordeon3-content-inner">
      <div class="eliminar-group">
      <div class="row">
      <div class="half">
      <label for="fecha-evento-eliminar"><b>Fecha del evento que deseas cancelar: *</b></label>
      <input type="date" id="fecha-evento-eliminar" placeholder="Selecciona la fecha del evento que deseas cancelar.">
      </div>
      <div class="half">
      <label for="hora-evento-eliminar"><b>Hora del evento que deseas cancelar: *</b></label>
      <select id="hora-evento-eliminar">
        <option value="" disabled selected hidden>Selecciona la hora de la reserva que deseas cancelar.</option>
        <option value="08:00">08:00</option>
        <option value="08:30">08:30</option>
        <option value="09:00">09:00</option>
        <option value="09:30">09:30</option>
        <option value="10:00">10:00</option>
        <option value="10:30">10:30</option>
        <option value="11:00">11:00</option>
        <option value="11:30">11:30</option>
        <option value="12:00">12:00</option>
        <option value="12:30">12:30</option>
        <option value="13:00">13:00</option>
        <option value="13:30">13:30</option>
        <option value="14:00">14:00</option>
        <option value="14:30">14:30</option>
        <option value="15:00">15:00</option>
        <option value="15:30">15:30</option>
        <option value="16:00">16:00</option>
        <option value="16:30">16:30</option>
        <option value="17:00">17:00</option>
        <option value="17:30">17:30</option>
        <option value="18:00">18:00</option>
        <option value="18:30">18:30</option>
        <option value="19:00">19:00</option>
        <option value="19:30">19:30</option>
        <option value="20:00">20:00</option>
        <option value="20:30">20:30</option>
        <option value="21:00">21:00</option>
      </select>
      </div>
      </div>
      <label for="clave-evento-eliminar"><b>Digita la clave del evento en la reserva: *</b></label>
      <input type="text" id="clave-evento-eliminar" placeholder="Ingresa la clave del evento que fue enviada a tu correo de forma automática al momento de reservar el espacio.">
      <button class="button-eliminar" onclick="eliminarReserva()">Eliminar reserva</button>  
      </div>
    </div>
  </div>
  <!-- DETALLES DEL ACORDEÓN 4 PARA EVALUACIÓN DE SATISFACCIÓN DEL ESPACIO -->
  <div class="acordeon4" onclick="window.location.href = 'https://alessvilla.github.io/SIEA/public/index_evaluar.html'">CLICK AQUÍ PARA EVALUAR EL ESPACIO / EVENTO 🌟</div>
  <div id="acordeon4-content" style="display: none;">
    <div class="acordeon4-content-inner">
      <!-- Contenido para evaluar espacio -->
      <button class="alternarConsulta" onclick="alternarEvaluacion()">Click aquí para evaluar el CRM de un evento.</button>

      <div class="evaluar-group" id="evaluar-espacio">
      <!-- Botón para alternar entre evaluar espacio y evaluar evento -->
        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS GENERALES DEL ESPACIO 🏢</p></h2>
        <div class="row">
          <div class="half">
            <label for="nombre-asistente"><b>Nombre completo del asistente: *</b></label>
            <input type="text" id="nombre-asistente" placeholder="Ingresa tu nombre.">
            <label for="telefono-asistente"><b>Teléfono del asistente: *</b></label>
            <input type="tel" id="telefono-asistente" placeholder="Ingresa tu número de teléfono.">
          </div>
          <div class="half">
            <label for="correo-asistente"><b>Correo del asistente: *</b></label>
            <input type="text" id="correo-asistente" placeholder="Ingresa tu correo electrónico.">
            <label for="capitulo-espacio"><b>Capítulo que organizó y se hizo cargo del espacio: *</b></label>
            <select id="capitulo-espacio">
              <option value="" disabled selected hidden>Selecciona el capítulo que organizó el espacio.</option>
              <option value="uniguajira">UNIGUAJIRA</option>
              <option value="unimagdalena">UNIMAGDALENA</option>
              <option value="uniatlantico">UNIATLÁNTICO</option>
              <option value="uninorte">UNINORTE</option>
              <option value="cuc">CUC</option>
              <option value="librequilla">LIBREQUILLA</option>
              <option value="utb">UTB</option>
              <option value="ufps">UFPS</option>
              <option value="unalmed">UNALMED</option>
              <option value="udea">UDEA</option>
              <option value="upbmed">UPBMED</option>
              <option value="utp">UTP</option>
              <option value="unalma">UNALMA</option>
              <option value="udistrital">UDISTRITAL</option>
              <option value="unalbog">UNALBOG</option>
              <option value="univalle">UNIVALLE</option>
              <option value="icesi">ICESI</option>
              <option value="usc">USC</option>
              <option value="librecali">LIBRECALI</option>
              <option value="nacional">ANEIAP NACIONAL</option>
            </select>
          </div>
        </div>
        <label for="nombre-espacio"><b>Nombre del espacio a evaluar: *</b></label>
        <select id="nombre-espacio">
          <option value="" disabled selected hidden>Debes seleccionar primero un capítulo para seleccionar el espacio.</option>
          <!-- Aquí puedes agregar opciones para los espacios disponibles -->
        </select>
        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">EVALÚA EL ESPACIO 📝</p></h2>
        <p>Evalúa del 1 al 10 los siguientes aspectos siendo 1 la menor nota y 10 la máxima nota:</p>
        <div class="row">
          <div class="half">
            <label for="pregunta1"><b>1️⃣ </b> ¿Qué tan satisfecho te sientes con el espacio brindado? *</label>
            <select id="pregunta1">
              <option value="" disabled selected hidden>Califica del 1 al 10.</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </div>
          <div class="half">
            <label for="pregunta2"><b>2️⃣ </b> ¿Qué tanto aprendiste por haber asistido al espacio? *</label>
            <select id="pregunta2">
              <option value="" disabled selected hidden>Califica del 1 al 10.</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="half">
            <label for="pregunta3"><b>3️⃣ </b> Evalúa la calidad del ponente/organizador del espacio. *</label>
            <select id="pregunta3">
              <option value="" disabled selected hidden>Califica del 1 al 10.</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </div>
          <div class="half">
            <label for="pregunta4"><b>4️⃣ </b> Deja acá tus comentarios, sugerencias y retroalimentaciones.</label>
            <textarea id="pregunta4" rows="1" placeholder="Escribe tus comentarios y sugerencias aquí en caso de que tengas alguno (recomendado)."></textarea>
          </div>
        </div>
        <button class="button-evaluar" onclick="evaluarEspacio()">Enviar evaluación</button>
      </div>

      <!-- Contenido para evaluar evento (inicialmente oculto) -->
      <div class="evaluar-group" id="evaluar-evento" style="display: none;">

        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DATOS GENERALES DEL EVENTO CAPITULAR/NACIONAL 🏢</p></h2>
          <div class="row">
            <div class="fourth">
                <label for="nombre-asistente"><b>Nombre completo asistente: *</b></label>
                <input type="text" id="nombre-asistente" placeholder="Ingresa tu nombre.">
            </div>
            <div class="fourth">
                <label for="telefono-asistente"><b>Teléfono del asistente: *</b></label>
                <input type="tel" id="telefono-asistente" placeholder="Ingresa tu número de teléfono.">
            </div>
            <div class="fourth">
                <label for="correo-asistente"><b>Correo del asistente: *</b></label>
                <input type="text" id="correo-asistente" placeholder="Ingresa tu correo electrónico.">
            </div>
            <div class="fourth">
                <label for="evento-crm"><b>Evento al que asististe: *</b></label>
                <select id="evento-crm">
                  <option value="" disabled selected hidden>Selecciona el evento.</option>
                  <option value="evento1">Evento 1</option>
                  <option value="evento2">Evento 2</option>
                  <!-- Agrega opciones para otros eventos -->
                </select>
            </div>
          </div>

        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">EVALÚA EL EVENTO 📝</p></h2>
        <p>Recientemente estuviste en un evento organizado por la ANEIAP. Del 0 al 10, siendo 10 el puntaje máximo.</p>
        <div class="row">
          <div class="half">
            <label for="pregunta1"><b>1️⃣ </b> ¿Qué tan probable es que recomiendes los eventos de la ANEIAP a otras personas? *</label>
            <select id="pregunta1">
              <option value="" disabled selected hidden>Califica del 1 al 10.</option>
              <!-- Opciones de 1 a 10 -->
            </select>
          </div>
          <div class="half">
            <label for="pregunta2"><b>2️⃣ </b> ¿Qué tan adecuadas considera que fueron las instalaciones para el evento? *</label>
            <select id="pregunta2">
              <option value="" disabled selected hidden>Califica del 1 al 10.</option>
              <!-- Opciones de 1 a 10 -->
            </select>
          </div>
        </div>
        <div class="row">
          <div class="half">
              <label for="pregunta3"><b>3️⃣ </b> ¿Cómo calificarías la puntualidad en el desarrollo de las actividades? *</label>
              <select id="pregunta3">
                  <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                  <!-- Opciones de 1 a 10 -->
              </select>
          </div>
          <div class="half">
              <label for="pregunta4"><b>4️⃣ </b> ¿Cómo calificarías tu paso por la mesa de acreditación? *</label>
              <select id="pregunta4">
                  <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                  <!-- Opciones de 1 a 10 -->
              </select>
          </div>
          </div>
          <!-- Repite el mismo patrón para las siguientes preguntas -->
          <!-- Pregunta 5 -->
          <div class="row">
              <!-- Primer half -->
              <div class="half">
                  <label for="pregunta5"><b>5️⃣ </b> ¿Cómo calificarías la apertura del evento? *</label>
                  <select id="pregunta5">
                      <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                      <!-- Opciones de 1 a 10 -->
                  </select>
              </div>
              <!-- Segundo half -->
              <div class="half">
                <label for="pregunta6"><b>6️⃣ </b> ¿Cómo calificarías el trabajo logístico del comité organizador? *</label>
                <select id="pregunta6">
                    <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                    <!-- Opciones de 1 a 10 -->
                </select>
            </div>
          </div>
          <!-- Pregunta 7 -->
          <div class="row">
              <!-- Primer half -->
              <div class="half">
                  <label for="pregunta7"><b>7️⃣ </b> ¿Cómo calificarías la atención por parte del comité organizador? *</label>
                  <select id="pregunta7">
                      <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                      <!-- Opciones de 1 a 10 -->
                  </select>
              </div>
              <!-- Segundo half -->
              <div class="half">
                <label for="pregunta8"><b>8️⃣ </b> ¿Cómo calificarías la agenda del evento? *</label>
                <select id="pregunta8">
                    <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                    <!-- Opciones de 1 a 10 -->
                </select>
              </div>
          </div>
          <!-- Repite el mismo patrón para las siguientes preguntas -->
          <!-- Pregunta 9 -->
          <div class="row">
              <!-- Primer half -->
              <div class="half">
                <label for="pregunta9"><b>9️⃣ </b> ¿Cómo calificarías al(los) conferencista(s)? *</label>
                <select id="pregunta9">
                    <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                    <!-- Opciones de 1 a 10 -->
                </select>
              </div>
              <!-- Segundo half -->
              <div class="half">
                <label for="pregunta10"><b>1️⃣0️⃣ </b> ¿Cómo calificarías las temáticas del evento? *</label>
                <select id="pregunta10">
                    <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                    <!-- Opciones de 1 a 10 -->
                </select>
              </div>
          </div>
          <!-- Repite el mismo patrón para las siguientes preguntas -->
          <!-- Pregunta 11 -->
          <div class="row">
              <!-- Primer half -->
              <div class="half">
                  <label for="pregunta11"><b>1️⃣1️⃣ </b> ¿Qué tan adecuada consideras que fue la publicidad del evento? *</label>
                  <select id="pregunta11">
                      <option value="" disabled selected hidden>Califica del 1 al 10.</option>
                      <!-- Opciones de 1 a 10 -->
                  </select>
              </div>
              <!-- Segundo half -->
              <div class="half">
                  <!-- Espacio para la pregunta 12 -->
              </div>
          </div>
        <button class="button-evaluar" onclick="evaluarEvento()">Enviar evaluación de evento</button>
      </div>

    </div>
  </div>
  <!-- DETALLES DEL ACORDEÓN 5 PARA VISUALIZACIÓN Y ACTUALIZACIÓN DE ESPACIOS -->
  <div class="acordeon5" onclick="toggleVisualizarActualizarEspacios()">CLICK AQUÍ PARA VISUALIZAR Y ACTUALIZAR ESPACIOS 🛠️</div>
  <div id="acordeon5-content" style="display: none;">
    <div class="acordeon5-content-inner">
      <div class="actualizar-group">
        <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DETALLES DEL ESPACIO 🏢</p></h2>
        <div class="row">
          <div class="half">
            <p id="capitulo-usuario"> <!-- Aquí se mostrará dinámicamente el capítulo del usuario --> </p>
          </div>
          <div class="half">
            <div class="row">
              <div class="quarter">
                <label for="fecha-inicial"><b>Fecha inicial: *</b></label>
                <input type="date" id="fecha-inicial">
              </div>
              <div class="quarter">
                <label for="fecha-final"><b>Fecha final: *</b></label>
                <input type="date" id="fecha-final">
              </div>
              <div class="quarter">
                <label for="total-asistentes"><b># de asistentes:</b></label>
                <input type="text" id="total-asistentes">
              </div>
              <div class="quarter">
                <label for="link-evidencia"><b>Evidencia (drive):</b></label>
                <input type="text" id="link-evidencia">
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="half">
            <label for="nombre-espacio-actualizar"><b>Nombre del espacio a actualizar: *</b></label>
            <select id="nombre-espacio-actualizar">
              <option value="" disabled selected hidden>Debes seleccionar primero la fecha inicial y final a consultar.</option>
              <!-- Aquí se cargarán dinámicamente los nombres de los espacios disponibles para el capítulo del usuario -->
            </select>
          </div>
          <div class="half">
            <div class="row">
              <div class="half">
                <label for="tipo-espacio"><b>Tipo de espacio: *</b></label>
                <select id="tipo-espacio">
                  <option value="" disabled selected hidden>Selecciona el tipo de espacio.</option>
                  <option value="valor-agregado">VALOR AGREGAGO ➕</option>
                  <option value="entrenamiento-interno">ENTRENAMIENTO INTERNO 🏋🏻</option>
                  <option value="ninguno">No es espacio de formación</option>
                </select>
              </div>
              <div class="half">
                <label for="area-trabajo"><b>Área de trabajo: *</b></label>
                <select id="area-trabajo">
                  <option value="" disabled selected hidden>Selecciona el área de trabajo del espacio.</option>
                  <option value="academico">ACADÉMICO 💚</option>
                  <option value="comunicaciones">COMUNICACIONES 🩵</option>
                  <option value="desarrollo">DESARROLLO 💛</option>
                  <option value="finanzas">FINANZAS 💜</option>
                  <option value="mercadeo">MERCADEO ❤️</option>
                  <option value="habilidades-duras">HABILIDADES DURAS 🧠</option>
                  <option value="habilidades-blandas">HABILIDADES BLANDAS 🫂</option>
                  <option value="conocimiento-aneiap">CONOCIMIENTO ANEIAP 💚💙</option>
                  <option value="ninguno">No es espacio de formación</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <button class="button-actualizar" onclick="actualizarEspacio()">Actualizar espacio</button>
        <!-- Mini sección de estadísticas -->
        <div class="actualizar-group">
          <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">DASHBOARD ESTADÍSTICO DE ESPACIOS DE FORMACIÓN 📊</p></h2>
          <p id="dashboardEstado" style="text-align: center; display: block;">El dashboard estadístico está oculto.</p>
          <button id="toggleDashboard" onclick="toggleDashboard()" style="margin-left: auto;">Mostrar dashboard</button>
          <div id="estadisticas-container" style="display: none;">
            <div class="row">
                <div class="half">
                        Aquí aparecerá el cumplimiento del plan de formación:
                    <div id="porcentajes-container" style="display: none;">
                    </div>
                    <canvas id="grafico-metas"></canvas>
                </div>
                <div class="half">
                        Acá podrás ver estadísticas sobre el NPS en los espacios:
                    <div id="satisfaccion-container" style="display: none;">
                    </div>
                    <canvas id="grafico-satisfaccion"></canvas>
                </div>
            </div>
          </div>
        </div>
        <!-- Aquí se incluye la tabla resumen -->
        <div class="actualizar-group">
          <div id="tabla-resumen-container">
            <h2 style="font-size: 22px; text-transform: uppercase;"><p style="text-align: center;">TABLA RESUMEN DE SATISFACCIÓN DE ESPACIOS 📋</p></h2>
            <p id="tablaResumenEstado" style="text-align: center; display: block;">La tabla resumen se encuentra oculta.</p>
            <button id="toggleTablaResumen" onclick="toggleTablaResumen()" style="margin-left: auto;">Mostrar tabla resumen</button>
            <table id="tabla-resumen" style="display: none;">
              <!-- Aquí se generará dinámicamente la tabla resumen -->
            </table>
          </div>
        </div>
        <!-- CUARTA MINISECCIÓN: RESPUESTAS DE EVALUACIONES DE SATISFACCIÓN -->
        <div class="actualizar-group">
          <h2 style="font-size: 22px; text-transform: uppercase;">
            <p style="text-align: center;">RESPUESTAS DE EVALUACIONES DE SATISFACCIÓN 📝</p>
          </h2>
          <!-- Desplegable para elegir el evento -->
          <div class="row">
            <div class="half">
              <label for="nombre-espacio-consultar-evaluaciones"><b>Selecciona un evento:</b></label>
              <select id="nombre-espacio-consultar-evaluaciones" onchange="consultarEvaluaciones()">
                <option value="" disabled selected hidden>Debes seleccionar una fecha inicial y una fecha final primero</option>
                <!-- Aquí se cargarán dinámicamente los eventos disponibles para el capítulo del usuario -->
              </select>
            </div>
            <div class="half">
              <div class="row">
                <div class="half">
                  <label for="fecha-inicial-evaluaciones"><b>Fecha inicial:</b></label>
                  <input type="date" id="fecha-inicial-evaluaciones">
                </div>
                <div class="half">
                  <label for="fecha-final-evaluaciones"><b>Fecha final:</b></label>
                  <input type="date" id="fecha-final-evaluaciones">
                </div>
              </div>
            </div>
          </div>
          <!-- Botón para ocultar o mostrar la tabla de evaluaciones -->
          <button id="toggleEvaluaciones" onclick="toggleEvaluaciones()">Mostrar tabla de evaluaciones</button>
          <!-- Mensaje de estado de la tabla -->
          <p id="estadoTablaEvaluaciones" style="text-align: center; display: block;">La tabla de evaluaciones de satisfacción está oculta</p>
          <!-- Tabla con las evaluaciones -->
          <table id="tabla-evaluaciones" class="tabla-evaluaciones" style="display: none;">
            <thead>
              <tr>
                <th style="width: 15%;">Nombre del asistente</th>
                <th style="width: 15%;">Correo asistente</th>
                <th style="width: 10%;">Teléfono asistente</th>
                <th style="width: 10%;">¿Qué tan satisfecho estás del 1 al 10?</th>
                <th style="width: 10%;">¿Cuánto aprendiste del 1 al 10?</th>
                <th style="width: 10%;">Evalúa el ponente del 1 al 10</th>
                <th style="width: auto;">Comentarios</th>
              </tr>
            </thead>
            <tbody>
              <!-- Aquí se generarán dinámicamente las filas de la tabla -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>

    // Variables para la evaluación del espacio dentro del Acordeón 4 y actualización de info del espacio en Acordeón 5:
    var fechaHoy = new Date().toISOString().slice(0, 10);
    var capituloEspacioSelect = document.getElementById("capitulo-espacio");

    // Función para que los nombres de los espacios que están disponibles para evaluar se actualicen a
    // Todos aquellos que tengan una fecha de evento entre HOY y hace 3 SEMANAS, luego de 3 semanas no se podrá evaluar
    capituloEspacioSelect.addEventListener("change", function() {
        var capituloSeleccionado = document.getElementById("capitulo-espacio").value;
        // Calcular la fecha de hace tres semanas
        var tresSemanasAtras = new Date();
        tresSemanasAtras.setDate(tresSemanasAtras.getDate() - 21); // Restar 21 días para tres semanas
        
        // Formatear la fecha de tres semanas atrás en el formato YYYY-MM-DD
        var dia = String(tresSemanasAtras.getDate()).padStart(2, '0');
        var mes = String(tresSemanasAtras.getMonth() + 1).padStart(2, '0');
        var año = tresSemanasAtras.getFullYear();
        var fechaTresSemanasAtras = año + '-' + mes + '-' + dia;
        console.log("la fecha de hace 3 semanas es con función " + fechaTresSemanasAtras);
        // Obtener las reservas para el capítulo y dentro del rango de fechas
        var reservasRef = firebase.firestore().collection("reservas");
        var consulta = reservasRef.where("capitulo", "==", capituloSeleccionado)
                                  .where("fechaEvento", ">=", fechaTresSemanasAtras)
                                  .where("fechaEvento", "<=", fechaHoy)

        consulta.get().then(function(querySnapshot) {
          var nombresEventos = [];
          querySnapshot.forEach(function(doc) {
              nombresEventos.push(doc.data().nombreEvento);
          });
          nombresEventos.sort(); // Orden alfabético
          // Agregar opciones al select
          var nombreEspacioSelect = document.getElementById("nombre-espacio");
          nombreEspacioSelect.innerHTML = ""; // Limpiar opciones anteriores
          if (nombresEventos.length === 0) {
              // Si no hay eventos disponibles, mostrar un mensaje indicando que no hay eventos en el rango de fechas
              var option = document.createElement("option");
              option.text = "No hay ningún evento cuya fecha sea entre HOY y hace 3 SEMANAS para este capítulo o ya pasó el plazo máximo del evento que buscas evaluar.";
              option.value = "";
              option.disabled = true;
              option.selected = true;
              nombreEspacioSelect.add(option);
          } else {
              // Si hay eventos disponibles, agregar cada nombre como una opción
              nombresEventos.forEach(function(nombre) {
                  var option = document.createElement("option");
                  option.text = nombre;
                  option.value = nombre;
                  nombreEspacioSelect.add(option);
              });
          }
        }).catch(function(error) {
            console.log("Error obteniendo reservas:", error);
            // Manejar el error aquí
        });
    });

    // Variable global del correo del usuario para mirar si inició sesión un DCA o DNA.
    var correoUsuario = ""; //deben estar vacías, solo que tengo flojera de iniciar sesión.
    var capituloUsuario = "";

    // Obtener los elementos de fecha inicial y final y agregar eventos change a los campos de fecha
    var fechaInicialInput = document.getElementById("fecha-inicial");
    var fechaFinalInput = document.getElementById("fecha-final");
    var nombreEspacioSeleccionado = document.getElementById("nombre-espacio-actualizar").value;
    fechaInicialInput.addEventListener("change", actualizarNombresEspacios);
    fechaFinalInput.addEventListener("change", actualizarNombresEspacios);
    document.getElementById("nombre-espacio-actualizar").addEventListener("change", ActualizarCamposConNombreEspacio);

    // Primera feature: Función para actualizar los nombres de los espacios según las fechas seleccionadas
    function actualizarNombresEspacios() {
        // Obtener las fechas seleccionadas
        var fechaInicial = fechaInicialInput.value;
        var fechaFinal = fechaFinalInput.value;
        console.log(fechaInicial)
        console.log(fechaFinal)
        console.log(capituloUsuario)
        // Verificar que ambas fechas estén seleccionadas
        if (fechaInicial && fechaFinal) {
            // Obtener la referencia a la colección de reservas
            var reservasRef = firebase.firestore().collection("reservas");
            // Crear la consulta para obtener los nombres de los espacios dentro del rango de fechas y del capítulo del usuario
            var consulta = reservasRef.where("capitulo", "==", capituloUsuario)
                                      .where("fechaEvento", ">=", fechaInicial)
                                      .where("fechaEvento", "<=", fechaFinal)

            // Ejecutar la consulta
            consulta.get()
                  .then(function(querySnapshot) {
                        // Array para almacenar los nombres de los espacios
                        console.log("Número de documentos obtenidos:", querySnapshot.size);
                        var nombresEspacios = [];

                        // Iterar sobre los resultados de la consulta
                        querySnapshot.forEach(function(doc) {
                            // Obtener el nombre del espacio y agregarlo al array
                            nombresEspacios.push(doc.data().nombreEvento);
                        });

                        // Llamar a la función para actualizar el desplegable con los nombres de los espacios obtenidos
                        actualizarDesplegableNombresEspacios(nombresEspacios);
                        // Llamar a la función para que la tabla resumen se actualice
                        generarTablaResumen();
                        ActualizarCamposConNombreEspacio();
                        generarGraficos();
                  })
                  .catch(function(error) {
                        // Manejar errores
                        console.error("Error al obtener nombres de espacios:", error);
                  });
        }
    }

    // Función para actualizar el desplegable con los nombres de los espacios
    function actualizarDesplegableNombresEspacios(nombresEspacios) {
        // Obtener el desplegable de nombres de espacios
        var nombreEspacioSelect = document.getElementById("nombre-espacio-actualizar");

        // Limpiar opciones anteriores
        nombreEspacioSelect.innerHTML = "";

        // Ordenar los nombres de los espacios alfabéticamente
        nombresEspacios.sort();

        // Si hay nombres de espacios disponibles, agregar cada uno como opción en el desplegable
        if (nombresEspacios.length > 0) {
            nombresEspacios.forEach(function(nombre) {
                var option = document.createElement("option");
                option.text = nombre;
                option.value = nombre;
                nombreEspacioSelect.add(option);
            });
        } else {
            // Si no hay nombres de espacios disponibles, mostrar un mensaje indicando que no se encontraron espacios en el rango de fechas seleccionado
            var option = document.createElement("option");
            option.text = "No hay espacios disponibles en el rango de fechas seleccionado.";
            option.value = "";
            option.disabled = true;
            option.selected = true;
            nombreEspacioSelect.add(option);
        }
    }

    // Función para actualizar el total de asistentes, link de evidencia, tipo de espacio y área de trabajo del espacio
    function ActualizarCamposConNombreEspacio() {
    // Obtener el valor seleccionado del desplegable "nombre-espacio-actualizar"
    var nombreEspacioSeleccionado = document.getElementById("nombre-espacio-actualizar").value;

    // Obtener la referencia del documento correspondiente en Firestore
    var reservasRef = firebase.firestore().collection("reservas");
    var consulta = reservasRef.where("capitulo", "==", capituloUsuario).where("nombreEvento", "==", nombreEspacioSeleccionado);

    consulta.get()
        .then(function(querySnapshot) {
            // Verificar si se encontró algún documento con el nombre del espacio seleccionado
            if (!querySnapshot.empty) {
                // Obtener el primer documento encontrado
                var doc = querySnapshot.docs[0];
                var data = doc.data();

                // Actualizar los valores de los campos con los datos del documento
                document.getElementById("total-asistentes").value = data.totalAsistentes || "";
                document.getElementById("link-evidencia").value = data.evidencia || "";
                document.getElementById("tipo-espacio").value = data.tipoEvento || "";
                document.getElementById("area-trabajo").value = data.areaTrabajo || "";
                // Llamar a la función para que la tabla resumen se actualice
                generarTablaResumen();
            } else {
                // Si no se encontró ningún documento, limpiar los valores de los campos
                document.getElementById("total-asistentes").value = "";
                document.getElementById("link-evidencia").value = "";
                document.getElementById("tipo-espacio").value = "";
                document.getElementById("area-trabajo").value = "";
            }
        })
        .catch(function(error) {
            console.error("Error al obtener datos del espacio:", error);
            // En caso de error, limpiar los valores de los campos
            document.getElementById("total-asistentes").value = "";
            document.getElementById("link-evidencia").value = "";
            document.getElementById("tipo-espacio").value = "";
            document.getElementById("area-trabajo").value = "";
        });
    }

    // Segunda feature: Generar tabla resumen de satisfacción de espacios
    function generarTablaResumen() {
        // Obtener referencia a la tabla donde se mostrará el resumen
        var tablaResumen = document.getElementById("tabla-resumen");
        // Eliminar todas las filas de la tabla (excepto la primera, que contiene los encabezados)
        while (tablaResumen.rows.length > 1) {
            tablaResumen.deleteRow(1);
        }
        // Limpiar contenido anterior de la tabla
        tablaResumen.innerHTML = "";

        // Crear fila de encabezado de la tabla
        var encabezado = tablaResumen.insertRow();
        var encabezadoColumnas = ["Nombre espacio", "Área", "Tipo", "Fecha", "Ponente", "Correo ponente", "Tel. ponente", "Detractores", "Pasivos", "Promotores", "Asistentes", "% NPS", "Evidencia"];
        encabezadoColumnas.forEach(function(columna, index) {
            var th = document.createElement("th");
            th.textContent = columna;
            // Asignar ancho específico a cada columna
            if (index === 0) {
                th.style.width = "20%";
            } else if (index >= 1 && index <= 5) {
                th.style.width = "10%";
            } else if (index === 6) {
                th.style.width = "5%";
            } else if (index >= 7 && index <= 10) {
                th.style.width = "5%";
            } else if (index === 11) {
                th.style.width = "5%";
            } else if (index === 12) {
                th.style.width = "0%"; // Columna de Evidencia con 0% de ancho
            }
            encabezado.appendChild(th);
        });

        // Obtener las fechas seleccionadas
        var fechaInicial = fechaInicialInput.value;
        var fechaFinal = fechaFinalInput.value;

        // Verificar que ambas fechas estén seleccionadas
        if (fechaInicial && fechaFinal) {
            // Obtener la referencia a la colección de reservas
            var reservasRef = firebase.firestore().collection("reservas");

            // Crear la consulta para obtener los eventos dentro del rango de fechas y del capítulo del usuario
            var consulta = reservasRef.where("capitulo", "==", capituloUsuario)
                                      .where("fechaEvento", ">=", fechaInicial)
                                      .where("fechaEvento", "<=", fechaFinal)
                                      .orderBy("fechaEvento", "asc"); // Ordenar por fecha de forma ascendente

            // Ejecutar la consulta
            consulta.get()
                  .then(function(querySnapshot) {
                        // Iterar sobre los resultados de la consulta
                        querySnapshot.forEach(function(doc) {
                            // Obtener los datos del documento
                            var data = doc.data();

                            // Crear fila para este evento
                            var fila = tablaResumen.insertRow();

                            // Insertar celdas con los datos del evento
                            fila.insertCell().textContent = data.nombreEvento;
                            fila.insertCell().textContent = data.areaTrabajo
                            fila.insertCell().textContent = data.tipoEvento
                            fila.insertCell().textContent = data.fechaEvento;
                            fila.insertCell().textContent = data.nombrePonente;
                            fila.insertCell().textContent = data.emailPonente;
                            fila.insertCell().textContent = data.telefonoPonente;
                            fila.insertCell().textContent = data.detractores;
                            fila.insertCell().textContent = data.pasivos;
                            fila.insertCell().textContent = data.promotores;
                            fila.insertCell().textContent = data.totalAsistentes;
                            var satisfaccion = data.satisfaccion;
                            var satisfaccionFormateada = (satisfaccion * 100).toFixed(2);
                            satisfaccionFormateada += '%';
                            fila.insertCell().textContent = satisfaccionFormateada;
                            fila.insertCell().textContent = data.evidencia;
                        });
                    // Verificar si la tabla está vacía
                    if (querySnapshot.size === 0) {
                        // Crear una fila para mostrar el mensaje de que no hay espacios
                        var filaMensaje = tablaResumen.insertRow();
                        var celdaMensaje = filaMensaje.insertCell();
                        celdaMensaje.textContent = "No hay ningún espacio para estas fechas seleccionadas.";
                        celdaMensaje.colSpan = encabezadoColumnas.length; // Colspan para que ocupe todas las columnas
                        celdaMensaje.style.textAlign = "center"; // Centrar el mensaje
                    }
                  })
                  .catch(function(error) {
                        // Manejar errores
                        console.error("Error al obtener eventos:", error);
                  });
        }
    }

    // Definición de la función para convertir la fecha del formulario al formato de Firestore
    function convertirFechaFormulario(fechaFormulario) {
    if (typeof fechaFormulario !== "string") {
      // Si fechaFormulario no es una cadena, intentamos convertirlo a string
      fechaFormulario = fechaFormulario.toString();
    }
    // La fecha del formulario está en formato "yyyy-mm-dd" (ejemplo: "2023-08-15")
    // Debemos convertirla a formato de Firestore, que es un objeto Date de JavaScript
    var partesFecha = fechaFormulario.split("/"); // Separamos año, mes y día
    var anio = parseInt(partesFecha[0]);
    var mes = parseInt(partesFecha[1]);
    var dia = parseInt(partesFecha[2]);

    // Construimos la fecha en formato de Firestore
    var fechaFirestore = new Date(anio, mes - 1, dia); // Restamos 1 al mes ya que en JavaScript los meses van de 0 a 11
    return fechaFirestore;
  }

    // Función para mostrar el contenido de la pestaña seleccionada
    function showTab(tabNumber) {
      // Oculta todos los contenidos de las pestañas
      var tabContents = document.getElementsByClassName("tab-content");
      for (var i = 0; i < tabContents.length; i++) {
        tabContents[i].classList.remove("active");
      }
      // Muestra el contenido de la pestaña seleccionada
      var selectedTabContent = document.getElementById("tab-content-" + tabNumber);
      selectedTabContent.classList.add("active");
    }  

    // Esta función se encarga de mostrar u ocultar el contenido cuando se hace clic en la barra "CONSULTAR DISPONIBILIDAD (AC0)".
    function toggleConsultaDisponibilidad() {
      // Obtenemos el elemento HTML con el ID "acordeon0-content".
      var content = document.getElementById("acordeon0-content");
      
      // Comprobamos si el estilo "display" del elemento está configurado como "none" (oculto).
      if (content.style.display === "none") {
        // Si está oculto, lo cambiamos a "block" (visible) para mostrarlo.
        content.style.display = "block";
      } else {
        // Si está visible, lo cambiamos nuevamente a "none" para ocultarlo.
        content.style.display = "none";
      }
      
      // A continuación, ocultamos los contenidos de otras barras (acordeones).

      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";

      // Ocultamos el contenido del elemento con ID "acordeon4-content".
      var content = document.getElementById("acordeon4-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon3-content".
      var content = document.getElementById("acordeon3-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon2-content".
      var content = document.getElementById("acordeon2-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon1-content".
      var content = document.getElementById("acordeon1-content");
      content.style.display = "none";
    }

    // Esta función se encarga de mostrar u ocultar el contenido cuando se hace clic en la barra "REGISTRAR RESERVA (AC1)".
    function toggleRegistrarEvento() {
      // Obtenemos el elemento HTML con el ID "acordeon1-content".
      var content = document.getElementById("acordeon1-content");
      
      // Comprobamos si el estilo "display" del elemento está configurado como "none" (oculto).
      if (content.style.display === "none") {
        // Si está oculto, lo cambiamos a "block" (visible) para mostrarlo.
        content.style.display = "block";
      } else {
        // Si está visible, lo cambiamos nuevamente a "none" para ocultarlo.
        content.style.display = "none";
      }
      
      // A continuación, ocultamos los contenidos de otras barras (acordeones).

      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";

      // Ocultamos el contenido del elemento con ID "acordeon4-content".
      var content = document.getElementById("acordeon4-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon3-content".
      var content = document.getElementById("acordeon3-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon2-content".
      var content = document.getElementById("acordeon2-content");
      content.style.display = "none";
      
      // Ocultamos el contenido del elemento con ID "acordeon0-content".
      var content = document.getElementById("acordeon0-content");
      content.style.display = "none";
    }

    // Esta función permite cambiar la visibilidad de los campos "ubicación/plataforma" y "lugar presencial"
    // en la sección "REGISTRAR RESERVA (AC1)" según la modalidad seleccionada.
    function toggleUbicacionPlataforma() {
      // Obtenemos los elementos HTML correspondientes a los contenedores de ubicación/plataforma y lugar presencial.
      var ubicacionPlataformaContainer = document.getElementById("ubicacion-plataforma-container");
      var lugarPresencialContainer = document.getElementById("lugar-presencial-container");
      
      // Obtenemos el valor seleccionado en el campo "modalidad-evento".
      var modalidadEvento = document.getElementById("modalidad-evento").value;

      // Comparamos el valor seleccionado con las opciones.
      if (modalidadEvento === "virtual") {
        // Si la modalidad es "virtual", mostramos el campo "ubicación/plataforma" y ocultamos "lugar presencial".
        ubicacionPlataformaContainer.style.display = "block";
        lugarPresencialContainer.style.display = "none";
      } else if (modalidadEvento === "presencial") {
        // Si la modalidad es "presencial", mostramos "lugar presencial" y ocultamos "ubicación/plataforma".
        ubicacionPlataformaContainer.style.display = "none";
        lugarPresencialContainer.style.display = "block";
      } else {
        // En caso contrario, ocultamos ambos campos.
        ubicacionPlataformaContainer.style.display = "none";
        lugarPresencialContainer.style.display = "none";
      }
    }

    // Esta función se encarga de manejar el comportamiento de la barra "EDITAR RESERVA (AC2)"
    // Su principal objetivo es mostrar u ocultar el contenido de esta barra y restablecer los valores de los campos de edición de reserva.
    function toggleEditarReserva() {
      // Obtener la referencia al contenido de la barra "EDITAR RESERVA (AC2)"
      var content = document.getElementById("acordeon2-content");

      // Comprobar si el contenido actualmente está oculto (no visible)
      if (content.style.display === "none") {
        // Si está oculto, se cambia su estilo para mostrarlo (visible)
        content.style.display = "block";
      } else {
        // Si está visible, se cambia su estilo para ocultarlo (no visible)
        content.style.display = "none";
      }

      // Ocultar el contenido de las otras barras de acordeón (si estaban visibles).
      // Esto asegura que solo una barra esté abierta a la vez.
      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";
      var content = document.getElementById("acordeon4-content");
      content.style.display = "none";
      var content = document.getElementById("acordeon3-content");
      content.style.display = "none";
      var content = document.getElementById("acordeon0-content");
      content.style.display = "none";
      var content = document.getElementById("acordeon1-content");
      content.style.display = "none";

      // Restablecer los valores de los campos de edición de reserva a sus valores iniciales.
      // Esto borra cualquier información previamente ingresada en estos campos.
      document.getElementById("clave-evento-reserva").value = "";
      document.getElementById("nombre-evento-reserva").value = "";
      document.getElementById("fecha-evento-reserva").value = "";
      document.getElementById("hora-evento-reserva").value = "";
      document.getElementById("duracion-evento-reserva").value = "";
      document.getElementById("modalidad-evento-reserva").value = "";
      document.getElementById("ubicacion-plataforma-reserva").value = "";
      document.getElementById("lugar-presencial-reserva").value = "";
      document.getElementById("plan-evento-reserva").value = "";
      document.getElementById("observaciones-evento-reserva").value = "";
      document.getElementById("nombre-organizador-reserva").value = "";
      document.getElementById("email-organizador-reserva").value = "";
      document.getElementById("telefono-organizador-reserva").value = "";
      document.getElementById("nombre-ponente-reserva").value = "";
      document.getElementById("email-ponente-reserva").value = "";
      document.getElementById("telefono-ponente-reserva").value = "";
      document.getElementById("publicidad-comite-reserva").value = "";
      document.getElementById("foto-ponente-reserva").value = "";

      // Mostrar el contenido del acordeón "datos-reserva-container".
      // Esta parte del código se encarga de mostrar información adicional
      // relacionada con la reserva una vez que se abre la barra de edición.
      var datosReservaContainer = document.getElementById("datos-reserva-container");
      datosReservaContainer.style.display = "none";
    }

    // Esta función se utiliza en la sección "EDITAR RESERVA (AC2)" para controlar la visualización
    // de campos relacionados con la ubicación o plataforma del evento y el lugar presencial del evento.
    // Dependiendo de la modalidad seleccionada (virtual o presencial), se mostrará uno de estos campos
    // mientras se oculta el otro para evitar confusiones al editar la reserva.
    function toggleUbicacionPlataformaReserva() {
      // Obtener las referencias a los contenedores de ubicación/plataforma y lugar presencial
      var ubicacionPlataformaReservaContainer = document.getElementById("ubicacion-plataforma-reserva-container");
      var lugarPresencialReservaContainer = document.getElementById("lugar-presencial-reserva-container");

      // Obtener el valor de la modalidad del evento seleccionado
      var modalidadEventoReserva = document.getElementById("modalidad-evento-reserva").value;

      // Comprobar la modalidad seleccionada y mostrar/ocultar los campos correspondientes
      if (modalidadEventoReserva === "virtual") {
        // Si la modalidad es "virtual", mostrar el campo de ubicación/plataforma y ocultar el lugar presencial
        ubicacionPlataformaReservaContainer.style.display = "block";
        lugarPresencialReservaContainer.style.display = "none";
      } else if (modalidadEventoReserva === "presencial") {
        // Si la modalidad es "presencial", ocultar el campo de ubicación/plataforma y mostrar el lugar presencial
        ubicacionPlataformaReservaContainer.style.display = "none";
        lugarPresencialReservaContainer.style.display = "block";
      } else {
        // Si no se ha seleccionado ninguna modalidad válida, ocultar ambos campos
        ubicacionPlataformaReservaContainer.style.display = "none";
        lugarPresencialReservaContainer.style.display = "none";
      }
    }

    // Esta función se utiliza cuando se hace clic en la barra "ELIMINAR RESERVA (AC3)" para ocultar
    // las demás barras de información en la interfaz. Su propósito es mejorar la experiencia del usuario
    // al centrarse en la acción de eliminar una reserva sin distracciones innecesarias.
    function toggleEliminarReserva() {
      // Obtener la referencia al contenido de la barra "ELIMINAR RESERVA (AC3)"
      var content = document.getElementById("acordeon3-content");
      
      // Comprobar el estado actual de visualización (oculto o mostrado)
      if (content.style.display === "none") {
        // Si está oculto, cambiarlo a mostrado (display: block)
        content.style.display = "block";
      } else {
        // Si está mostrado, cambiarlo a oculto (display: none)
        content.style.display = "none";
      }

      // A continuación, ocultar las otras barras de información (AC0, AC1, AC2, AC4, AC5) para centrarse en la eliminación

      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";

      var content = document.getElementById("acordeon4-content");
      content.style.display = "none";

      var content0 = document.getElementById("acordeon0-content");
      content0.style.display = "none";

      var content1 = document.getElementById("acordeon1-content");
      content1.style.display = "none";

      var content2 = document.getElementById("acordeon2-content");
      content2.style.display = "none";
    }

    // Esta función se utiliza cuando se hace clic en la barra "EVALUAR ESPACIO (AC4)" para ocultar
    // las demás barras de información en la interfaz. Su propósito es mejorar la experiencia del usuario
    // al centrarse en la acción de eliminar una reserva sin distracciones innecesarias.
    function toggleEvaluarEspacio() {
      // Obtener la referencia al contenido de la barra "ELIMINAR RESERVA (AC3)"
      var content = document.getElementById("acordeon4-content");
      
      // Comprobar el estado actual de visualización (oculto o mostrado)
      if (content.style.display === "none") {
        // Si está oculto, cambiarlo a mostrado (display: block)
        content.style.display = "block";
      } else {
        // Si está mostrado, cambiarlo a oculto (display: none)
        content.style.display = "none";
      }

      // A continuación, ocultar las otras barras de información (AC0, AC1, AC2, AC3 y AC5) para centrarse en la eliminación

      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";

      var content = document.getElementById("acordeon3-content");
      content.style.display = "none";

      var content0 = document.getElementById("acordeon0-content");
      content0.style.display = "none";

      var content1 = document.getElementById("acordeon1-content");
      content1.style.display = "none";

      var content2 = document.getElementById("acordeon2-content");
      content2.style.display = "none";

      document.getElementById("nombre-asistente").value = "";
      document.getElementById("telefono-asistente").value = "";
      document.getElementById("correo-asistente").value = "";
      document.getElementById("capitulo-espacio").value = "";
      document.getElementById("nombre-espacio").value = "";
      document.getElementById("pregunta1").value = "";
      document.getElementById("pregunta2").value = "";
      document.getElementById("pregunta3").value = "";
      document.getElementById("pregunta4").value = "";
    }

    // Esta función se utiliza cuando se hace clic en la barra "VISUALIZAR ACTUALIZAR ESPACIO (AC5)" para ocultar
    // las demás barras de información en la interfaz. Su propósito es mejorar la experiencia del usuario
    function toggleVisualizarActualizarEspacios() {

      // A continuación, ocultar las otras barras de información (AC0, AC1, AC2, AC3, AC4)
      var content = document.getElementById("acordeon4-content");
      content.style.display = "none";

      var content = document.getElementById("acordeon3-content");
      content.style.display = "none";

      var content0 = document.getElementById("acordeon0-content");
      content0.style.display = "none";

      var content1 = document.getElementById("acordeon1-content");
      content1.style.display = "none";

      var content2 = document.getElementById("acordeon2-content");
      content2.style.display = "none";

      var content = document.getElementById("acordeon5-content");
      if (capituloUsuario === "general" || capituloUsuario === "") {
        // Mostrar una alerta indicando que no tiene permisos
        Swal.fire({
          title: '¡NO TIENES PERMISOS PARA ACCEDER A ESTA FUNCIÓN!',
          text: 'Esta función es exclusiva para los DCA y DNA. Inicia sesión con tu correo de Académico si aún no lo has hecho, Si no eres director(a) de académico y crees que deberías tener acceso, por favor, contáctate con el administrador.',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return; // Terminar la función ya que el usuario no tiene permisos
      }

      // Obtener el elemento del párrafo donde se mostrará el capítulo del usuario
      var capituloUsuarioElement = document.getElementById("capitulo-usuario");
      var textoCapitulo = "<b>La información que aparecerá y consultará corresponderá al capítulo: </b>" + "<b>" + capituloUsuario.toUpperCase() + "</b>";
      capituloUsuarioElement.innerHTML = textoCapitulo;

      // Comprobar el estado actual de visualización (oculto o mostrado)
      if (content.style.display === "none") {
        // Si está oculto, cambiarlo a mostrado (display: block)
        content.style.display = "block";
      } else {
        // Si está mostrado, cambiarlo a oculto (display: none)
        content.style.display = "none";
      }
    }

    // Acá está la función para agregar un evento en la colección "reservas" y documento "basededatos",
    // también tiene en cuenta la posibilidad de adjuntar imagen del ponente y reiniciará los campos cuando se registren.
    function agregarEventoFirestore(nombreEvento, claveEvento, fechaEvento, horaEvento, duracionEvento, modalidadEvento, ubicacionPlataforma, lugarPresencial, planEvento, observacionesEvento, nombreOrganizador, emailOrganizador, capitulo, telefonoOrganizador, nombrePonente, emailPonente, telefonoPonente, publicidadComite, observacionesPublicidad, fotoPonenteURL) {
      // Obtener una referencia a la colección "reservas" en Firestore
      const db = firebase.firestore().collection("reservas").doc(claveEvento);

      db.set({
        nombreEvento: nombreEvento,
        claveEvento: claveEvento,
        fechaEvento: fechaEvento,
        horaEvento: horaEvento,
        duracionEvento: duracionEvento,
        modalidadEvento: modalidadEvento,
        ubicacionPlataforma: ubicacionPlataforma,
        lugarPresencial: lugarPresencial,
        planEvento: planEvento,
        observacionesEvento: observacionesEvento,
        nombreOrganizador: nombreOrganizador,
        emailOrganizador: emailOrganizador,
        capitulo: capitulo,
        telefonoOrganizador: telefonoOrganizador,
        nombrePonente: nombrePonente,
        emailPonente: emailPonente,
        telefonoPonente: telefonoPonente,
        publicidadComite: publicidadComite,
        observacionesPublicidad: observacionesPublicidad,
        fotoPonenteURL: fotoPonenteURL,
        // Agrega aquí los demás campos del evento que deseas guardar
        // ...
        detractores: 0,
        pasivos: 0,
        promotores: 0,
        satisfaccion: 0,
      })
      .then((docRef) => {
        // Éxito: el evento se ha registrado correctamente en el documento existente
        // Aquí puedes agregar cualquier otra lógica que desees después de agregar el evento
        // Limpia los campos del formulario después de registrar el evento
        document.getElementById("nombre-evento").value = "";
        document.getElementById("fecha-evento").value = "";
        document.getElementById("hora-evento").value = "";
        document.getElementById("duracion-evento").value = "";
        document.getElementById("modalidad-evento").value = "";
        document.getElementById("ubicacion-plataforma").value = "";
        document.getElementById("lugar-presencial").value = "";
        document.getElementById("plan-evento").value = "";
        document.getElementById("observaciones-evento").value = "";
        document.getElementById("nombre-organizador").value = "";
        document.getElementById("email-organizador").value = "";
        document.getElementById("telefono-organizador").value = "";
        document.getElementById("nombre-ponente").value = "";
        document.getElementById("email-ponente").value = "";
        document.getElementById("telefono-ponente").value = "";
        document.getElementById("publicidad-comite").value = "";
        document.getElementById("observaciones-publicidad").value = "";
        document.getElementById("foto-ponente").value = "";

        // Muestra el mensaje de reserva completada
        mostrarMensajeReservar();

        // Oculta el contenido del acordeón
        var content = document.getElementById("acordeon1-content");
        content.style.display = "none";
      })
      .catch((error) => {
        // Error: hubo un problema al registrar el evento
        console.error("ERROR AL REGISTRAR EL EVENTO: ", error);
        Swal.fire({
          title: '¡ERROR!',
          text: 'Ha ocurrido un error al registrar el evento. Inténtalo nuevamente más tarde o consulta en el link de dudas, reclamos e inquietudes arriba.',
          icon: 'error',
          imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
          confirmButtonText: 'Aceptar',
          imageWidth: 342, // Ancho de la imagen en píxeles
          imageHeight: 200, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
      });
    }    

    function editarEventoFirestore(nombreEventoReserva, claveEventoReserva, fechaEventoReserva, horaEventoReserva, duracionEventoReserva, modalidadEventoReserva, ubicacionPlataformaReserva, lugarPresencialReserva, planEventoReserva, observacionesEventoReserva, nombreOrganizadorReserva, emailOrganizadorReserva, capituloReserva, telefonoOrganizadorReserva, nombrePonenteReserva, emailPonenteReserva, telefonoPonenteReserva, publicidadComiteReserva, observacionesPublicidadReserva, fotoPonenteURLReserva) {
      // Obtener una referencia al documento del evento en Firestore
      const eventoRef = firebase.firestore().collection("reservas").doc(claveEventoReserva);

      eventoRef.get()
        .then((doc) => {
          if (doc.exists) {
            // El documento existe, actualizar los datos del evento
            return eventoRef.update({
              nombreEvento: nombreEventoReserva,
              fechaEvento: fechaEventoReserva,
              horaEvento: horaEventoReserva,
              duracionEvento: duracionEventoReserva,
              modalidadEvento: modalidadEventoReserva,
              ubicacionPlataforma: ubicacionPlataformaReserva,
              lugarPresencial: lugarPresencialReserva,
              planEvento: planEventoReserva,
              observacionesEvento: observacionesEventoReserva,
              nombreOrganizador: nombreOrganizadorReserva,
              emailOrganizador: emailOrganizadorReserva,
              capitulo: capituloReserva,
              telefonoOrganizador: telefonoOrganizadorReserva,
              nombrePonente: nombrePonenteReserva,
              emailPonente: emailPonenteReserva,
              telefonoPonente: telefonoPonenteReserva,
              publicidadComite: publicidadComiteReserva,
              observacionesPublicidad: observacionesPublicidadReserva,
              fotoPonenteURL: fotoPonenteURLReserva,
              // Agrega aquí los demás campos del evento que deseas actualizar
              // ...
            });
          } else {
            // El documento no existe, mostrar un mensaje indicando que el evento no se encontró
            Swal.fire({
              title: 'Evento no encontrado',
              text: 'No se ha encontrado un evento con la clave proporcionada.',
              icon: 'warning',
              confirmButtonText: 'Aceptar'
            });
            return Promise.reject("Evento no encontrado");
          }
        })
        .then(() => {
          // Éxito: el evento se ha actualizado correctamente en el documento existente
          // Aquí puedes agregar cualquier otra lógica que desees después de actualizar el evento
          // Muestra el mensaje de actualización completada
          mostrarMensajeEditar();

          // Oculta el contenido del acordeón
          var content = document.getElementById("acordeon1-content");
          content.style.display = "none";
        })
        .catch((error) => {
          // Error: hubo un problema al actualizar el evento
          console.error("ERROR AL ACTUALIZAR EL EVENTO: ", error);
          if (error !== "Evento no encontrado") {
            Swal.fire({
              title: '¡ERROR!',
              text: 'Ha ocurrido un error al registrar el evento. Inténtalo nuevamente más tarde o consulta en el link de dudas, reclamos e inquietudes arriba.',
              icon: 'error',
              imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
              confirmButtonText: 'Aceptar',
              imageWidth: 342, // Ancho de la imagen en píxeles
              imageHeight: 200, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
          }
        });
    }

    // Esta función genera una clave de evento aleatoria.
    // La clave tiene siempre una cantidad total de 15 caracteres (letras mayúsculas y dígitos) de forma aleatoria.
    function generarClaveEvento() {
      // Definimos una cadena de caracteres que contendrá letras mayúsculas y dígitos.
      var caracteres = "ABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890123456789";
      
      // Especificamos la longitud deseada para la clave generada.
      var longitud = 15;
      
      // Inicializamos una variable para almacenar la clave generada.
      var claveGenerada = "";

      // Iniciamos un bucle para generar cada carácter de la clave.
      for (var i = 0; i < longitud; i++) {
        // Generamos un número aleatorio entre 0 (inclusive) y la longitud de la cadena de caracteres.
        var indiceAleatorio = Math.floor(Math.random() * caracteres.length);
        
        // Agregamos el carácter correspondiente al índice aleatorio a la clave generada.
        claveGenerada += caracteres.charAt(indiceAleatorio);
      }

      // Devolvemos la clave generada como resultado.
      return claveGenerada;
    }

    function registrarEvento() {

      // Validar que todos los campos estén llenos
      var camposValidos = validarCamposRegistrarReserva();

      // Si todos los campos están llenos, proceder con la reserva
      if (camposValidos) {
        // Verificar si la fecha del evento es válida (mayor a la fecha actual)
        var fechaEvento = new Date(document.getElementById("fecha-evento").value);
        var horaEvento = new Date(document.getElementById("hora-evento").value);
        console.log("horaEvento: " + horaEvento);
        console.log("duracionEvento: " + duracionEvento);
        var duracionEvento = new Date(document.getElementById("duracion-evento").value);
        var fechaActual = new Date()//.toISOString().slice(0, 10);
        var fechaActualISOS = new Date().toISOString().slice(0, 10);

        var emailOrganizador = document.getElementById("email-organizador").value;
        // Verificar si el correo es igual a "aneiap_nacional@aneiap.co"
        if (emailOrganizador === "aneiap_nacional@aneiap.co") {
          Swal.fire({
            title: '¡CORREO PROHIBIDO!',
            text: 'El correo aneiap_nacional@aneiap.co no puede ser organizador, recuerda que acá va el correo de quien es el organizador. Por favor, utiliza un correo diferente.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar si el correo comienza con "capitulo" o "directivos"
        if (emailOrganizador.toLowerCase().startsWith("capitulo") || emailOrganizador.toLowerCase().startsWith("directivos")) {
          Swal.fire({
            title: '¡CORREO PROHIBIDO!',
            text: 'Los correos que comienzan con "capitulo" o "directivos" están prohibidos para ser organizador, recuerda que solo el correo del organizador es lo que se escribe acá. Por favor, utiliza un correo diferente.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar si el correo termina con "@aneiap.co"
        if (!emailOrganizador.toLowerCase().endsWith("@aneiap.co")) {
            Swal.fire({
                title: '¡CORREO INCORRECTO!',
                text: 'El correo electrónico debe terminar con "@aneiap.co". Por favor, utiliza un correo válido.',
                icon: 'warning',
                confirmButtonText: 'Aceptar',
                imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
                imageWidth: 120, // Ancho de la imagen en píxeles
                imageHeight: 235, // Alto de la imagen en píxeles
                imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la edición de la reserva
        }

        // Verificar que el correo sea de alguien de la jdn cuando se reserve a nivel nacional ya que estos eventos bloquean el calendario de todos los capítulos.
        var capitulo = document.getElementById("capitulo-organizador").value;
        if (capitulo === "nacional" && capituloUsuario !== "nacional") {
          console.log("el usuario quiere reservar a nivel nacional.")
          Swal.fire({
            title: '¡NO TIENES PERMISOS PARA RESERVAR A NIVEL NACIONAL!',
            text: 'Solo los homólogos nacionales (junta nacional) tienen permiso para reservar a nivel nacional, si deseas hacer una reserva nacional, contáctate con ellos.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Validación de datos para que la fecha con la que se registrará el evento sea mayor a la de hoy.
        if ((fechaEvento < fechaActual) || (fechaEvento < fechaActualISOS)) {
          Swal.fire({
            title: '¡FECHA INCORRECTA!',
            text: 'Debes reservar al menos con 2 días de anticipación, si ya se venció el plazo y deseas hacerlo igualmente, contacta al administrador.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el registro del evento
        }

        // Verificar el formato del teléfono del organizador (debe empezar por 3 y tener 10 dígitos)
        var telefonoOrganizador = document.getElementById("telefono-organizador").value;
        var telefonoOrganizadorRegex = /^3\d{9}$/;

        // Validación de datos para que el teléfono del organizador efectivamente sea un celular válido.
        if (!telefonoOrganizadorRegex.test(telefonoOrganizador)) {
          Swal.fire({
            title: '¡TELÉFONO DEL ORGANIZADOR INCORRECTO!',
            text: 'Digita un número de teléfono válido.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el registro del evento
        }

        // Verificar el formato del teléfono del ponente (si fue diligenciado)
        var telefonoPonente = document.getElementById("telefono-ponente").value;

        // En caso de haber diligenciado el teléfono del ponente, valida que sea una celular válido.
        if (telefonoPonente !== "") {
          var telefonoPonenteRegex = /^3\d{9}$/;

          if (!telefonoPonenteRegex.test(telefonoPonente)) {
            Swal.fire({
              title: '¡TELÉFONO DEL PONENTE INCORRECTO!',
              text: 'Digita un número de teléfono válido.',
              icon: 'warning',
              confirmButtonText: 'Aceptar',
              imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener el registro del evento
          }
        }

          // Obtener el enlace del usuario
          var enlaceGoogleDrive = document.getElementById("foto-ponente").value;
          // Expresión regular para verificar el formato del enlace de Google Drive
          var enlaceGoogleDriveRegex = /^https:\/\/drive\.google\.com\/.*$/;
          var publicidadComite = document.getElementById("publicidad-comite").value

          // Validar el enlace utilizando la expresión regular
          if (publicidadComite === "si") {
          if (enlaceGoogleDrive !== "") {
          if (!enlaceGoogleDriveRegex.test(enlaceGoogleDrive)) {
            Swal.fire({
              title: "¡ENLACE INVÁLIDO!",
              text: "Por favor, ingresa un enlace de Google Drive válido para la foto del ponente.",
              icon: "warning",
              confirmButtonText: 'Aceptar',
              imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener el registro del evento
            }
          }

          }
                  

        // Si todas las verificaciones son exitosas, continuar con el registro del evento
                // Guardar los datos del registro.

        //PRIMERO VERIFICA QUE HAYA DISPONIBILIDAD PARA CUANDO INGRESÓ LA FECHA, HORA Y DURACIÓN
        verificarDisponibilidadRegistro().then(function(result) {
          if (!result) {
          // Si no se muestra ningún swal.fire, ejecuta el código a continuación
          } else {
            // Generar clave evento aleatoria de 10 caracteres (mayúsculas y números)
            var claveEvento = generarClaveEvento();
            // ACÁ EMPIEZA EL PROCESO PARA INSERTAR LA DATA EN LA BASE DE DATOS.
            // Obtenemos todos los campos individualmente
            var nombreEvento = document.getElementById("nombre-evento").value;
            var fechaEvento = document.getElementById("fecha-evento").value;
            var horaEvento = document.getElementById("hora-evento").value;
            var duracionEvento = document.getElementById("duracion-evento").value;
            var modalidadEvento = document.getElementById("modalidad-evento").value;
            var ubicacionPlataforma = document.getElementById("ubicacion-plataforma").value;
            var lugarPresencial = document.getElementById("lugar-presencial").value;
            var planEvento = document.getElementById("plan-evento").value;
            var observacionesEvento = document.getElementById("observaciones-evento").value;
            var nombreOrganizador = document.getElementById("nombre-organizador").value;
            var emailOrganizador = document.getElementById("email-organizador").value;
            var capitulo = document.getElementById("capitulo-organizador").value;
            var telefonoOrganizador = document.getElementById("telefono-organizador").value;
            var nombrePonente = document.getElementById("nombre-ponente").value;
            var emailPonente = document.getElementById("email-ponente").value;
            var telefonoPonente = document.getElementById("telefono-ponente").value;
            var publicidadComite = document.getElementById("publicidad-comite").value;
            var observacionesPublicidad = document.getElementById("observaciones-publicidad").value;
            var fotoPonenteURL = document.getElementById("foto-ponente").value;

            enviarCorreoRegistro(claveEvento,emailOrganizador);
            agregarEventoFirestore(nombreEvento, claveEvento, fechaEvento, horaEvento, duracionEvento, modalidadEvento, ubicacionPlataforma, lugarPresencial, planEvento, observacionesEvento, nombreOrganizador, emailOrganizador, capitulo, telefonoOrganizador, nombrePonente, emailPonente, telefonoPonente, publicidadComite, observacionesPublicidad, fotoPonenteURL);
          }
      }).catch(function(error) {
        // Maneja cualquier error que pueda ocurrir durante la verificación
        console.error("Error al verificar la disponibilidad:", error);
      }); 
    }
  }

    // Variable auxiliar para el apoyo de la edición de una reserva
    var fechaEventoGuardar = 'n/a';
    function guardarBackupFechaEventoReserva() {
      if (fechaEventoGuardar === 'n/a') {
        fechaEventoGuardar = document.getElementById("fecha-evento-reserva").value;
      }
      return fechaEventoGuardar;
    }

    function consultarReserva() {

    var claveEventoConsultar = document.getElementById("clave-evento-reserva").value;

    // Verificar si el campo está vacío
    if (claveEventoConsultar.trim() === "") {
      // Mostrar alerta si el campo está vacío
      Swal.fire({
        title: '¡NO HAS DILIGENCIADO NINGUNA CLAVE!',
        text: 'Por favor, ingresa la clave de la reserva de tu evento.',
        icon: 'warning',
        confirmButtonText: 'Aceptar',
        imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
        imageWidth: 120, // Ancho de la imagen en píxeles
        imageHeight: 235, // Alto de la imagen en píxeles
        imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
      });
      return; // Salir de la función si el campo está vacío
    }

    // Obtener la referencia al documento de la reserva en la base de datos
    var reservasRef = firebase.firestore().collection("reservas").doc(claveEventoConsultar);

    reservasRef.get().then((doc) => {
      if (doc.exists) {
        // El documento existe, obtener los datos de la reserva
        var reserva = doc.data();
        // Asignar los valores de la reserva a los campos del formulario
        document.getElementById("nombre-evento-reserva").value = reserva.nombreEvento;
        document.getElementById("fecha-evento-reserva").value = reserva.fechaEvento;
        document.getElementById("hora-evento-reserva").value = reserva.horaEvento;
        document.getElementById("duracion-evento-reserva").value = reserva.duracionEvento;
        document.getElementById("modalidad-evento-reserva").value = reserva.modalidadEvento;
        document.getElementById("ubicacion-plataforma-reserva").value = reserva.ubicacionPlataforma;
        document.getElementById("lugar-presencial-reserva").value = reserva.lugarPresencial;
        document.getElementById("plan-evento-reserva").value = reserva.planEvento;
        document.getElementById("observaciones-evento-reserva").value = reserva.observacionesEvento;
        document.getElementById("nombre-organizador-reserva").value = reserva.nombreOrganizador;
        document.getElementById("capitulo-organizador-reserva").value = reserva.capitulo;
        document.getElementById("email-organizador-reserva").value = reserva.emailOrganizador;
        document.getElementById("telefono-organizador-reserva").value = reserva.telefonoOrganizador;
        document.getElementById("nombre-ponente-reserva").value = reserva.nombrePonente;
        document.getElementById("email-ponente-reserva").value = reserva.emailPonente;
        document.getElementById("telefono-ponente-reserva").value = reserva.telefonoPonente;
        document.getElementById("publicidad-comite-reserva").value = reserva.publicidadComite;       
        document.getElementById("foto-ponente-reserva").value = reserva.fotoPonenteURL;
        // Guardar el valor de la fecha actual para reponerla en caso de que la validación de disponibiildad falle
        guardarBackupFechaEventoReserva();

        // Mostrar el contenido del acordeón datos-reserva-container
        var datosReservaContainer = document.getElementById("datos-reserva-container");
        datosReservaContainer.style.display = "block";
        var content = document.getElementById("acordeon2-content");
        content.style.display = "block";
      } else {
        // El documento no existe, mostrar un mensaje indicando que la reserva no se encontró
        Swal.fire({
          title: '¡NO EXISTE LA RESERVA QUE BUSCAS!',
          text: 'No se ha encontrado una reserva con la clave proporcionada, rectifica que de verdad exista y que estás escribiendo bien la clave,',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
      }
    }).catch((error) => {
      // Error al consultar el documento
      console.error("Error al consultar la reserva: ", error);
      Swal.fire({
        title: '¡ERROR!',
        text: 'Ha ocurrido un error al consultar la reserva. Inténtalo nuevamente más tarde o consulta con el administrador/creador del sistema.',
        icon: 'error',
        confirmButtonText: 'Aceptar',
        imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
        imageWidth: 120, // Ancho de la imagen en píxeles
        imageHeight: 235, // Alto de la imagen en píxeles
        imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
      });
    });
    }

    function editarReserva() {

      // Verificar que el correo sea de alguien de la jdn cuando se reserve a nivel nacional ya que estos eventos bloquean el calendario de todos los capítulos.
      var capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
      var emailOrganizadorReserva = document.getElementById("email-organizador-reserva").value;

      // Validar que todos los campos estén llenos y sean válidos
      var camposValidos = validarCamposEdicion();

      // Si todos los campos están llenos y son válidos, proceder con la edición de la reserva
      if (camposValidos) {
        // Verificar si la fecha del evento es válida (mayor a la fecha actual)
        var fechaEventoReserva = document.getElementById("fecha-evento-reserva").value;
        console.log("la fecha nueva es:" + fechaEventoReserva);
        var fechaActual = new Date()//.toISOString().slice(0, 10);
        var fechaActualISOS = new Date().toISOString().slice(0, 10);

        // Verificar si el correo es igual a "aneiap_nacional@aneiap.co"
        if (emailOrganizadorReserva === "aneiap_nacional@aneiap.co") {
          console.log("email del organizador: " + emailOrganizadorReserva)
          Swal.fire({
            title: '¡CORREO PROHIBIDO!',
            text: 'El correo aneiap_nacional@aneiap.co no puede ser organizador, recuerda que acá va el correo de quien es el organizador. Por favor, utiliza un correo diferente.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar si el correo comienza con "capitulo" o "directivos"
        if (emailOrganizadorReserva.toLowerCase().startsWith("capitulo") || emailOrganizadorReserva.toLowerCase().startsWith("directivos")) {
          Swal.fire({
            title: '¡CORREO PROHIBIDO!',
            text: 'Los correos que comienzan con "capitulo" o "directivos" están prohibidos para ser organizador, recuerda que solo el correo del organizador es lo que se escribe acá. Por favor, utiliza un correo diferente.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar si el correo termina con "@aneiap.co"
        if (!emailOrganizadorReserva.toLowerCase().endsWith("@aneiap.co")) {
            Swal.fire({
                title: '¡CORREO INCORRECTO!',
                text: 'El correo electrónico debe terminar con "@aneiap.co". Por favor, utiliza un correo válido.',
                icon: 'warning',
                confirmButtonText: 'Aceptar',
                imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
                imageWidth: 120, // Ancho de la imagen en píxeles
                imageHeight: 235, // Alto de la imagen en píxeles
                imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la edición de la reserva
        }

        // Verificar que el correo sea de alguien de la jdn cuando se reserve a nivel nacional ya que estos eventos bloquean el calendario de todos los capítulos.
        var capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
        if (capituloReserva === "nacional" && capituloUsuario !== "nacional") {
          Swal.fire({
            title: '¡NO TIENES PERMISOS PARA RESERVAR A NIVEL NACIONAL!',
            text: 'Solo los homólogos nacionales (junta nacional) tienen permiso para reservar a nivel nacional, si deseas hacer una reserva nacional, contáctate con ellos.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        if ((fechaEventoReserva < fechaActual) || (fechaEventoReserva < fechaActualISOS)) {
          Swal.fire({
            title: '¡FECHA INCORRECTA!',
            text: 'Debes reservar al menos con 2 días de anticipación, si ya se venció el plazo y deseas hacerlo igualmente, contacta al administrador.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar el formato del teléfono del organizador (debe empezar por 3 y tener 10 dígitos)
        var telefonoOrganizadorReserva = document.getElementById("telefono-organizador-reserva").value;
        var telefonoOrganizadorReservaRegex = /^3\d{9}$/;

        if (!telefonoOrganizadorReservaRegex.test(telefonoOrganizadorReserva)) {
          Swal.fire({
            title: '¡TELÉFONO DEL ORGANIZADOR INCORRECTO!',
            text: 'Digita un número de teléfono válido.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Verificar el formato del teléfono del ponente (debe empezar por 3 y tener 10 dígitos) si está diligenciado
        var telefonoPonenteReserva = document.getElementById("telefono-ponente-reserva").value;
        if (telefonoPonenteReserva !== "" && !telefonoOrganizadorReservaRegex.test(telefonoPonenteReserva)) {
          Swal.fire({
            title: '¡TELÉFONO DEL PONENTE INCORRECTO!',
            text: 'Digita un número de teléfono válido.',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
        }

        // Obtener el enlace del usuario
        var enlaceGoogleDriveReserva = document.getElementById("foto-ponente-reserva").value;
        // Expresión regular para verificar el formato del enlace de Google Drive
        var enlaceGoogleDriveRegex = /^https:\/\/drive\.google\.com\/.*$/;
        var publicidadComiteReserva = document.getElementById("publicidad-comite-reserva").value

        // Validar el enlace utilizando la expresión regular
        if (publicidadComiteReserva === "si") {
        if (enlaceGoogleDriveReserva !== "") {
        if (!enlaceGoogleDriveRegex.test(enlaceGoogleDriveReserva)) {
          Swal.fire({
            title: "¡ENLACE INVÁLIDO!",
            text: "Por favor, ingresa un enlace de Google Drive válido para la foto del ponente.",
            icon: "warning",
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el registro del evento
          }
        }

        }

        // Aquí realizarías la lógica para verificar la disponibilidad de horarios
        var claveEventoReserva = document.getElementById("clave-evento-reserva").value;
        var fechaEventoReserva = document.getElementById("fecha-evento-reserva").value;
        var horaEventoReserva = document.getElementById("hora-evento-reserva").value;
        var duracionEventoReserva = document.getElementById("duracion-evento-reserva").value;

        // Lógica para verificar disponibilidad (puedes basarte en tu función ConsultarDisponibilidadReservas)
        // Obtener la fecha del evento con claveEventoReserva de la base de datos
        var eventoRef = firebase.firestore().collection("reservas").doc(claveEventoReserva);

        eventoRef.get().then((doc) => {
          if (doc.exists) {
            // El documento existe, realizar operaciones relacionadas con el evento
            // El documento existe, obtener los datos de la reserva
            var reserva = doc.data();
            //var fechaEventoDB = doc.data().fechaEvento.toDate();
            var fechaEventoDB = reserva.fechaEvento;
            console.log("la fecha en la database es:" + fechaEventoDB);

            // Verificar si hay disponibilidad para esa fecha y hora de edición
            verificarDisponibilidadEdicion().then(function(result) {
              if (!result) {
                // Si no se muestra ningún swal.fire, ejecuta el código a continuación
              } else {
                // Obtenemos todos los campos individualmente
                var nombreEventoReserva = document.getElementById("nombre-evento-reserva").value;
                var claveEventoReserva = document.getElementById("clave-evento-reserva").value;
                var fechaEventoReserva = document.getElementById("fecha-evento-reserva").value;
                var horaEventoReserva = document.getElementById("hora-evento-reserva").value;
                var duracionEventoReserva = document.getElementById("duracion-evento-reserva").value;
                var modalidadEventoReserva = document.getElementById("modalidad-evento-reserva").value;
                var ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma-reserva").value;
                var lugarPresencialReserva = document.getElementById("lugar-presencial-reserva").value;
                var planEventoReserva = document.getElementById("plan-evento-reserva").value;
                var observacionesEventoReserva = document.getElementById("observaciones-evento-reserva").value;
                var nombreOrganizadorReserva = document.getElementById("nombre-organizador-reserva").value;
                var emailOrganizadorReserva = document.getElementById("email-organizador-reserva").value;
                var capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
                var telefonoOrganizadorReserva = document.getElementById("telefono-organizador-reserva").value;
                var nombrePonenteReserva = document.getElementById("nombre-ponente-reserva").value;
                var emailPonenteReserva = document.getElementById("email-ponente-reserva").value;
                var telefonoPonenteReserva = document.getElementById("telefono-ponente-reserva").value;
                var publicidadComiteReserva = document.getElementById("publicidad-comite-reserva").value;
                var observacionesPublicidadReserva = document.getElementById("observaciones-publicidad-reserva").value;
                var fotoPonenteURLReserva = document.getElementById("foto-ponente-reserva").value;

                enviarCorreoEdicion();
                editarEventoFirestore(nombreEventoReserva, claveEventoReserva, fechaEventoReserva, horaEventoReserva, duracionEventoReserva, modalidadEventoReserva, ubicacionPlataformaReserva, lugarPresencialReserva, planEventoReserva, observacionesEventoReserva, nombreOrganizadorReserva, emailOrganizadorReserva, capituloReserva, telefonoOrganizadorReserva, nombrePonenteReserva, emailPonenteReserva, telefonoPonenteReserva, publicidadComiteReserva, observacionesPublicidadReserva, fotoPonenteURLReserva);
                // Restablecer los campos a su valor por defecto (vacío)
                // Ocultar el contenido del acordeón datos-reserva-container
                var datosReservaContainer = document.getElementById("datos-reserva-container");
                datosReservaContainer.style.display = "none";
                var content = document.getElementById("acordeon2-content");
                content.style.display = "none";
              }
            }).catch(function(error) {
              // Maneja cualquier error que pueda ocurrir durante la verificación
              console.error("Error al verificar la disponibilidad:", error);
            });

              // Mostrar mensaje de éxito
              // El mensaje de editar lo arroja la función editarDisponibilidad
          } else {
            // El documento no existe, mostrar mensaje de error
            Swal.fire({
              title: '¡NO EXISTE EL EVENTO QUE BUSCAS!',
              text: 'Verifica que estés escribiendo una clave de evento que de verdad exista.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return;
          }
        }).catch(function(error) {
          // Manejar errores de consulta aquí
          // Mostrar una alerta tipo SweetAlert en caso de error
          console.log("Error al consultar Firebase: " + error);
          Swal.fire({
            title: 'Error',
            text: 'Hubo en error con el código, consulta al administrador/creador del sistema.',
            icon: 'error',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return;
        });
      }
    }

    // Esta función elimina cada reserva que el usuario desee eliminar, también 
    function eliminarReserva() {
        // Obtener los valores de los campos a verificar
        var fechaEventoEliminarsub = document.getElementById("fecha-evento-eliminar").value;
        var horaEventoEliminar = document.getElementById("hora-evento-eliminar").value;
        var claveEventoEliminar = document.getElementById("clave-evento-eliminar").value;

        // Crear una lista para almacenar los nombres de los campos faltantes
        var camposFaltantes = [];

        // Verificar si cada campo está vacío y agregar su nombre a la lista si es el caso
        if (fechaEventoEliminarsub.trim() === "") {
            camposFaltantes.push("Fecha del evento. ");
        }
        if (horaEventoEliminar.trim() === "") {
            camposFaltantes.push("Hora del evento. ");
        }
        if (claveEventoEliminar.trim() === "") {
            camposFaltantes.push("Clave del evento.");
        }
        var fechaEventoEliminarSub = new Date(document.getElementById("fecha-evento-eliminar").value);
        // Si hay campos faltantes, mostrar mensaje de error personalizado
        if (camposFaltantes.length > 0) {
            var mensajeError = "Faltan campos por diligenciar:\n\n" + camposFaltantes.join("\n");
            Swal.fire({
            title: '¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!',
            text: mensajeError,
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        } else {
            // Si no hay campos faltantes, proceder con la eliminación de la reserva
            Swal.fire({
            title: '¿CONFIRMAS QUE DESEAS ELIMINAR LA RESERVA?',
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'CONFIRMO',
            cancelButtonText: 'NO',
            imageUrl: 'https://i.ibb.co/VSh1RT4/AVATAR-SEGUROELIMINAR-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            }).then((result) => {
            // Si el usuario hizo clic en el botón "CONFIRMO", proceder a eliminar la reserva
            if (result.isConfirmed) {
                // Realizar la eliminación de la reserva en la base de datos
                var claveEventoEliminar = document.getElementById("clave-evento-eliminar").value;
                console.log(claveEventoEliminar);
                // Obtener una referencia al documento que se desea eliminar
                var reservaRef = firebase.firestore().collection("reservas").doc(claveEventoEliminar);

                // Verificar si el documento existe antes de intentar eliminarlo
                reservaRef.get().then((doc) => {
                  if (doc.exists) {
                    // El documento existe, proceder con la eliminación
                    var fechaReservaSub = new Date(doc.data().fechaEvento);
                    var fechaReserva = fechaReservaSub.toISOString().slice(0, 10);
                    var fechaEventoEliminar = fechaEventoEliminarSub.toISOString().slice(0, 10);
                    var horaReserva = doc.data().horaEvento;
                    var duracionReserva = doc.data().duracionEvento;
                    var nombreEventoReserva= doc.data().nombreEvento;
                    var nombreOrganizadorReserva = doc.data().nombreOrganizador;
                    var correoReserva = doc.data().emailOrganizador;
                    // Dividir la hora y los minutos en variables
                    var partesHora = horaEventoEliminar.split(":");
                    var hora = parseInt(partesHora[0], 10); // Convertir la hora en número entero
                    var minutos = parseInt(partesHora[1], 10); // Convertir los minutos en número entero
                    // Calcular el número total de minutos después de la medianoche
                    var minutosDespuesDeMedianoche = hora * 60 + minutos;
                    // Verificar si la fecha es la apropiada
                    if (fechaReserva !== fechaEventoEliminar) {
                      Swal.fire({
                        title: '¡FECHA INCORRECTA!',
                        text: 'La fecha del evento debe ser exactamente igual a la que tiene la reserva.',
                        icon: 'warning',
                        confirmButtonText: 'Aceptar',
                        imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
                        imageWidth: 120, // Ancho de la imagen en píxeles
                        imageHeight: 235, // Alto de la imagen en píxeles
                        imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                      });
                      return; // Detener la edición de la reserva
                    }
                    if (horaReserva !== '' + minutosDespuesDeMedianoche) {
                      Swal.fire({
                        title: '¡HORA INCORRECTA!',
                        text: 'La hora del evento debe ser exactamente igual a la que tiene la reserva.',
                        icon: 'warning',
                        confirmButtonText: 'Aceptar',
                        imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
                        imageWidth: 120, // Ancho de la imagen en píxeles
                        imageHeight: 235, // Alto de la imagen en píxeles
                        imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                      });
                      return; // Detener la edición de la reserva
                    }
                    reservaRef.delete().then(() => {
                      // Eliminación exitosa
                      console.log("Reserva eliminada con éxito.");
                      // Resetear los campos del acordeón 3 a sus valores por defect luego de enviar correo.
                      enviarCorreoEliminar(claveEventoEliminar,nombreOrganizadorReserva,correoReserva,nombreEventoReserva,fechaReserva,horaReserva,duracionReserva);
                      document.getElementById("fecha-evento-eliminar").value = "";
                      document.getElementById("hora-evento-eliminar").value = "";
                      document.getElementById("clave-evento-eliminar").value = "";
                      // Ocultar el acordeón 3
                      var content = document.getElementById("acordeon3-content");
                      content.style.display = "none";
                      // Mostrar mensaje de éxito
                      mostrarMensajeEliminar();
                      // Ocultar el acordeón 3
                      var content = document.getElementById("acordeon3-content");
                      content.style.display = "none";
                      // Mostrar mensaje de éxito
                      //mostrarMensajeEliminar();
                    }).catch((error) => {
                      // Error al intentar eliminar el documento
                      console.error("NO SE PUDO ELIMINAR LA RESERVA", error);
                      Swal.fire({
                        title: '¡ERROR!',
                        text: 'Ha ocurrido un error al eliminar la reserva. Inténtalo nuevamente más tarde o ponte en contacto con el administrador de la plataforma.',
                        icon: 'error',
                        confirmButtonText: 'Aceptar',
                        imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
                        imageWidth: 120, // Ancho de la imagen en píxeles
                        imageHeight: 235, // Alto de la imagen en píxeles
                        imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                      });
                    });
                  } else {
                    // El documento no existe, mostrar un mensaje indicando que la reserva no se encontró
                    Swal.fire({
                      title: 'NO EXISTE ESTA RESERVA',
                      text: 'No se ha encontrado una reserva con la clave proporcionada, rectifica que estás diligenciando la clave correcta.',
                      icon: 'warning',
                      confirmButtonText: 'Aceptar',
                      imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
                      imageWidth: 120, // Ancho de la imagen en píxeles
                      imageHeight: 235, // Alto de la imagen en píxeles
                      imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                    });
                  }
                }).catch((error) => {
                  // Error al consultar el documento
                  console.error("ERROR AL CONSULTAR LA RESERVA", error);
                  Swal.fire({
                    title: '¡ERROR!',
                    text: 'Ha ocurrido un error al consultar la reserva. Inténtalo nuevamente más tarde o ponte en contacto con el administrador de la plataforma',
                    icon: 'error',
                    confirmButtonText: 'Aceptar',
                    imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
                    imageWidth: 120, // Ancho de la imagen en píxeles
                    imageHeight: 235, // Alto de la imagen en píxeles
                    imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                  });
                });
            }
            });
        }
        }

    // Esta función permite la acción de mostrar un mensaje de éxito al momento de registrar una reserva.        
    function mostrarMensajeReservar() {
      Swal.fire({
      title: '¡RESERVA COMPLETADA!',
      text: 'Su reserva ha sido registrada y APROBADA con ÉXITO, revisa tu correo para confirmar la reserva y obtener tu CLAVE de evento.',
      icon: 'success',
      showConfirmButton: true, // Muestra el botón de confirmación
      allowOutsideClick: false, // Bloquea la interacción fuera del mensaje emergente
      allowEscapeKey: false, // Bloquea la interacción con la tecla Esc
      imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
      imageWidth: 120, // Ancho de la imagen en píxeles
      imageHeight: 235, // Alto de la imagen en píxeles
      imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
      }).then((result) => {
      // Esta función se ejecutará después de que el usuario haga clic en el botón de confirmación
      });
    }

    // Esta función permite la acción de mostrar un mensaje de éxito al momento de actualizar una reserva.    
    function mostrarMensajeEditar() {
      Swal.fire({
      title: '¡ACTUALIZACIÓN DE RESERVA COMPLETADA!',
      text: 'Su reserva ha sido ACTUALIZADA con ÉXITO, revisa tu correo para confirmar la actualización, recuerda que no cambias de CLAVE de evento.',
      icon: 'success',
      showConfirmButton: true, // Muestra el botón de confirmación
      allowOutsideClick: false, // Bloquea la interacción fuera del mensaje emergente
      allowEscapeKey: false, // Bloquea la interacción con la tecla Esc
      imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
      imageWidth: 120, // Ancho de la imagen en píxeles
      imageHeight: 235, // Alto de la imagen en píxeles
      imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
      }).then((result) => {
      // Esta función se ejecutará después de que el usuario haga clic en el botón de confirmación
      });
    }

    // Esta función permite la acción de mostrar un mensaje de éxito al momento de eliminar una reserva.
    function mostrarMensajeEliminar() {
      Swal.fire({
      title: '¡ELIMININACIÓN DE RESERVA COMPLETADA!',
      text: 'Su reserva ha sido ELIMINADA con ÉXITO, revisa tu correo para confirmar que ha sido eliminada',
      icon: 'success',
      showConfirmButton: true, // Muestra el botón de confirmación
      allowOutsideClick: false, // Bloquea la interacción fuera del mensaje emergente
      allowEscapeKey: false, // Bloquea la interacción con la tecla Esc
      imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
      imageWidth: 120, // Ancho de la imagen en píxeles
      imageHeight: 235, // Alto de la imagen en píxeles
      imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
      }).then((result) => {
      // Esta función se ejecutará después de que el usuario haga clic en el botón de confirmación
      });
    }

    // Esta función verifica si hacen falta campos obligatorios en la sección "REGISTRAR RESERVA" y en caso de hacer 
    // falta arrojará una alerta diciendo que hacen falta campos y te dirá también cuáles campos son los que faltan.
    function validarCamposRegistrarReserva() {
      // Obtener los valores de los campos
      var nombreEvento = document.getElementById("nombre-evento").value;
      var fechaEvento = document.getElementById("fecha-evento").value;
      var horaEvento = document.getElementById("hora-evento").value;
      var duracionEvento = document.getElementById("duracion-evento").value;
      var modalidadEvento = document.getElementById("modalidad-evento").value;
      var ubicacionPlataforma = document.getElementById("ubicacion-plataforma").value;
      var lugarPresencial = document.getElementById("lugar-presencial").value;
      var planEvento = document.getElementById("plan-evento").value;
      var observacionesEvento = document.getElementById("observaciones-evento").value;
      var nombreOrganizador = document.getElementById("nombre-organizador").value;
      var emailOrganizador = document.getElementById("email-organizador").value;
      var capitulo = document.getElementById("capitulo-organizador").value;
      var telefonoOrganizador = document.getElementById("telefono-organizador").value;
      var nombrePonente = document.getElementById("nombre-ponente").value;
      var emailPonente = document.getElementById("email-ponente").value;
      var telefonoPonente = document.getElementById("telefono-ponente").value;
      var publicidadComite = document.getElementById("publicidad-comite").value.toLowerCase();
      var fotoPonente = document.getElementById("foto-ponente").value;

      // Lista para almacenar los campos faltantes
      var camposFaltantes = [];

      // Verificar qué campos están vacíos y agregar sus nombres a la lista
      if (nombreEvento.trim() === "") {
        camposFaltantes.push("Nombre del evento");
      }
      if (fechaEvento.trim() === "") {
        camposFaltantes.push("Fecha del evento");
      }
      if (horaEvento.trim() === "") {
        camposFaltantes.push("Hora del evento");
      }
      if (duracionEvento.trim() === "") {
        camposFaltantes.push("Duración del evento");
      }
      if (modalidadEvento.trim() === "") {
        camposFaltantes.push("Modalidad del evento");
      }
      if (ubicacionPlataforma.trim() === "" && lugarPresencial.trim() === "") {
            camposFaltantes.push("Ubicación en plataforma o Lugar presencial");
        }
      if (planEvento.trim() === "") {
        camposFaltantes.push("Plan del evento");
      }
      if (nombreOrganizador.trim() === "") {
        camposFaltantes.push("Nombre del organizador");
      }
      if (emailOrganizador.trim() === "") {
        camposFaltantes.push("Email del organizador");
      }
      if (capitulo.trim() === "") {
        camposFaltantes.push("Capítulo");
      }
      if (telefonoOrganizador.trim() === "") {
        camposFaltantes.push("Teléfono del organizador");
      }
      if (nombrePonente.trim() === "") {
        camposFaltantes.push("Nombre del ponente");
      }
      if (publicidadComite === "") {
          camposFaltantes.push("Publicidad SÍ/NO");
      }   
      if (publicidadComite === "si" && fotoPonente.trim() === "") {
        camposFaltantes.push("Foto del ponente");
      }

      // Mostrar la alerta si hay campos faltantes con la concatenación de los campos faltantes.
      if (camposFaltantes.length > 0) {
        var mensaje = "Faltan campos por diligenciar:\n";
        for (var i = 0; i < camposFaltantes.length; i++) {
          mensaje += "- " + camposFaltantes[i] + "\n";
        }

        Swal.fire({
          title: '¡FALTAN CAMPOS POR DILIGENCIAR EN TU RESERVA!',
          text: mensaje,
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return false;
      }

      return true; // Todos los campos están llenos
    }

    // Esta función verifica si hacen falta campos obligatorios en la sección "EDITAR RESERVA" y en caso de hacer 
    // falta arrojará una alerta diciendo que hacen falta campos y te dirá también cuáles campos son los que faltan.
    function validarCamposEdicion() {
        var camposFaltantes = [];

        // Obtener los valores de los campos a verificar
        var nombreEventoReserva = document.getElementById("nombre-evento-reserva").value;
        var fechaEventoReserva = document.getElementById("fecha-evento-reserva").value;
        var horaEventoReserva = document.getElementById("hora-evento-reserva").value;
        var duracionEventoReserva = document.getElementById("duracion-evento-reserva").value;
        var modalidadEventoReserva = document.getElementById("modalidad-evento-reserva").value;
        var ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma-reserva").value;
        var lugarPresencialReserva = document.getElementById("lugar-presencial-reserva").value;
        var planEventoReserva = document.getElementById("plan-evento-reserva").value;
        var observacionesEventoReserva = document.getElementById("observaciones-evento-reserva").value;
        var nombreOrganizadorReserva = document.getElementById("nombre-organizador-reserva").value;
        var emailOrganizadorReserva = document.getElementById("email-organizador-reserva").value;
        var capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
        var telefonoOrganizadorReserva = document.getElementById("telefono-organizador-reserva").value;
        var nombrePonenteReserva = document.getElementById("nombre-ponente-reserva").value;
        var emailPonenteReserva = document.getElementById("email-ponente-reserva").value;
        var telefonoPonenteReserva = document.getElementById("telefono-ponente-reserva").value;
        var publicidadComiteReserva = document.getElementById("publicidad-comite-reserva").value;
        var fotoPonenteReserva = document.getElementById("foto-ponente-reserva").value;
        
        // Verificar si cada campo está vacío y agregar su nombre a la lista si es el caso
        if (nombreEventoReserva.trim() === "") {
            camposFaltantes.push("Nombre del evento");
        }
        if (fechaEventoReserva.trim() === "") {
            camposFaltantes.push("Fecha del evento");
        }
        if (horaEventoReserva.trim() === "") {
            camposFaltantes.push("Hora del evento");
        }
        if (duracionEventoReserva.trim() === "") {
            camposFaltantes.push("Duración del evento");
        }
        if (modalidadEventoReserva.trim() === "") {
            camposFaltantes.push("Modalidad del evento");
        }
        if (ubicacionPlataformaReserva.trim() === "" && lugarPresencialReserva.trim() === "") {
            camposFaltantes.push("Ubicación en plataforma o Lugar presencial");
        }
        if (planEventoReserva.trim() === "") {
            camposFaltantes.push("Plan del evento");
        }
        if (nombreOrganizadorReserva.trim() === "") {
            camposFaltantes.push("Nombre del organizador");
        }
        if (emailOrganizadorReserva.trim() === "") {
            camposFaltantes.push("Email del organizador");
        }
        if (capituloReserva.trim() === "") {
            camposFaltantes.push("Capítulo");
        }
        if (telefonoOrganizadorReserva.trim() === "") {
            camposFaltantes.push("Teléfono del organizador");
        }
        if (nombrePonenteReserva.trim() === "") {
            camposFaltantes.push("Nombre del ponente");
        }
        if (publicidadComiteReserva === "") {
          camposFaltantes.push("Publicidad SÍ/NO");
        }        
        if (publicidadComiteReserva === "si" && fotoPonenteReserva.trim() === "") {
          camposFaltantes.push("Foto del ponente");
        }

        // Mostrar la alerta si hay campos faltantes con la concatenación de cada uno de ellos (los faltantes).
        if (camposFaltantes.length > 0) {
            var mensaje = "Faltan campos por diligenciar:\n";
            for (var i = 0; i < camposFaltantes.length; i++) {
            mensaje += "- " + camposFaltantes[i] + "\n";
            }

            Swal.fire({
            title: '¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!',
            text: mensaje,
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });

            return false;
        }

        return true; // Todos los campos están llenos y son válidos
        }

    function ConsultarDisponibilidadReservas() {
      var fechaConsulta = document.getElementById("fecha-consulta").value;
      var capituloConsulta = document.getElementById("capitulo-consulta").value;
      var fechaHoy = new Date().toISOString().slice(0, 10);

      // Acá se verifica que se haya insertado una fecha, si no insertaste nada, para el proceso y le notifica al usuario.
      if (fechaConsulta.trim() === "") {
        // Mostrar mensaje de error si no se ha seleccionado una fecha válida
        Swal.fire({
          title: '¡FECHA NO SELECCIONADA!',
          text: 'Por favor, selecciona una fecha para consultar la disponibilidad.',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return;
      }
      if (capituloConsulta.trim() === "") {
        // Mostrar mensaje de error si no se ha seleccionado una fecha válida
        Swal.fire({
          title: '¡CAPÍTULO NO SELECCIONADO!',
          text: 'Por favor, selecciona el capítulo del cual deseas consultar la disponibilidad.',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return;
      }
      /* Comentario opcional por si se desea considerar o no la limitación de fecha de hoy al consultar
      if (fechaConsulta < fechaHoy) {
        // Mostrar mensaje de error si la fecha seleccionada es menor o igual a la fecha actual
        Swal.fire({
          title: '¡FECHA INCORRECTA!',
          text: 'Por favor, selecciona una fecha mayor a la fecha de HOY para consultar la disponibilidad.',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return;
      }*/

      // Aquí realizarías la lógica para consultar la disponibilidad de reservas con la fecha seleccionada
      var fechaConsulta = document.getElementById("fecha-consulta").value;
      // Resto del código para validar la fecha y mostrar mensajes de error...
      // Obtener todos los eventos reservados para la fecha seleccionada
      var reservasRef = firebase.firestore().collection("reservas");
      var consulta;

      if (capituloConsulta === "ANEIAP NACIONAL") {
        // Si se seleccionó "ANEIAP NACIONAL", consultar solo las reservas para toda la Asociación
        consulta = reservasRef.where("fechaEvento", "==", fechaConsulta).where("capitulo", "==", "nacional");
      } else {
        // Consultar las reservas para el capítulo seleccionado y para toda la Asociación (ANEIAP NACIONAL)
        consulta = reservasRef.where("fechaEvento", "==", fechaConsulta).where("capitulo", "in", [capituloConsulta, "nacional"]);
      }

      consulta.get().then(function(querySnapshot) {
        // Arreglo que representará el estado de disponibilidad de cada intervalo
        var disponibilidad = Array(28).fill(true); // Inicialmente, todos los intervalos están disponibles (verde)

        // Ciclo para revisar cada evento reservado para la fecha seleccionada
        querySnapshot.forEach(function(doc) {
          var horaEvento = doc.data().horaEvento; // Hora en minutos (ej. 480 para 08:00)
          var duracionEvento = doc.data().duracionEvento; // Duración en minutos (ej. 120 para 2 horas)

          // Calcular los índices de inicio y fin del intervalo que ocupará el evento
          var inicioIntervalo = Math.floor((horaEvento - 480) / 30);
          var finIntervalo = inicioIntervalo+(duracionEvento/30);
          
          // Marcar los intervalos como ocupados (rojo) en el arreglo de disponibilidad
          for (var i = inicioIntervalo; i < finIntervalo; i++) {
            disponibilidad[i] = false;
          }
        });

        // Actualizar la visualización de disponibilidad en el HTML
        var disponibilidadContainer = document.querySelector(".disponibilidad-container");
        var disponibilidadItems = disponibilidadContainer.getElementsByClassName("disponibilidad-item");
        for (var i = 0; i < disponibilidad.length; i++) {
          if (disponibilidad[i]) {
            disponibilidadItems[i].style.backgroundColor = "green"; // Establecer fondo verde para intervalo disponible
          } else {
            disponibilidadItems[i].style.backgroundColor = "red"; // Establecer fondo rojo para intervalo ocupado
          }
        }

        // Mostrar mensaje de éxito
        Swal.fire({
          title: '¡CONSULTA DE DISPONIBILIDAD REALIZADA!',
          text: 'La consulta se realizó con éxito para la fecha seleccionada. Los horarios en rojo representan que ya están reservados, los que están en color verde son los disponibles.',
          icon: 'success',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });

        // Construir la sección de eventos programados
        var eventosProgramadosDiv = document.getElementById("eventos-programados");
        eventosProgramadosDiv.innerHTML = ""; // Limpiar el contenido anterior

        var eventos = [];
        var indice = 1;
        querySnapshot.forEach(function(doc) {
          var nombreEvento = doc.data().nombreEvento;
          var nombreOrganizador = doc.data().nombreOrganizador;
          var horaEvento = doc.data().horaEvento;
          var correoOrganizador = doc.data().emailOrganizador;
          var capitulo = doc.data().capitulo;

          var hora = Math.floor(horaEvento / 60); // Obtener la hora del evento
          var minutos = horaEvento % 60; // Obtener los minutos del evento
          var horaFormateada = (hora < 10 ? "0" + hora : hora) + ":" + (minutos < 10 ? "0" + minutos : minutos); // Formatear la hora

          eventos.push({ indice: numeroAEmoji(indice), nombre: nombreEvento, organizador: nombreOrganizador, capitulo: capitulo, hora: horaFormateada, correo: correoOrganizador });
          indice++;
        });

        // Mostrar los eventos en la sección
        if (eventos.length > 0) {
          eventos.forEach(function(evento) {
            eventosProgramadosDiv.innerHTML += "<b>Evento </b>" + evento.indice + ": <b>Nombre espacio: </b>" + evento.nombre + " - <b>Organizador: </b>" + evento.organizador + " - <b>Capítulo: </b>" + evento.capitulo + " - <b>Hora: </b>" + evento.hora + " - <b>Correo: </b>" + evento.correo + "<br>";
          });
        } else {
          eventosProgramadosDiv.innerHTML = "No hay eventos programados para esta fecha y capítulo.";
        }
      }).catch(function(error) {
        console.log("Error obteniendo reservas:", error);
        // Mostrar mensaje de error en caso de fallo en la consulta a Firebase
      });
    }

    var consultaDiaria = true; // Variable para almacenar el estado de la consulta (diaria por defecto)

    function alternarConsulta() {
        consultaDiaria = !consultaDiaria; // Alternar entre consulta diaria y semanal
        var botonAlternar = document.getElementById("alternarConsulta");
        var consultaDiariaDiv = document.getElementById("consultaDiaria");
        var consultaSemanalDiv = document.getElementById("consultaSemanal");
        if (consultaDiaria) {
            botonAlternar.textContent = "Cambiar a calendario semanal";
            consultaDiariaDiv.style.display = "block"; // Mostrar la consulta diaria
            consultaSemanalDiv.style.display = "none"; // Ocultar la consulta semanal
        } else {
            botonAlternar.textContent = "Cambiar a calendario diario";
            consultaDiariaDiv.style.display = "none"; // Ocultar la consulta diaria
            consultaSemanalDiv.style.display = "block"; // Mostrar la consulta semanal
        }
    }

    function ConsultarDisponibilidadSemanal() {
      var fechaConsultaDirecta = document.getElementById("fecha-consulta-semanal").value;
      var fechaConsulta = new Date(document.getElementById("fecha-consulta-semanal").value);
      var capituloConsulta = document.getElementById("capitulo-consulta-semanal").value;

      // Verificar que se haya seleccionado una fecha y capítulo
      if (fechaConsultaDirecta.trim() === "" || capituloConsulta.trim() === "") {
        // Mostrar mensaje de error si no se ha seleccionado una fecha o capítulo válidos
        Swal.fire({
          title: '¡FECHA O CAPÍTULO NO SELECCIONADOS!',
          text: 'Por favor, selecciona una fecha y un capítulo para consultar la disponibilidad semanal.',
          icon: 'warning',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png',
          imageWidth: 120,
          imageHeight: 235,
          imagePosition: 'top-start'
        });
        return;
      }

      // Limpiar el contenido anterior del calendario semanal
      var calendarioSemanal = document.getElementById("calendario-semanal");
      calendarioSemanal.innerHTML = "";

      // Crear la tabla del calendario semanal
      var tablaCalendario = document.createElement("table");
      tablaCalendario.classList.add("calendario-semanal-table");
      calendarioSemanal.appendChild(tablaCalendario);

      // Crear el encabezado de la tabla
      var encabezado = tablaCalendario.createTHead().insertRow(0);
      var thDiaSemana = document.createElement("th");
      thDiaSemana.textContent = "Día de la semana";
      encabezado.appendChild(thDiaSemana);
      var thEventosReservados = document.createElement("th");
      thEventosReservados.textContent = "Eventos reservados";
      encabezado.appendChild(thEventosReservados);

      // Crear el cuerpo de la tabla
      var cuerpoTabla = tablaCalendario.createTBody();

      // Obtener la fecha del lunes de la semana
      var lunesSemana = mostrarSemana();

      // Calcular las fechas para cada día de la semana
      var fechaLunes = new Date(lunesSemana);
      var fechaMartes = new Date(fechaLunes);
      fechaMartes.setDate(fechaLunes.getDate() + 1);
      var fechaMiercoles = new Date(fechaLunes);
      fechaMiercoles.setDate(fechaLunes.getDate() + 2);
      var fechaJueves = new Date(fechaLunes);
      fechaJueves.setDate(fechaLunes.getDate() + 3);
      var fechaViernes = new Date(fechaLunes);
      fechaViernes.setDate(fechaLunes.getDate() + 4);
      var fechaSabado = new Date(fechaLunes);
      fechaSabado.setDate(fechaLunes.getDate() + 5);
      var fechaDomingo = new Date(fechaLunes);
      fechaDomingo.setDate(fechaLunes.getDate() + 6);

      // Formatear las fechas en el formato "YYYY-MM-DD"
      var fechaLunesString = convertirFechaTipoFirebaseYDate(fechaLunes);
      var fechaMartesString = convertirFechaTipoFirebaseYDate(fechaMartes);
      var fechaMiercolesString = convertirFechaTipoFirebaseYDate(fechaMiercoles);
      var fechaJuevesString = convertirFechaTipoFirebaseYDate(fechaJueves);
      var fechaViernesString = convertirFechaTipoFirebaseYDate(fechaViernes);
      var fechaSabadoString = convertirFechaTipoFirebaseYDate(fechaSabado);
      var fechaDomingoString = convertirFechaTipoFirebaseYDate(fechaDomingo);

      // Crear las consultas para cada día de la semana
      consultarEventos(fechaLunesString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaMartesString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaMiercolesString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaJuevesString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaViernesString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaSabadoString, cuerpoTabla, capituloConsulta);
      consultarEventos(fechaDomingoString, cuerpoTabla, capituloConsulta);
    }

    // Función para consultar eventos reservados para un día y agregarlos a la tabla
    function consultarEventos(fechaDiaTipoFirebase, cuerpoTabla, capituloConsulta) {
      var fila = cuerpoTabla.insertRow();
      var fechaDiaTipoDate = convertirFechaTipoFirebaseYDate(fechaDiaTipoFirebase)
      var diaSemana = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];
      var textoDia = fechaDiaTipoDate;
      fila.insertCell().textContent = textoDia; // Agregar el día de la semana a la primera columna de la fila

      // Consultar los eventos reservados para el día de la semana actual
      var reservasRef = firebase.firestore().collection("reservas");
      var consulta;
      if (capituloConsulta === "ANEIAP NACIONAL") {
        consulta = reservasRef.where("fechaEvento", "==", fechaDiaTipoFirebase).where("capitulo", "==", "nacional");
      } else {
        consulta = reservasRef.where("fechaEvento", "==", fechaDiaTipoFirebase).where("capitulo", "in", [capituloConsulta, "nacional"]);
      }

      consulta.get().then((querySnapshot) => {
        var numEventos = querySnapshot.size;
        console.log("Número de eventos obtenidos para el día ", fechaDiaTipoFirebase, ":", numEventos);
        var eventos = [];
        querySnapshot.forEach(function(doc) {
          var nombreEvento = doc.data().nombreEvento;
          var nombreOrganizador = doc.data().nombreOrganizador;
          var horaEvento = doc.data().horaEvento;
          var correoOrganizador = doc.data().emailOrganizador;
          var capitulo = doc.data().capitulo;

          var hora = Math.floor(horaEvento / 60); // Obtener la hora del evento
          var minutos = horaEvento % 60; // Obtener los minutos del evento
          var horaFormateada = (hora < 10 ? "0" + hora : hora) + ":" + (minutos < 10 ? "0" + minutos : minutos); // Formatear la hora

          eventos.push({ nombre: nombreEvento, organizador: nombreOrganizador, capitulo: capitulo, hora: horaFormateada, correo: correoOrganizador });
        });

        // Agregar los eventos reservados para el día de la semana actual a la segunda columna de la fila
        if (eventos.length > 0) {
          var eventosReservados = "";
          eventos.forEach(function(evento, indice) {
            eventosReservados += `${numeroAEmoji(indice + 1)} ${evento.nombre} - Organizador: ${evento.organizador} - Capítulo: ${evento.capitulo} - Hora: ${evento.hora} - Correo: ${evento.correo}<br>`;
          });
          fila.insertCell().innerHTML = eventosReservados;
        } else {
          fila.insertCell().innerHTML = "✅ DISPONIBLE POR COMPLETO.";
        }
      }).catch(function(error) {
        console.log("Error obteniendo reservas:", error);
        // Mostrar mensaje de error en caso de fallo en la consulta a Firebase
      });
    }

    function convertirFechaTipoFirebaseYDate(fecha) {
      // Verificar si la fecha es un objeto Date válido
      if (fecha instanceof Date && !isNaN(fecha)) {
        // Extraer el día, mes y año
        var dia = fecha.getDate().toString().padStart(2, '0');
        var mes = (fecha.getMonth() + 1).toString().padStart(2, '0');
        var anio = fecha.getFullYear();

        // Construir la fecha en formato "YYYY-MM-DD"
        return anio + '-' + mes + '-' + dia;
      }
      // Verificar si la fecha es en formato "YYYY-MM-DD"
      else if (/^\d{4}-\d{2}-\d{2}$/.test(fecha)) {
        // Extraer el año, mes y día
        var anio = fecha.substring(0, 4);
        var mes = fecha.substring(5, 7);
        var dia = fecha.substring(8, 10);

        // Construir la fecha en formato "DD/MM/YYYY"
        return dia + '/' + mes + '/' + anio;
      }
      // Verificar si la fecha es en formato "DD/MM/YYYY"
      else if (/^\d{2}\/\d{2}\/\d{4}$/.test(fecha)) {
        // Extraer el día, mes y año
        var dia = fecha.substring(0, 2);
        var mes = fecha.substring(3, 5);
        var anio = fecha.substring(6, 10);

        // Construir la fecha en formato "YYYY-MM-DD"
        return anio + '-' + mes + '-' + dia;
      }
      // Si el formato no es reconocido, retornar null
      else {
        return null;
      }
    }

    var fechaConsultaSemanalInput = document.getElementById("fecha-consulta-semanal");
    fechaConsultaSemanalInput.addEventListener("change", mostrarSemana);
    function mostrarSemana() {
      // Obtener la fecha seleccionada
      let fechaSeleccionada = new Date(document.getElementById("fecha-consulta-semanal").value);
      // Obtener el día de la semana (1 = lunes, ..., 6 = sábado, 7 = domingo)
      let diaSemana = fechaSeleccionada.getDay();
      console.log("diaSemana: " + diaSemana)

      // Calcular la fecha del lunes de la semana
      let lunesSemana = new Date(fechaSeleccionada);
      if (diaSemana === 0) {
        // Si es lunes, la semana comienza ese mismo día y termina sumándole 6 días
        lunesSemana.setDate(fechaSeleccionada.getDate() + 1);
      } else if (diaSemana === 1) {
        // Si es martes, la semana comienza restando 6 días y termina ese mismo día
        lunesSemana.setDate(fechaSeleccionada.getDate());
      } else if (diaSemana === 2) {
        // Si es martes, la semana comienza restando 1 día y termina sumándole 5 días
        lunesSemana.setDate(fechaSeleccionada.getDate() - 1);
      } else if (diaSemana === 3) {
        // Si es miércoles, la semana comienza restando 2 días y termina sumándole 4 días
        lunesSemana.setDate(fechaSeleccionada.getDate() - 2);
      } else if (diaSemana === 4) {
        // Si es jueves, la semana comienza restando 3 días y termina sumándole 3 días
        lunesSemana.setDate(fechaSeleccionada.getDate() - 3);
      } else if (diaSemana === 5) {
        // Si es viernes, la semana comienza restando 4 días y termina sumándole 2 días
        lunesSemana.setDate(fechaSeleccionada.getDate() - 4);
      } else if (diaSemana === 6) {
        // Si es sábado, la semana comienza restando 5 días y termina sumándole 1 día
        lunesSemana.setDate(fechaSeleccionada.getDate() - 5);
      }

      // Calcular la fecha del domingo de la semana
      let domingoSemana = new Date(lunesSemana + 6);
      domingoSemana.setDate(lunesSemana.getDate()+6);

      // Formatear las fechas para mostrarlas
      let formatoFecha = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      let textoLunes = lunesSemana.toLocaleDateString('es-ES', formatoFecha).replace(/\b\w+\b/g, match => `<b>${match}</b>`);
      let textoDomingo = domingoSemana.toLocaleDateString('es-ES', formatoFecha).replace(/\b\w+\b/g, match => `<b>${match}</b>`);
      
      // Convertir los números de día a emojis
      textoLunes = textoLunes.replace(/\d{1,2}/g, match => `${numeroAEmoji(parseInt(match))}`);
      textoDomingo = textoDomingo.replace(/\d{1,2}/g, match => `${numeroAEmoji(parseInt(match))}`);
      
      // Actualizar el texto con la semana seleccionada
      document.getElementById("semana-seleccionada").innerHTML = `Semana del ${textoLunes} al ${textoDomingo}`;

      // Retornar la fecha del lunes
      return new Date(lunesSemana);
    }

    // Función para enviar el correo de edición de reserva
    function enviarCorreoEdicion() {
      // Obtener el correo del organizador para enviarle el correo
      const correoDestino = document.getElementById("email-organizador-reserva").value;
      const claveReserva = document.getElementById("clave-evento-reserva").value;

      const emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      const emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      const emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP
      const destinatario = correoDestino; // Reemplaza con la dirección de correo del destinatario
      const asunto = `Confirmación de edición de reserva - Clave: ${claveReserva}`;

      // Datos adicionales de la reserva
      const nombreOrganizadorReserva= document.getElementById("nombre-organizador-reserva").value;
      const nombreEventoReserva= document.getElementById("nombre-evento-reserva").value;
      const fechaReserva = document.getElementById("fecha-evento-reserva").value;
      const horaReserva = document.getElementById("hora-evento-reserva").value;
      const duracionReserva = document.getElementById("duracion-evento-reserva").value;
      const planEvento = document.getElementById("plan-evento-reserva").value;
      const modalidadReserva = document.getElementById("modalidad-evento-reserva").value;
      const capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
      const nombrePonente = document.getElementById("nombre-ponente-reserva").value;
      const publicidadComiteReserva = document.getElementById("publicidad-comite-reserva").value;
      const observacionesPublicidadReserva = document.getElementById("observaciones-publicidad-reserva").value;
      const fotoPonenteURLReserva = document.getElementById("foto-ponente-reserva").value;
      const ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma-reserva").value;
      const lugarPresencialReserva = document.getElementById("lugar-presencial-reserva").value;

      // Convertir duración a formato horas + minutos
      const duracionHoras = Math.floor(duracionReserva / 60);
      const duracionMinutos = duracionReserva % 60;

      // Convertir minutos a formato militar (HH:MM)
      const horasMilitar = Math.floor(horaReserva / 60);
      const minutosMilitar = horaReserva % 60;
      const horaMilitar = `${horasMilitar.toString().padStart(2, "0")}:${minutosMilitar.toString().padStart(2, "0")}`;

      // Datos adicionales para la publicidad
      let publicidad = "";
      if (publicidadComiteReserva === "si") {
        publicidad = `
          <p>El organizador ha solicitado la realización de la publicidad para el evento. A continuación, se adjuntan las observaciones:</p>
          <p>${observacionesPublicidadReserva}</p>
          <p>Puede encontrar la foto del ponente en el siguiente enlace: <a href="${fotoPonenteURLReserva}" target="_blank">FOTO PONENTE</a></p>
        `;
      }

      if (publicidadComiteReserva === "si") {
        enviarSolicitudPublicidadEdicion();
      }

      // Mensaje de correo con los datos adicionales
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #007BFF;">Su edición de reserva ha sido confirmada ☑️</h1>
            <p>Estimado(a) <strong>${nombreOrganizadorReserva}</strong>,</p>
            <p>Le confirmamos que su edición de reserva para el evento <strong>${nombreEventoReserva}</strong> ha sido procesada correctamente.</p>
            <p>A continuación, encontrará los detalles de su reserva:</p>
            <ul>
              <li><strong>Clave de la reserva:</strong> ${claveReserva}</li>
              <li><strong>Fecha de la reserva:</strong> ${fechaReserva}</li>
              <li><strong>Hora de la reserva:</strong> ${horaMilitar}</li>
              <li><strong>Capitulo:</strong> ${capituloReserva}</li>
              <li><strong>Duración de la reserva:</strong> ${duracionHoras} hora(s) ${duracionMinutos} minuto(s)</li>
              <li><strong>Plan del evento:</strong> ${planEvento}</li>
              <li><strong>Modalidad de la reserva:</strong> ${modalidadReserva}</li>
              ${modalidadReserva === "virtual" ? `<li><strong>Plataforma:</strong> ${ubicacionPlataformaReserva}</li>` : `<li><strong>Ubicación/Salón:</strong> ${lugarPresencialReserva}</li>`}
              <li><strong>Nombre del ponente:</strong> ${nombrePonente}</li>
            </ul>
            ${publicidad}
            <p>Si tiene alguna pregunta, inquietud o necesita asistencia adicional, no dude en <a href="http://wa.me/3002252099" target="_blank">hacer clic aquí</a> para comunicarse con nosotros a través de WhatsApp.</p>
            <p>Recuerde que todas las claves son personales e intransferibles, no las comparta con nadie. 💙💚</p>
            <p>Agradecemos su confianza en nosotros, recuerde que este correo es automático y NO debe ser respondido. Esperamos seguir construyendo A.L.M.A. 💙💚</p>
            <p style="font-style: italic;">Cordialmente,</p>
            <p style="font-style: italic;">Alessandro Villanueva Cantillo</p>
            <p style="font-style: italic;">Administrador y creador SIEA</p>
          </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: `${destinatario}, siea@aneiap.co`, // Usuario que está registrando la reserva
        From: emailUsername, // Debería ser la misma dirección de correo de Username
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html", // Indicar que el mensaje es de tipo HTML
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
            // Puedes eliminar la alerta ya que no es necesaria
          } else {
            console.error("Error al enviar el correo:", message);
            // Puedes manejar el error de otra manera si lo deseas
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
          // Puedes manejar el error de otra manera si lo deseas
        });
    }

    // Función para enviar el correo de solicitud de publicidad
    function enviarSolicitudPublicidadEdicion() {
      // Obtener el correo del comité de piezas publicitarias
      // Banco de correos asociados a cada capítulo
      const bancoCorreos = {
        uniguajira: "comunicaciones_uniguajira@aneiap.co",
        unimagdalena: "comunicaciones_unimagdalena@aneiap.co",
        uniatlantico: "comunicaciones_uniatlantico@aneiap.co",
        uninorte: "comunicaciones_uninorte@aneiap.co",
        cuc: "comunicaciones_cuc@aneiap.co",
        librequilla: "comunicaciones_librequilla@aneiap.co",
        utb: "comunicaciones_utb@aneiap.co",
        ufps: "comunicaciones_ufps@aneiap.co",
        unalmed: "comunicaciones_unalmed@aneiap.co",
        udea: "comunicaciones_udea@aneiap.co",
        upbmed: "comunicaciones_upbmed@aneiap.co",
        utp: "comunicaciones_utp@aneiap.co",
        unalma: "comunicaciones_unalma@aneiap.co",
        udistrital: "comunicaciones_udistrital@aneiap.co",
        unalbog: "comunicaciones_unalbog@aneiap.co",
        univalle: "comunicaciones_univalle@aneiap.co",
        icesi: "comunicaciones_icesi@aneiap.co",
        usc: "comunicaciones_usc@aneiap.co",
        librecali: "comunicaciones_librecali@aneiap.co",
        nacional: "proy_diseno_nacional@aneiap.co"
      };

      // Obtener el correo del comité de piezas publicitarias según el capítulo
      const capituloReserva = document.getElementById("capitulo-organizador-reserva").value;
      const correoDestino = bancoCorreos[capituloReserva];

      // Datos adicionales de la solicitud de publicidad
      const emailOrganizadorReserva= document.getElementById("email-organizador-reserva").value;
      const nombreOrganizadorReserva= document.getElementById("nombre-organizador-reserva").value;
      const nombreEventoReserva= document.getElementById("nombre-evento-reserva").value;
      const fechaReserva = document.getElementById("fecha-evento-reserva").value;
      const horaReserva = document.getElementById("hora-evento-reserva").value;
      const planEvento = document.getElementById("plan-evento-reserva").value;
      
      const nombrePonente = document.getElementById("nombre-ponente-reserva").value;
      const publicidadComiteReserva = document.getElementById("publicidad-comite-reserva").value;
      const observacionesPublicidadReserva = document.getElementById("observaciones-publicidad-reserva").value;
      const fotoPonenteURLReserva = document.getElementById("foto-ponente-reserva").value;
      const modalidadEventoReserva = document.getElementById("modalidad-evento-reserva").value;
      const ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma-reserva").value;
      const lugarPresencialReserva = document.getElementById("lugar-presencial-reserva").value;
      const emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      const emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      const emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP
      const destinatario = correoDestino; // Reemplaza con la dirección de correo del destinatario
      const cc = `${emailOrganizadorReserva}, siea@aneiap.co`; // Copia de carbono (CC)
      const claveReserva = document.getElementById("clave-evento-reserva").value;
      const asunto = `Solicitud de Publicidad para el Evento - "${nombreEventoReserva}" con clave de reserva terminada en ***********${claveReserva.slice(-4)}`;

      // Convertir minutos a formato militar (HH:MM)
      const horasMilitar = Math.floor(horaReserva / 60);
      const minutosMilitar = horaReserva % 60;
      const horaMilitar = `${horasMilitar.toString().padStart(2, "0")}:${minutosMilitar.toString().padStart(2, "0")}`;

      // Datos adicionales para la publicidad
      let publicidad = "";
      publicidad = `
        <p>El organizador ha solicitado la realización de la publicidad para el evento. A continuación, se adjuntan las observaciones:</p>
        <p>${observacionesPublicidadReserva}</p>
        <p>Puede encontrar la foto del ponente en el siguiente enlace: <a href="${fotoPonenteURLReserva}" target="_blank">FOTO PONENTE</a></p>
      `;

      // Mensaje de correo con los datos para la publicidad
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #007BFF;">Solicitud de Publicidad para el Evento</h1>
            <p>Estimado Comité de Piezas Publicitarias,</p>
            <p>Solicitamos la realización de publicidad para el siguiente evento:</p>
            <ul>
              <li><strong>Nombre del Evento:</strong> ${nombreEventoReserva}</li>
              <li><strong>Fecha del Evento:</strong> ${fechaReserva}</li>
              <li><strong>Hora del Evento:</strong> ${horaMilitar}</li>
              <li><strong>Capítulo:</strong> ${capituloReserva}</li>
              <li><strong>Plan del Evento:</strong> ${planEvento}</li>
              <li><strong>Nombre del Ponente:</strong> ${nombrePonente}</li>
              <li><strong>Modalidad:</strong> ${modalidadEventoReserva}</li>
              ${
                modalidadEventoReserva === "presencial"
                  ? `<li><strong>Ubicación:</strong> ${lugarPresencialReserva}</li>`
                  : `<li><strong>Plataforma:</strong> ${ubicacionPlataformaReserva}</li>`
              }
            </ul>
            ${publicidad}
            <p>Por favor, revise esta solicitud y proporcione detalles sobre la publicidad requerida.</p>
            <p>Si tiene alguna pregunta o necesita información adicional, no dude en ponerse en contacto con nosotros.</p>
            <p>Recuerde que esta es una solicitud de publicidad proviente de una EDICIÓN DE RESERVA y no contiene datos privados de la reserva.</p>
            <p>Se recomienda verificar la solicitud inicial de reserva en caso de haberse requerido publicidad para esta y así no solaparse ambas solicitudes.</p>
            <p>La pieza publicitaria debe ser enviada como respuesta a TODOS los destinatarios de este correo.</p>
            <p>Atentamente,</p>
            <p>${nombreOrganizadorReserva}</p>
            <p style="font-style: italic;">Organizador de la reserva</p>
          </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: destinatario,
        Cc: cc,
        From: emailUsername,
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html",
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
          } else {
            console.error("Error al enviar el correo:", message);
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
        });
    }

    // Función para enviar el correo de edición de reserva
    function enviarCorreoRegistro(claveReservaCreada) {
      // Obtener el correo del organizador para enviarle el correo
      const correoDestino = document.getElementById("email-organizador").value;
      const claveReserva = claveReservaCreada;

      const emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      const emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      const emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP
      const destinatario = correoDestino; // Reemplaza con la dirección de correo del destinatario
      const asunto = `Confirmación de registro de reserva - Clave: ${claveReserva}`;

      // Datos adicionales de la reserva
      const nombreOrganizadorReserva= document.getElementById("nombre-organizador").value;
      const nombreEventoReserva= document.getElementById("nombre-evento").value;
      const fechaReserva = document.getElementById("fecha-evento").value;
      const horaReserva = document.getElementById("hora-evento").value;
      const duracionReserva = document.getElementById("duracion-evento").value;
      const planEvento = document.getElementById("plan-evento").value;
      const capitulo = document.getElementById("capitulo-organizador").value;
      const modalidadReserva = document.getElementById("modalidad-evento").value;
      const nombrePonente = document.getElementById("nombre-ponente").value;
      const publicidadComiteReserva = document.getElementById("publicidad-comite").value;
      const observacionesPublicidadReserva = document.getElementById("observaciones-publicidad").value;
      const fotoPonenteURLReserva = document.getElementById("foto-ponente").value;
      const ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma").value;
      const lugarPresencialReserva = document.getElementById("lugar-presencial").value;

      // Convertir duración a formato horas + minutos
      const duracionHoras = Math.floor(duracionReserva / 60);
      const duracionMinutos = duracionReserva % 60;

      // Convertir minutos a formato militar (HH:MM)
      const horasMilitar = Math.floor(horaReserva / 60);
      const minutosMilitar = horaReserva % 60;
      const horaMilitar = `${horasMilitar.toString().padStart(2, "0")}:${minutosMilitar.toString().padStart(2, "0")}`;

      // Datos adicionales para la publicidad
      let publicidad = "";
      if (publicidadComiteReserva === "si") {
        publicidad = `
          <p>El organizador ha solicitado la realización de la publicidad para el evento. A continuación, se adjuntan las observaciones:</p>
          <p>${observacionesPublicidadReserva}</p>
          <p>Puede encontrar la foto del ponente en el siguiente enlace: <a href="${fotoPonenteURLReserva}" target="_blank">FOTO PONENTE</a></p>
        `;
      }

      if (publicidadComiteReserva === "si") {
        enviarSolicitudPublicidadRegistro(claveReservaCreada);
      }

      // Mensaje de correo con los datos adicionales
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #007BFF;">Su registro de reserva ha sido confirmado ☑️</h1>
            <p>Estimado(a) <strong>${nombreOrganizadorReserva}</strong>,</p>
            <p>Le confirmamos que su registro de reserva para el evento <strong>${nombreEventoReserva}</strong> ha sido procesado correctamente.</p>
            <p>A continuación, encontrará los detalles de su reserva:</p>
            <ul>
              <li><strong>Clave de la reserva:</strong> ${claveReserva}</li>
              <li><strong>Fecha de la reserva:</strong> ${fechaReserva}</li>
              <li><strong>Hora de la reserva:</strong> ${horaMilitar}</li>
              <li><strong>Capítulo:</strong> ${capitulo}</li>
              <li><strong>Duración de la reserva:</strong> ${duracionHoras} hora(s) ${duracionMinutos} minuto(s)</li>
              <li><strong>Plan del evento:</strong> ${planEvento}</li>
              <li><strong>Modalidad de la reserva:</strong> ${modalidadReserva}</li>
              ${modalidadReserva === "virtual" ? `<li><strong>Plataforma:</strong> ${ubicacionPlataformaReserva}</li>` : `<li><strong>Ubicación/Salón:</strong> ${lugarPresencialReserva}</li>`}
              <li><strong>Nombre del ponente:</strong> ${nombrePonente}</li>
            </ul>
            ${publicidad}
            <p>Si tiene alguna pregunta, inquietud o necesita asistencia adicional, no dude en <a href="http://wa.me/3002252099" target="_blank">hacer clic aquí</a> para comunicarse con nosotros a través de WhatsApp.</p>
            <p>Recuerde que todas las claves son personales e intransferibles, no las comparta con nadie. 💙💚</p>
            <p>Agradecemos su confianza en nosotros, recuerde que este correo es automático y NO debe ser respondido. Esperamos seguir construyendo A.L.M.A. 💙💚</p>
            <p style="font-style: italic;">Cordialmente,</p>
            <p style="font-style: italic;">Alessandro Villanueva Cantillo</p>
            <p style="font-style: italic;">Administrador y creador SIEA</p>
          </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: `${destinatario}, siea@aneiap.co`, // Usuario que está registrando la reserva
     //   Cc: "siea@aneiap.co", // Copia a siea para siempre tener registro de correos
        From: emailUsername, // Debería ser la misma dirección de correo de Username
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html", // Indicar que el mensaje es de tipo HTML
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
            // Puedes eliminar la alerta ya que no es necesaria
          } else {
            console.error("Error al enviar el correo:", message);
            // Puedes manejar el error de otra manera si lo deseas
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
          // Puedes manejar el error de otra manera si lo deseas
        });
    }

    // Función para enviar el correo de solicitud de publicidad
    function enviarSolicitudPublicidadRegistro(claveReservaCreada) {
    // Función para enviar el correo de solicitud de publicidad
      // Obtener el correo del comité de piezas publicitarias
      const capitulo = document.getElementById("capitulo-organizador").value;
      // Banco de correos asociados a cada capítulo
      const bancoCorreos = {
        uniguajira: "comunicaciones_uniguajira@aneiap.co",
        unimagdalena: "comunicaciones_unimagdalena@aneiap.co",
        uniatlantico: "comunicaciones_uniatlantico@aneiap.co",
        uninorte: "comunicaciones_uninorte@aneiap.co",
        cuc: "comunicaciones_cuc@aneiap.co",
        librequilla: "comunicaciones_librequilla@aneiap.co",
        utb: "comunicaciones_utb@aneiap.co",
        ufps: "comunicaciones_ufps@aneiap.co",
        unalmed: "comunicaciones_unalmed@aneiap.co",
        udea: "comunicaciones_udea@aneiap.co",
        upbmed: "comunicaciones_upbmed@aneiap.co",
        utp: "comunicaciones_utp@aneiap.co",
        unalma: "comunicaciones_unalma@aneiap.co",
        udistrital: "comunicaciones_udistrital@aneiap.co",
        unalbog: "comunicaciones_unalbog@aneiap.co",
        univalle: "comunicaciones_univalle@aneiap.co",
        icesi: "comunicaciones_icesi@aneiap.co",
        usc: "comunicaciones_usc@aneiap.co",
        librecali: "comunicaciones_librecali@aneiap.co",
        nacional: "proy_diseno_nacional@aneiap.co"
      };

      const correoDestino = bancoCorreos[capitulo];
      // Datos adicionales de la solicitud de publicidad
      const emailOrganizadorReserva = document.getElementById("email-organizador").value;
      const nombreOrganizadorReserva = document.getElementById("nombre-organizador").value;
      const nombreEventoReserva= document.getElementById("nombre-evento").value;
      const fechaReserva = document.getElementById("fecha-evento").value;
      const horaReserva = document.getElementById("hora-evento").value;
      const planEvento = document.getElementById("plan-evento").value;
      const nombrePonente = document.getElementById("nombre-ponente").value;
      const publicidadComiteReserva = document.getElementById("publicidad-comite").value;
      const observacionesPublicidadReserva = document.getElementById("observaciones-publicidad").value;
      const fotoPonenteURLReserva = document.getElementById("foto-ponente").value;
      const modalidadEventoReserva = document.getElementById("modalidad-evento").value;
      const ubicacionPlataformaReserva = document.getElementById("ubicacion-plataforma").value;
      const lugarPresencialReserva = document.getElementById("lugar-presencial").value;

      const emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      const emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      const emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP
      const destinatario = correoDestino; // Reemplaza con la dirección de correo del destinatario
      const cc = `${emailOrganizadorReserva}, siea@aneiap.co`; // Copia de carbono (CC)
      const claveReserva = claveReservaCreada;
      const asunto = `Solicitud de Publicidad para el Espacio - "${nombreEventoReserva}" con clave de reserva terminada en ***********${claveReserva.slice(-4)}`;

      // Convertir minutos a formato militar (HH:MM)
      const horasMilitar = Math.floor(horaReserva / 60);
      const minutosMilitar = horaReserva % 60;
      const horaMilitar = `${horasMilitar.toString().padStart(2, "0")}:${minutosMilitar.toString().padStart(2, "0")}`;

      // Datos adicionales para la publicidad
      let publicidad = "";
      publicidad = `
        <p>El organizador ha solicitado la realización de la publicidad para el evento. A continuación, se adjuntan las observaciones:</p>
        <p>${observacionesPublicidadReserva}</p>
        <p>Puede encontrar la foto del ponente en el siguiente enlace: <a href="${fotoPonenteURLReserva}" target="_blank">FOTO PONENTE</a></p>
      `;

      // Mensaje de correo con los datos para la publicidad
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #007BFF;">Solicitud de Publicidad para el Evento</h1>
            <p>Estimado Comité de Piezas Publicitarias,</p>
            <p>Solicitamos la realización de publicidad para el siguiente evento:</p>
            <ul>
              <li><strong>Nombre del Evento:</strong> ${nombreEventoReserva}</li>
              <li><strong>Fecha del Evento:</strong> ${fechaReserva}</li>
              <li><strong>Hora del Evento:</strong> ${horaMilitar}</li>
              <li><strong>Capitulo:</strong> ${capitulo}</li>
              <li><strong>Plan del Evento:</strong> ${planEvento}</li>
              <li><strong>Nombre del Ponente:</strong> ${nombrePonente}</li>
              <li><strong>Modalidad:</strong> ${modalidadEventoReserva}</li>
              ${
                modalidadEventoReserva === "presencial"
                  ? `<li><strong>Ubicación:</strong> ${lugarPresencialReserva}</li>`
                  : `<li><strong>Plataforma:</strong> ${ubicacionPlataformaReserva}</li>`
              }
            </ul>
            ${publicidad}
            <p>Por favor, revise esta solicitud y proporcione detalles sobre la publicidad requerida.</p>
            <p>Si tiene alguna pregunta o necesita información adicional, no dude en ponerse en contacto con nosotros.</p>
            <p>Recuerde que esta es una solicitud de publicidad proveniente de una RESERVA NUEVA y no contiene datos privados de la reserva.</p>
            <p>La pieza publicitaria debe ser enviada como respuesta a TODOS los destinatarios de este correo.</p>
            <p>Atentamente,</p>
            <p>${nombreOrganizadorReserva}</p>
            <p style="font-style: italic;">Organizador de la reserva</p>
          </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: destinatario,
        Cc: cc,
        From: emailUsername,
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html",
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
          } else {
            console.error("Error al enviar el correo:", message);
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
        });
    }

    // Función para enviar el correo de edición de reserva
    function enviarCorreoEliminar(claveReservaCreada,nombreOrganizadorReserva,correoReserva,nombreEventoReserva,fechaReserva,horaReserva,duracionReserva) {

      // Obtener la clave de la reserva para enviar el correo
      const claveReserva = claveReservaCreada;

      // Restpo de datos para el correo, datos generales
      const emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      const emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      const emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP
      const destinatario = correoReserva; // Reemplaza con la dirección de correo del destinatario
      const asunto = `Confirmación de eliminación de reserva - Clave: ${claveReserva}`;

      // Convertir duración a formato horas + minutos
      const duracionHoras = Math.floor(duracionReserva / 60);
      const duracionMinutos = duracionReserva % 60;

      // Convertir minutos a formato militar (HH:MM)
      const horasMilitar = Math.floor(horaReserva / 60);
      const minutosMilitar = horaReserva % 60;
      const horaMilitar = `${horasMilitar.toString().padStart(2, "0")}:${minutosMilitar.toString().padStart(2, "0")}`;

      // Mensaje de correo con los datos adicionales
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #C3002C;">Su eliminación de reserva ha sido confirmada ☑️</h1>
            <p>Estimado(a) <strong>${nombreOrganizadorReserva}</strong>,</p>
            <p>Le confirmamos que su registro de reserva para el evento <strong>${nombreEventoReserva}</strong> ha sido procesado correctamente.</p>
            <p>A continuación, encontrará los detalles mínimos de su reserva eliminada:</p>
            <ul>
              <li><strong>Clave de la reserva:</strong> ${claveReserva}</li>
              <li><strong>Fecha de la reserva:</strong> ${fechaReserva}</li>
              <li><strong>Hora de la reserva:</strong> ${horaMilitar}</li>
              <li><strong>Duración de la reserva:</strong> ${duracionHoras} hora(s) ${duracionMinutos} minuto(s)</li>
            </ul>
            <p>Si tiene alguna pregunta, inquietud o necesita asistencia adicional, no dude en <a href="http://wa.me/3002252099" target="_blank">hacer clic aquí</a> para comunicarse con nosotros a través de WhatsApp.</p>
            <p>Recuerde que todas las claves son personales e intransferibles, no las comparta con nadie. 💙💚</p>
            <p>Agradecemos su confianza en nosotros, recuerde que este correo es automático y NO debe ser respondido. Esperamos seguir construyendo A.L.M.A. 💙💚</p>
            <p style="font-style: italic;">Cordialmente,</p>
            <p style="font-style: italic;">Alessandro Villanueva Cantillo</p>
            <p style="font-style: italic;">Administrador y creador SIEA</p>
            </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: `${destinatario}, siea@aneiap.co`, // Usuario que está registrando la reserva
     //   Cc: "siea@aneiap.co", // Copia a siea para siempre tener registro de correos
        From: emailUsername, // Debería ser la misma dirección de correo de Username
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html", // Indicar que el mensaje es de tipo HTML
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
            // Puedes eliminar la alerta ya que no es necesaria
          } else {
            console.error("Error al enviar el correo:", message);
            // Puedes manejar el error de otra manera si lo deseas
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
          // Puedes manejar el error de otra manera si lo deseas
        });
    }

    function calcularIntervalosNuevaFecha(nuevaFecha, nuevaHora, nuevaDuracion) {
      var nuevosIntervalos = [];

      // Calcula los índices de inicio y fin del intervalo que ocupará el evento en la nueva fecha
      var inicioIntervalo = Math.floor((nuevaHora - 480) / 30);
      var finIntervalo = inicioIntervalo + nuevaDuracion/30;

      // Agrega los nuevos intervalos al arreglo nuevosIntervalos
      for (var i = inicioIntervalo; i < finIntervalo; i++) {
        nuevosIntervalos.push(i);
      }

      return nuevosIntervalos;
    }

    function calcularDisponibilidadPorFecha(nuevaFecha) {
      var disponibilidadHorarios = Array(28).fill(true); // Inicialmente, todos los intervalos están disponibles

      // Realiza una consulta a la base de datos para obtener las reservas en la nueva fecha
      var reservasRef = firebase.firestore().collection("reservas");
      var consulta = reservasRef.where("fechaEvento", "==", nuevaFecha);

      consulta.get().then(function(querySnapshot) {
        // Ciclo para revisar cada evento reservado para la nueva fecha
        querySnapshot.forEach(function(doc) {
          var horaEvento = doc.data().horaEvento; // Hora en minutos (ej. 540 para 09:00)
          var duracionEvento = doc.data().duracionEvento; // Duración en minutos (ej. 120 para 2 horas)

          // Calcular los índices de inicio y fin del intervalo que ocupará el evento
          var inicioIntervalo = Math.floor((horaEvento - 480) / 30);
          var finIntervalo = inicioIntervalo + duracionEvento / 30;

          // Marcar los intervalos como ocupados en el arreglo de disponibilidad
          for (var i = inicioIntervalo; i < finIntervalo; i++) {
            disponibilidadHorarios[i] = false;
          }
        });

        // Ahora disponibilidadHorarios tiene la disponibilidad de los intervalos en la nueva fecha
        // Realiza el resto de la lógica aquí
      }).catch(function(error) {
        Swal.fire({
          title: 'Error de Consulta',
          text: 'Ocurrió un error al obtener las reservas. Por favor, inténtalo de nuevo más tarde o comunícate con el creador de la plataforma.',
          icon: 'error',
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true
        });
      });
    }

    function verificarDisponibilidadEdicion() {
      return new Promise((resolve, reject) => {

      // Obtener una referencia al documento del evento en Firestore
      var claveEventoReserva = document.getElementById("clave-evento-reserva").value;
      const eventoRef = firebase.firestore().collection("reservas").doc(claveEventoReserva);

      console.log("actualizaremos la fecha a 31-dic");
      // Actualizar el evento como si la nueva fecha fuera el 31 de diciembre de 2023, esto es con fines prácticas para
      // lograr que este evento no sea tomado nunca dentro de la colección reservas debido a que cuando la
      // nueva fecha sea igual a la actual (no cambió de fecha) no queremos que el evento se autobloquee la disponibilidad
      return eventoRef.update({fechaEvento: "2023-12-31"})
      .then(() => {
        console.log("actualización exitosa, ahora obtendremos la consulta de todos los eventos en esa nueva fecha");
        // Resto del código

        var disponibilidadHorarios = Array(28).fill(true); // Inicialmente, todos los intervalos están disponibles

        var claveEvento = document.getElementById("clave-evento-reserva").value;
        var nuevaFecha = document.getElementById("fecha-evento-reserva").value;
        var nuevaHora = document.getElementById("hora-evento-reserva").value;
        var nuevaDuracion = document.getElementById("duracion-evento-reserva").value;
        var nuevoCapitulo = document.getElementById("capitulo-organizador-reserva").value;

        if (parseInt(nuevaDuracion) + parseInt(nuevaHora) > 1321) {
          Swal.fire({
            title: '¡ESTÁS INTENTANDO MOVER EL ESPACIO PARA DESPUÉS DE LAS 22:00 (10PM)!',
            text: 'El evento debe estar programado para finalizar a más tardar hasta las 22:00, ve a la duración del mismo y edítala de tal forma que no se excedan las 22:00 (10pm)',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el registro del evento
        }

        // Realiza una consulta a la base de datos para obtener las reservas en la nueva fecha
        var reservasRef = firebase.firestore().collection("reservas");

          console.log("ahora obtendremos la consulta de todos los eventos en esa nueva fecha");

        // Primera consulta: Filtrar por "fechaEvento" igual a "nuevaFecha"
        if (nuevoCapitulo === "nacional") {
          // Si se seleccionó "ANEIAP NACIONAL", consultar solo las reservas para toda la Asociación
          consulta = reservasRef.where("fechaEvento", "==", nuevaFecha).where("capitulo", "==", "nacional");
        } else {
          // Consultar las reservas para el capítulo seleccionado y para toda la Asociación (ANEIAP NACIONAL)
          consulta = reservasRef.where("fechaEvento", "==", nuevaFecha).where("capitulo", "in", [nuevoCapitulo, "nacional"]);
        }

        console.log("queremos empezar a hacer la consulta");

        // Realizar el filtrado para obtener intervalos disponibles y no disponibles
        consulta.get().then(function(querySnapshot) {
          console.log("entramos a hacer consulta");
          // Ciclo para revisar cada evento reservado para la nueva fecha
          querySnapshot.forEach(function(doc) {
            console.log("este es el doc: " + doc);
            var horaEvento = doc.data().horaEvento; // Hora en minutos (ej. 540 para 09:00)
            var duracionEvento = doc.data().duracionEvento; // Duración en minutos (ej. 120 para 2 horas)
            console.log("hora del evento con clave: " + doc.data().claveEvento + ": " + horaEvento);
            console.log("duracion del evento con clave: " + doc.data().claveEvento + ": " + duracionEvento);
            // Calcular los índices de inicio y fin del intervalo que ocupará el evento
            var inicioIntervalo = Math.floor((horaEvento - 480) / 30);
            var finIntervalo = inicioIntervalo + duracionEvento / 30;
            console.log("inicio intervalo: " + inicioIntervalo);
            console.log("fin intervalo: " + finIntervalo);

            // Marcar los intervalos como ocupados en el arreglo de disponibilidad
            for (var i = inicioIntervalo; i < finIntervalo; i++) {
              disponibilidadHorarios[i] = false;
            }
            console.log("estas son las disponibilidades de los intervalos:");
            console.log(disponibilidadHorarios);
          });
          
          var disponibilidadMatutino = true;
          var disponibilidadVesperino = true;
          var disponibilidadNocturno = true;

          // Colocar los intervalos de un mismo paquete horario (matutino, vespertino o nocturno) ocupados
          // Verificar el paquete horario matutino (intervalos 1 al 10, es decir, 8:00 a 13:00)
          for (var i = 0; i <= 9; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 0; j <= 9; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadMatutino = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Verificar el paquete horario vespertino (intervalos 11 al 20, es decir, 13:00 a 18:00)
          for (var i = 10; i <= 19; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 10; j <= 19; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadVesperino = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Verificar el paquete horario nocturno (intervalos 21 al 28, es decir, 18:00 a 22:00)
          for (var i = 20; i <= 27; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 20; j <= 27; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadNocturno = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Calcula los índices de inicio y fin de los intervalos para la nueva hora y duración
          var inicioNuevoIntervalo = Math.floor((nuevaHora - 480) / 30);
          var finNuevoIntervalo = inicioNuevoIntervalo + nuevaDuracion / 30;

          // Verifica si alguno de los nuevos intervalos está ocupado
          var algunIntervaloOcupado = false;
          for (var i = inicioNuevoIntervalo; i < finNuevoIntervalo; i++) {
            console.log("esta es la disponibilidad del intervalo " + i + ": " + disponibilidadHorarios[i]);
            if (!disponibilidadHorarios[i]) {
              console.log("está ocupado el intervalo " + i);
              algunIntervaloOcupado = true;
              break; // Si uno está ocupado, no es necesario verificar los demás
            }
          }

          if (algunIntervaloOcupado) {
            // Al menos uno de los intervalos no está disponible
            // Actualizar la fecha del evento de vuelta a la fecha que tenía porque ahora mismo está en 31 de diciembre.
            var fechaEventoReservaBackup = guardarBackupFechaEventoReserva();
            console.log('fecha evento reserva backup' + fechaEventoReservaBackup);
            eventoRef.update({fechaEvento: fechaEventoReservaBackup});
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar TODO EL DÍA ocupado
            if (!disponibilidadMatutino && !disponibilidadVesperino && !disponibilidadNocturno) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN TODO EL DÍA! 📅',
              text: 'Ya no es posible reservar en ningún espacio del día debido a que los 3 horarios para este día están ocupados. Prueba a consultar la disponibilidad en la sección azul y escoger otro día.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/LPTDqcy/AVATAR-NODISPOTODODIA-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario matutino.
            if (!disponibilidadMatutino && inicioNuevoIntervalo <= 9) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO MATUTINO! 🌤️',
              text: 'El horario matutino ya está ocupado (8:00 a 13:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario vespertino.
            if (!disponibilidadVesperino && inicioNuevoIntervalo <= 19) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO VESPERTINO! ☀️',
              text: 'El horario vespertino ya está ocupado (13:00 a 18:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario nocturno.
            if (!disponibilidadNocturno) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO NOCTURNO! 🌕',
              text: 'El horario nocturno ya está ocupado (18:00 a 22:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
          } else {
            // Todos los intervalos están disponibles
            // Realiza la edición de la reserva
            // ...
            resolve(true); // Resolver la promesa con 'true' si todos los intervalos están disponibles
          }
        }).catch(function(error) {
          Swal.fire({
            title: '¡ERROR DE CONSULTA!',
            text: 'Ocurrió un error al obtener las reservas. Por favor, inténtalo de nuevo más tarde o comunícate con el creador de la plataforma.',
            icon: 'error',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          console.log(error);
          resolve(false); // Resolver la promesa con 'false' en caso de error
          return;
        });
        
      })
      .catch(error => console.error("Error al actualizar el evento:", error));

    }
  )}

    function verificarDisponibilidadRegistro() {
        return new Promise((resolve, reject) => {
        var disponibilidadHorarios = Array(28).fill(true); // Inicialmente, todos los intervalos están disponibles

        // var claveEvento = document.getElementById("clave-evento").value; // ya no es necesario esto
        var nuevaFecha = document.getElementById("fecha-evento").value;
        var nuevaHora = document.getElementById("hora-evento").value;
        var nuevaDuracion = document.getElementById("duracion-evento").value;
        var nuevoCapitulo = document.getElementById("capitulo-organizador").value;

        // Validación de datos para que la fecha con la que se registrará el evento sea mayor a la de hoy.
        if (parseInt(nuevaDuracion) + parseInt(nuevaHora) > 1321) {
          Swal.fire({
            title: '¡ESTÁS INTENTANDO RESERVAR DESPUÉS DE LAS 22:00 (10PM)!',
            text: 'El evento debe estar programado para finalizar a más tardar hasta las 22:00, ve a la duración del mismo y edítala de tal forma que no se excedan las 22:00 (10pm)',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el registro del evento
        }

        // Realiza una consulta a la base de datos para obtener las reservas en la nueva fecha
        var reservasRef = firebase.firestore().collection("reservas");

        // Primera consulta: Filtrar por "fechaEvento" igual a "nuevaFecha"
        if (nuevoCapitulo === "nacional") {
          // Si se seleccionó "ANEIAP NACIONAL", consultar solo las reservas para toda la Asociación
          consulta = reservasRef.where("fechaEvento", "==", nuevaFecha).where("capitulo", "==", "nacional");
        } else {
          // Consultar las reservas para el capítulo seleccionado y para toda la Asociación (ANEIAP NACIONAL)
          consulta = reservasRef.where("fechaEvento", "==", nuevaFecha).where("capitulo", "in", [nuevoCapitulo, "nacional"]);
        }

        // Realizar el filtrado para obtener intervalos disponibles y no disponibles
        consulta.get().then(function(querySnapshot) {
          console.log("entramos a hacer consulta");
          // Ciclo para revisar cada evento reservado para la nueva fecha
          querySnapshot.forEach(function(doc) {
            console.log("este es el doc: " + doc);
            var horaEvento = doc.data().horaEvento; // Hora en minutos (ej. 540 para 09:00)
            var duracionEvento = doc.data().duracionEvento; // Duración en minutos (ej. 120 para 2 horas)
            console.log("hora del evento con clave: " + doc.data().claveEvento + ": " + horaEvento);
            console.log("duracion del evento con clave: " + doc.data().claveEvento + ": " + duracionEvento);
            // Calcular los índices de inicio y fin del intervalo que ocupará el evento
            var inicioIntervalo = Math.floor((horaEvento - 480) / 30);
            var finIntervalo = inicioIntervalo + duracionEvento / 30;
            console.log("inicio intervalo: " + inicioIntervalo);
            console.log("fin intervalo: " + finIntervalo);

            // Marcar los intervalos como ocupados en el arreglo de disponibilidad
            for (var i = inicioIntervalo; i < finIntervalo; i++) {
              disponibilidadHorarios[i] = false;
            }
            console.log("estas son las disponibilidades de los intervalos:");
            console.log(disponibilidadHorarios);
          });

          // Calcula los índices de inicio y fin de los intervalos para la nueva hora y duración
          var inicioNuevoIntervalo = Math.floor((nuevaHora - 480) / 30);
          var finNuevoIntervalo = inicioNuevoIntervalo + nuevaDuracion / 30;

          var disponibilidadMatutino = true;
          var disponibilidadVesperino = true;
          var disponibilidadNocturno = true;

          // Colocar los intervalos de un mismo paquete horario (matutino, vesperino o nocturno) ocupados
          // Verificar el paquete horario matutino (intervalos 1 al 10, es decir, 8:00 a 13:00)
          for (var i = 0; i <= 9; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 0; j <= 9; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadMatutino = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Verificar el paquete horario vespertino (intervalos 11 al 20, es decir, 13:00 a 18:00)
          for (var i = 10; i <= 19; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 10; j <= 19; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadVesperino = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Verificar el paquete horario nocturno (intervalos 21 al 28, es decir, 18:00 a 22:00)
          for (var i = 20; i <= 27; i++) {
            if (!disponibilidadHorarios[i]) {
              for (var j = 20; j <= 27; j++) {
                disponibilidadHorarios[j] = false;
              }
              disponibilidadNocturno = false;
              break; // Al menos un intervalo está ocupado, salir del ciclo
            }
          }

          // Calcula los índices de inicio y fin de los intervalos para la nueva hora y duración
          var inicioNuevoIntervalo = Math.floor((nuevaHora - 480) / 30);
          var finNuevoIntervalo = inicioNuevoIntervalo + nuevaDuracion / 30;

          // Verifica si alguno de los nuevos intervalos está ocupado
          var algunIntervaloOcupado = false;
          for (var i = inicioNuevoIntervalo; i < finNuevoIntervalo; i++) {
            console.log("esta es la disponibilidad del intervalo " + i + ": " + disponibilidadHorarios[i]);
            if (!disponibilidadHorarios[i]) {
              console.log("está ocupado el intervalo " + i);
              algunIntervaloOcupado = true;
              break; // Si uno está ocupado, no es necesario verificar los demás
            }
          }

          if (algunIntervaloOcupado) {
            // Al menos uno de los intervalos no está disponible
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar TODO EL DÍA ocupado
            if (!disponibilidadMatutino && !disponibilidadVesperino && !disponibilidadNocturno) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN TODO EL DÍA! 📅',
              text: 'Ya no es posible reservar en ningún espacio del día debido a que los 3 horarios para este día están ocupados. Prueba a consultar la disponibilidad en la sección azul y escoger otro día.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/LPTDqcy/AVATAR-NODISPOTODODIA-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario matutino.
            if (!disponibilidadMatutino && inicioNuevoIntervalo <= 9) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO MATUTINO! 🌤️',
              text: 'El horario matutino ya está ocupado (8:00 a 13:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario vespertino.
            if (!disponibilidadVesperino && inicioNuevoIntervalo <= 19) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO VESPERTINO! ☀️',
              text: 'El horario vespertino ya está ocupado (13:00 a 18:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
            // Mostrar alerta al usuario con SweetAlert2 en caso de estar ocupado el horario nocturno.
            if (!disponibilidadNocturno) {
              Swal.fire({
              title: '¡SIN DISPONIBILIDAD EN EL HORARIO NOCTURNO! 🌕',
              text: 'El horario nocturno ya está ocupado (18:00 a 22:00). Prueba cambiar el día, hora o duración.',
              icon: 'error',
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,  
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/4p0C8SC/AVATAR-HORARIOSNODISPO-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
            return; // Detener la ejecución de la función
            }
          } else {
            // Todos los intervalos están disponibles
            // Realiza la edición de la reserva
            // ...
            resolve(true); // Resolver la promesa con 'true' si todos los intervalos están disponibles
          }
        }).catch(function(error) {
          Swal.fire({
            title: '¡ERROR DE CONSULTA!',
            text: 'Ocurrió un error al obtener las reservas. Por favor, inténtalo de nuevo más tarde o comunícate con el creador de la plataforma.',
            icon: 'error',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/PZ7KXF9/AVATAR-ERRORES-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          console.log(error);
          resolve(false); // Resolver la promesa con 'false' en caso de error
          return;
        });
      }
    )}

    function limpiarTicket() {
      // Lógica para limpiar los campos del ticket, por ejemplo, establecer los valores de los campos en blanco.
      // Ejemplo:
      document.getElementById("nombre").value = "";
      document.getElementById("correo-ticket").value = "";
      document.getElementById("tipo-ticket").value = "";
      document.getElementById("explicacion").value = "";
      document.getElementById("celular").value = "";
      document.getElementById("link-drive").value = "";
    }

    function enviarTicket() {
      // Obtener los valores de los campos
      
      var nombre = document.getElementById("nombre").value;
      var correo = document.getElementById("correo-ticket").value;
      var tipoTicket = document.getElementById("tipo-ticket").value;
      var explicacion = document.getElementById("explicacion").value;
      var celular = document.getElementById("celular").value;
      var linkDrive = document.getElementById("link-drive").value;

      // Crear una lista para almacenar los nombres de los campos faltantes
      var camposFaltantes = [];

      // Verificar si cada campo está vacío y agregar su nombre a la lista si es el caso
      if (nombre.trim() === "") {
        camposFaltantes.push(" - Nombre completo");
      }
      if (correo.trim() === "") {
        camposFaltantes.push(" - Correo ANEIAP");
      }
      if (tipoTicket === "") {
        camposFaltantes.push(" - Tipo de ticket");
      }
      if (explicacion.trim() === "") {
        camposFaltantes.push(" - Explicación del caso");
      }
      if (celular.trim() === "") {
        camposFaltantes.push(" - Número de celular");
      }

      // Verificar si hay campos faltantes
      if (camposFaltantes.length > 0) {
        // Mostrar una alerta con los campos faltantes
        Swal.fire({
          icon: 'error',
          title: '¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!',
          text: 'Los siguientes campos son obligatorios y están vacíos:\n' + camposFaltantes.join('\n'),
          confirmButtonText: 'Aceptar',
          allowOutsideClick: true,
          backdrop: true,  
          allowEscapeKey: true,
          imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
          imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
      } else {
        // Verificar el número de celular
        if (!/^3\d{9}$/.test(celular)) {
          // El número de celular no cumple con el patrón
          Swal.fire({
            icon: 'error',
            title: '¡NÚMERO DE CELULAR INVÁLIDO!',
            text: 'Estás escribiendo un número de celular no válido, vuelve a rectificar por favor.',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        } else if (!/^[\w.%+-]+@aneiap\.co$/.test(correo)) {
          // El correo ANEIAP no cumple con el patrón
          Swal.fire({
            icon: 'error',
            title: '¡CORREO ANEIAP INVÁLIDO!',
            text: 'Escribe bien tu correo ANEIAP. Vuelve y verifica.',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        } else if (linkDrive && !/^https:\/\/drive\.google\.com\/.*$/.test(linkDrive)) {
          // El link de Drive no cumple con el patrón
          Swal.fire({
            icon: 'error',
            title: '¡LINK DE DRIVE DE EVIDENCIAS INVÁLIDO!',
            text: 'El link de Google Drive no es válido. Vuelve y verifica que lo estés diligenciando correctamente.".',
            confirmButtonText: 'Aceptar',
            allowOutsideClick: true,
            backdrop: true,  
            allowEscapeKey: true,
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        } else {
          // Todos los campos son válidos, aquí puedes agregar la lógica para enviar el ticket al servidor o realizar otras acciones.
          // Por ejemplo, puedes enviar una solicitud HTTP para procesar el ticket en el servidor.
          // Aquí puedes agregar tu lógica de envío del ticket.
          EnviarCorreoTicket(nombre,correo,tipoTicket,explicacion,celular,linkDrive);
        }
      }
    }

    function EnviarCorreoTicket(nombre,correo,tipoTicket,explicacion,celular,linkDrive,emailPassword) {

      // Configuración del servicio de correo (en este caso, Elastic Email)
      var emailHost = "smtp.elasticemail.com"; // Reemplaza con el servidor SMTP correcto
      var emailUsername = "siea@aneiap.co"; // Reemplaza con tu nombre de usuario SMTP
      var emailPassword = "D20D124D2A2129252882BEE9DAC2B79F4E70"; // Reemplaza con tu contraseña SMTP 

      // Mensaje de correo con los datos adicionales
      const asunto = `GENERACIÓN TICKET - TIPO ${tipoTicket}`;
      const mensaje = `
        <html>
          <body>
            <h1 style="color: #007BFF;">GENERACIÓN DE TICKET - TIPO "${tipoTicket}"</h1>
            <p>Estimado(a) <strong>Administrador</strong>,</p>
            <p>Se ha generado un nuevo ticket de soporte con la siguiente información:</p>
            <ul>
              <li><strong>Nombre Solicitante:</strong> ${nombre}</li>
              <li><strong>Correo ANEIAP:</strong> ${correo}</li>
              <li><strong>Tipo de Ticket:</strong> ${tipoTicket}</li>
              <li><strong>Explicación detallada del Caso:</strong> ${explicacion}</li>
              <li><strong>Número de Celular:</strong> ${celular}</li>
              <li><strong>Link de Google Drive con evidencias:</strong> ${linkDrive || 'No proporcionado'}</li>
            </ul>
            <p>Por favor, revise y atienda este ticket lo antes posible.</p>
            <p>Si tiene alguna pregunta o necesita asistencia adicional, no dude en responder a este correo o escribir a <a href="http://wa.me/${celular}" target="_blank">WhatsApp</a>.</p>
            <p>Gracias por su atención y servicio.</p>
            <p style="font-style: italic;">Cordialmente,</p>
            <p style="font-style: italic;">${nombre}</p>
            <p style="font-style: italic;">Solicitante de Ticket</p>
          </body>
        </html>
      `;

      Email.send({
        Host: emailHost,
        Username: emailUsername,
        Password: emailPassword,
        To: `siea@aneiap.co, ${correo}`, // Usuario que está registrando la reserva
     //   Cc: "siea@aneiap.co", // Copia a siea para siempre tener registro de correos
        From: emailUsername, // Debería ser la misma dirección de correo de Username
        Subject: asunto,
        Body: mensaje,
        ContentType: "text/html", // Indicar que el mensaje es de tipo HTML
      })
        .then((message) => {
          console.log("Mensaje de SMTPJS:", message);

          if (message === "OK") {
            console.log("Correo enviado con éxito");
            // Puedes eliminar la alerta ya que no es necesaria
            swal.fire({
              title: "¡TICKET ENVIADO!",
              text: `El ticket ha sido enviado correctamente a siea@aneiap.co, en máximo DOS (2) días hábiles se te dará respuesta al mismo.`,
              icon: "success",
              confirmButtonText: "OK",
              allowOutsideClick: true,
              backdrop: true,
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
            });
          } else {
            console.error("Error al enviar el correo:", message);
            // Puedes manejar el error de otra manera si lo deseas
          }
        })
        .catch((error) => {
          console.error("Error en la función de envío de correo:", error);
          // Puedes manejar el error de otra manera si lo deseas
        });

    }

    const modoSwitch = document.getElementById('modo-switch');
    const body = document.body;
    const logos = document.querySelectorAll('.logo');

    modoSwitch.addEventListener('click', () => {
      body.classList.toggle('dark-mode');

      // Verifica si el body tiene la clase dark-mode
      if (body.classList.contains('dark-mode')) {
        // Si está en modo oscuro, muestra el logo dark y oculta el logo light
        logos.forEach((logo) => {
          if (logo.classList.contains('dark-mode')) {
            logo.style.display = 'block';
          } else {
            logo.style.display = 'none';
          }
        });
      } else {
        // Si está en modo claro, muestra el logo light y oculta el logo dark
        logos.forEach((logo) => {
          if (logo.classList.contains('light-mode')) {
            logo.style.display = 'block';
          } else {
            logo.style.display = 'none';
          }
        });
      }
    });

    function validar_login() {
      // Obtener los valores de correo y contraseña desde los campos del formulario
      var correo = document.getElementById("correo").value;
      var contrasena = document.getElementById("contrasena").value;
      var content = document.getElementById("acordeon5-content");
      content.style.display = "none";

      // Verificar si ambos campos están diligenciados
      if (!correo || !contrasena) {
        // Campos no diligenciados, mostrar alerta de advertencia
        Swal.fire({
          title: "¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!",
          text: "Debes diligenciar tanto correo como contraseña para iniciar sesión.",
          icon: "warning",
          confirmButtonText: "Aceptar",
          allowOutsideClick: true,
          backdrop: true,
          allowEscapeKey: true,
          imageUrl: "https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png", // URL de la imagen
          imageWidth: 120, // Ancho de la imagen en píxeles
          imageHeight: 235, // Alto de la imagen en píxeles
        });
        // Actualizar el contenido del elemento saludoUsuario con el saludo genérico
        document.getElementById("saludoUsuario").innerText = "¡Hola, ANEIAPo!";
        return; // Detener la ejecución de la función
      }

      // Referencia al documento en la colección "cuentas" correspondiente al correo
      var cuentaRef = firebase.firestore().collection("cuentas").doc(correo);

      // Obtener la información del documento
      cuentaRef.get().then((doc) => {
        if (doc.exists) {
          // El documento existe, comprobar si la contraseña coincide
          var storedPassword = doc.data().pass;
          if (contrasena === storedPassword) {
            // Contraseña correcta, asignar el valor del correo electrónico a la variable global
            correoUsuario = correo;
            // Contraseña correcta, asignar el valor del capítulo dependiendo del correo.
            // Verificar el valor del correo para determinar el capítulo del usuario
            if (correo === "academico@aneiap.co") {
              // Mostrar un desplegable con la lista de todos los capítulos
              Swal.fire({
                title: 'Selecciona el capítulo sobre el cual deseas consultar información en caso de que vayas a hacerlo:',
                input: 'select',
                inputOptions: {
                  'uniguajira': 'UNIGUAJIRA',
                  'unimagdalena': 'UNIMAGDALENA',
                  'uniatlantico': 'UNIATLÁNTICO',
                  'uninorte': 'UNINORTE',
                  'cuc': 'CUC',
                  'librequilla': 'LIBREQUILLA',
                  'utb': 'UTB',
                  'ufps': 'UFPS',
                  'unalmed': 'UNALMED',
                  'udea': 'UDEA',
                  'upbmed': 'UPBMED',
                  'utp': 'UTP',
                  'unalma': 'UNALMA',
                  'udistrital': 'UDISTRITAL',
                  'unalbog': 'UNALBOG',
                  'univalle': 'UNIVALLE',
                  'icesi': 'ICESI',
                  'usc': 'USC',
                  'librecali': 'LIBRECALI',
                  'nacional': 'NACIONAL',
                },
                inputPlaceholder: 'Selecciona un capítulo',
                showCancelButton: false, // No mostrar el botón de cancelar
                confirmButtonText: 'Aceptar',
                allowOutsideClick: false, // No permitir clic fuera de la alerta
                allowEscapeKey: false // No permitir usar la tecla de escape
              }).then((result) => {
                // Verificar si se seleccionó un capítulo
                if (result.isConfirmed && result.value !== "") {
                  // Asignar el valor seleccionado a capituloUsuario
                  capituloUsuario = result.value;
                  // Mostrar mensaje de inicio de sesión exitoso
                  mostrarMensajeInicioSesion();
                  console.log("El capítulo del usuario es: " + capituloUsuario)
                }
              });
            } else if (correo.startsWith("academico_")) {
              // Si el correo empieza por "academico_", extraer el nombre del capítulo y asignarlo a capituloUsuario
              var inicio = "academico_";
              var fin = "@aneiap.co";
              var capitulo = correo.substring(inicio.length, correo.indexOf(fin));
              capituloUsuario = capitulo;
              // Mostrar mensaje de inicio de sesión exitoso
              mostrarMensajeInicioSesion();
            } else {
              // Si no se cumple ninguna de las condiciones anteriores, asignar valor "general" a capituloUsuario
              capituloUsuario = "nacional";
              // Mostrar mensaje de inicio de sesión exitoso
              mostrarMensajeInicioSesion();
            }
          } else {
            // Contraseña incorrecta, mostrar alerta de advertencia
            Swal.fire({
              title: "Contraseña incorrecta",
              text: "No diligenciaste correctamente la contraseña, revísala o consulta al administrador si la olvidaste.",
              icon: "warning",
              confirmButtonText: "Aceptar",
              imageUrl: "https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png",
              imageWidth: 120,
              imageHeight: 235,
            });
            // Actualizar el contenido del elemento saludoUsuario con el saludo genérico
            document.getElementById("saludoUsuario").innerText = "¡Hola, ANEIAPo!";
            // Vaciar los campos de correo y contraseña
            document.getElementById("correo").value = "";
            document.getElementById("contrasena").value = "";
          }
        } else {
          // El documento no existe, el correo no está registrado, mostrar alerta de error
          Swal.fire({
            title: "Correo no válido.",
            text: "Recuerda que para utilizar esta función de SIEA debes ser DCA o DNA. 🦉💚",
            icon: "error",
            confirmButtonText: "Aceptar",
            imageUrl: "https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png",
            imageWidth: 120,
            imageHeight: 235,
          });
          // Actualizar el contenido del elemento saludoUsuario con el saludo genérico
          document.getElementById("saludoUsuario").innerText = "¡Hola, ANEIAPo!";
        }
      }).catch((error) => {
        // Manejar errores, mostrar alerta de error
        Swal.fire({
          title: "Algo inesperado ha ocurrido con tu inicio de sesión, consulta al administrador o creador de SIEA para más información.",
          text: error.message,
          icon: "error",
        });
        // Actualizar el contenido del elemento saludoUsuario con el saludo genérico
        document.getElementById("saludoUsuario").innerText = "¡Hola, ANEIAPo!";
      });
    }

    // Función para convertir números en emojis
    function numeroAEmoji(numero) {
      if (numero < 10) {
        switch (numero) {
          case 0:
            return "0️⃣";
          case 1:
            return "1️⃣";
          case 2:
            return "2️⃣";
          case 3:
            return "3️⃣";
          case 4:
            return "4️⃣";
          case 5:
            return "5️⃣";
          case 6:
            return "6️⃣";
          case 7:
            return "7️⃣";
          case 8:
            return "8️⃣";
          case 9:
            return "9️⃣";
          default:
            return numero; // Si el número no está entre 0 y 9, devolver el mismo número
        }
      } else {
        // Obtener el primer dígito
        let primerDigito = Math.floor(numero / 10);
        // Obtener el segundo dígito
        let segundoDigito = numero % 10;
        // Convertir ambos dígitos a emojis
        let emojiPrimerDigito = numeroAEmoji(primerDigito);
        let emojiSegundoDigito = numeroAEmoji(segundoDigito);
        // Devolver ambos emojis concatenados
        return `${emojiPrimerDigito}${emojiSegundoDigito}`;
      }
    }

    function evaluarEspacio() {
      // Obtener los valores de los campos
      var nombreAsistente = document.getElementById("nombre-asistente").value;
      var telefonoAsistente = document.getElementById("telefono-asistente").value;
      var correoAsistente = document.getElementById("correo-asistente").value;
      var capituloEspacio = document.getElementById("capitulo-espacio").value;
      var nombreEspacio = document.getElementById("nombre-espacio").value;
      var pregunta1 = document.getElementById("pregunta1").value;
      var pregunta2 = document.getElementById("pregunta2").value;
      var pregunta3 = document.getElementById("pregunta3").value;
      var comentarios = document.getElementById("pregunta4").value;

      // Crear una lista para almacenar los nombres de los campos faltantes
      var camposFaltantes = [];

      // Verificar si cada campo está vacío y agregar su nombre a la lista si es el caso
      if (nombreAsistente.trim() === "") {
          camposFaltantes.push(" - Nombre del asistente");
      }
      if (telefonoAsistente.trim() === "") {
          camposFaltantes.push(" - Teléfono del asistente");
      }
      if (correoAsistente.trim() === "") {
          camposFaltantes.push(" - Correo del asistente");
      }
      if (capituloEspacio === "") {
          camposFaltantes.push(" - Capítulo que organizó el espacio");
      }
      if (nombreEspacio === "") {
          camposFaltantes.push(" - Nombre del espacio a evaluar");
      }
      if (pregunta1 === "") {
          camposFaltantes.push(" - Pregunta 1");
      }
      if (pregunta2 === "") {
          camposFaltantes.push(" - Pregunta 2");
      }
      if (pregunta3 === "") {
          camposFaltantes.push(" - Pregunta 3");
      }

      // Verificar si hay campos faltantes
      if (camposFaltantes.length > 0) {
          // Mostrar una alerta con los campos faltantes
          Swal.fire({
              icon: 'error',
              title: '¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!',
              text: 'Los siguientes campos son obligatorios y están vacíos:\n' + camposFaltantes.join('\n'),
              confirmButtonText: 'Aceptar',
              allowOutsideClick: true,
              backdrop: true,
              allowEscapeKey: true,
              imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
              imageWidth: 120, // Ancho de la imagen en píxeles
              imageHeight: 235, // Alto de la imagen en píxeles
              imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener el proceso de evaluación
      }

      // Si todos los campos están diligenciados, continuar con el proceso de evaluación
      // Actualizar la información del evento en la base de datos
      var reservasRef = firebase.firestore().collection("reservas");
      var eventoRef = reservasRef.where("capitulo", "==", capituloEspacio).where("nombreEvento", "==", nombreEspacio);

      eventoRef.get().then(function(querySnapshot) {
        querySnapshot.forEach(function(doc) {
            var data = doc.data();

            // Incrementar los contadores según las respuestas a las preguntas
            if (pregunta1 === "1" || pregunta1 === "2" || pregunta1 === "3" || pregunta1 === "4" || pregunta1 === "5" || pregunta1 === "6") {
                // Detractor
                data.detractores = (data.detractores || 0) + 1;
            } else if (pregunta1 === "7" || pregunta1 === "8") {
                // Pasivo
                data.pasivos = (data.pasivos || 0) + 1;
            } else {
                // Promotor
                data.promotores = (data.promotores || 0) + 1;
            }

            if (pregunta2 === "1" || pregunta2 === "2" || pregunta2 === "3" || pregunta2 === "4" || pregunta2 === "5" || pregunta2 === "6") {
                data.detractores = (data.detractores || 0) + 1;
            } else if (pregunta2 === "7" || pregunta2 === "8") {
                data.pasivos = (data.pasivos || 0) + 1;
            } else {
                data.promotores = (data.promotores || 0) + 1;
            }

            if (pregunta3 === "1" || pregunta3 === "2" || pregunta3 === "3" || pregunta3 === "4" || pregunta3 === "5" || pregunta3 === "6") {
                data.detractores = (data.detractores || 0) + 1;
            } else if (pregunta3 === "7" || pregunta3 === "8") {
                data.pasivos = (data.pasivos || 0) + 1;
            } else {
                data.promotores = (data.promotores || 0) + 1;
            }

            // Almacenar respuestas en los campos correspondientes
            data.respuestas1 = (data.respuestas1 || "") + pregunta1 + "|" ;
            data.respuestas2 = (data.respuestas2 || "") + pregunta2 + "|" ;
            data.respuestas3 = (data.respuestas3 || "") + pregunta3 + "|" ;

            // Actualizar comentarios y datos personales del asistente
            if (comentarios.trim() !== "") {
                data.comentarios = (data.comentarios || "") + comentarios + "|" ;
            } else {data.comentarios = (data.comentarios || "") + "Ninguno.|"}

            data.asistentes = (data.asistentes || "") + nombreAsistente + "|";
            data.correosAsistentes = (data.correosAsistentes || "") + correoAsistente + "|" ;
            data.telefonosAsistentes = (data.telefonosAsistentes || "") +  telefonoAsistente + "|" ;

            // Recalcular satisfacción
            console.log("Promotores:", data.promotores);
            console.log("Pasivos:", data.pasivos);
            console.log("Detractores:", data.detractores);
            var satisfaccion = (data.promotores - data.detractores) / (data.promotores + data.pasivos + data.detractores);
            console.log("La satisfacción es: " + satisfaccion)
            data.satisfaccion = satisfaccion;

            // Actualizar el evento en la base de datos
            reservasRef.doc(doc.id).set(data, { merge: true }).then(function() {
                // Mostrar mensaje de éxito
                Swal.fire({
                  icon: 'success',
                  title: '¡EVALUACIÓN ENVIADA CON ÉXITO!',
                  text: 'Gracias por tu evaluación.',
                  confirmButtonText: 'Aceptar',
                  allowOutsideClick: true,
                  backdrop: true,
                  allowEscapeKey: true,
                  imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
                  imageWidth: 120, // Ancho de la imagen en píxeles
                  imageHeight: 235, // Alto de la imagen en píxeles
                  imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                });
                // Reiniciar los campos del formulario que no son los 3 datos personales del asistente en caso de que quiera volver a llenar para otro espacio diferente.
                document.getElementById("capitulo-espacio").value = "";
                document.getElementById("nombre-espacio").value = "";
                document.getElementById("pregunta1").value = "";
                document.getElementById("pregunta2").value = "";
                document.getElementById("pregunta3").value = "";
                document.getElementById("pregunta4").value = "";
                var content = document.getElementById("acordeon4-content");
                content.style.display = "none";
                }).catch(function(error) {
                    console.error("Error actualizando el evento:", error);
                    // Mostrar mensaje de error
                    Swal.fire({
                        icon: 'error',
                        title: '¡ERROR AL ENVIAR LA EVALUACIÓN!',
                        text: 'Ocurrió un error al actualizar la información del evento. Por favor, intenta nuevamente.',
                        confirmButtonText: 'Aceptar'
                    });
                });
            });
        }).catch(function(error) {
            console.error("Error obteniendo el evento:", error);
            // Mostrar mensaje de error
            Swal.fire({
                icon: 'error',
                title: '¡ERROR AL OBTENER EL EVENTO!',
                text: 'Ocurrió un error al obtener la información del evento. Por favor, contáctate con el administrador.',
                confirmButtonText: 'Aceptar'
            });
        });

    }

    // Función para mostrar mensaje de inicio de sesión exitoso
    function mostrarMensajeInicioSesion() {
      Swal.fire({
        title: "Has iniciado sesión exitosamente. 🦉💚",
        text: "Disfruta de SIEA " + correoUsuario,
        icon: "success",
        confirmButtonText: "Aceptar",
        imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
        imageWidth: 120,
        imageHeight: 235,
      });
      // Actualizar el contenido del elemento saludoUsuario con el correo del usuario
      document.getElementById("saludoUsuario").innerText = "¡Hola, " + correoUsuario + "!";
    }

    function actualizarEspacio() {
    // Obtener los valores de los campos
    var totalAsistentes = document.getElementById("total-asistentes").value;
    var linkEvidencia = document.getElementById("link-evidencia").value;
    var nombreEspacio = document.getElementById("nombre-espacio-actualizar").value;
    var tipoEspacio = document.getElementById("tipo-espacio").value;
    var areaTrabajo = document.getElementById("area-trabajo").value;

    // Verificar si se han llenado todos los campos importantes
    if (!totalAsistentes || !linkEvidencia || !nombreEspacio || tipoEspacio === "" || areaTrabajo === "") {
        // Crear una lista para almacenar los nombres de los campos faltantes
        var camposFaltantes = [];

        // Verificar si cada campo está vacío y agregar su nombre a la lista si es el caso
        if (!totalAsistentes) {
            camposFaltantes.push(" - Total de asistentes");
        }
        if (!linkEvidencia) {
            camposFaltantes.push(" - Link de evidencia");
        }
        if (!nombreEspacio) {
            camposFaltantes.push(" - Nombre del espacio");
        }
        if (tipoEspacio === "") {
            camposFaltantes.push(" - Tipo de espacio");
        }
        if (areaTrabajo === "") {
            camposFaltantes.push(" - Área de trabajo");
        }

        // Mostrar una alerta con los campos faltantes
        Swal.fire({
            title: "¡NO HAS DILIGENCIADO TODOS LOS CAMPOS!",
            text: "Te falta por diligenciar los siguientes campos:\n" + camposFaltantes.join('\n'),
            icon: "error",
            confirmButtonText: "Aceptar",
            imageUrl: 'https://i.ibb.co/CBcrYmF/AVATAR-FALTANCAMPOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
        });
        return;
    }

    // Validación de datos
    if (isNaN(parseInt(totalAsistentes))) {
        Swal.fire({
            title: "¡Diligiencia bien el total de asistentes!",
            text: "El total de asistentes debe ser un número entero sin decimales.",
            icon: "error",
            confirmButtonText: "Aceptar",
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        return;
    }

    // Validación de enlace de evidencia
    var enlaceGoogleDrive = linkEvidencia;
    var enlaceGoogleDriveRegex = /^https:\/\/drive\.google\.com\/.*$/;
    if (!enlaceGoogleDriveRegex.test(enlaceGoogleDrive)) {
        Swal.fire({
            title: "¡Error!",
            text: "El enlace de evidencia debe ser un enlace válido de Google Drive.",
            icon: "error",
            confirmButtonText: "Aceptar",
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
        return;
    }

    // Actualizar la información del evento en la base de datos
    var reservasRef = firebase.firestore().collection("reservas");
    var consulta = reservasRef.where("capitulo", "==", capituloUsuario).where("nombreEvento", "==", nombreEspacio);

    consulta.get()
        .then(function(querySnapshot) {
            querySnapshot.forEach(function(doc) {
                doc.ref.update({
                    totalAsistentes: parseInt(totalAsistentes),
                    evidencia: linkEvidencia,
                    tipoEvento: tipoEspacio,
                    areaTrabajo: areaTrabajo
                }).then(function() {
                    Swal.fire({
                      title: "¡Se ha actualizado la información con éxito!",
                      text: "La información del espacio '" + nombreEspacio + "' se ha actualizado correctamente.",
                      icon: "success",
                      confirmButtonText: 'Aceptar',
                      allowOutsideClick: true,
                      backdrop: true,  
                      allowEscapeKey: true,
                      imageUrl: 'https://i.ibb.co/r31wpYT/AVATAR-EXITO-removebg-preview.png', // URL de la imagen
                      imageWidth: 120, // Ancho de la imagen en píxeles
                      imageHeight: 235, // Alto de la imagen en píxeles
                      imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
                    });
                }).catch(function(error) {
                    console.error("Error al actualizar el espacio:", error);
                    Swal.fire({
                        title: "¡Error!",
                        text: "Ha ocurrido un error al actualizar la información del espacio. Por favor, inténtalo de nuevo o comunícate con el administrador.",
                        icon: "error",
                        confirmButtonText: "Aceptar"
                    });
                });
            });
        })
        .catch(function(error) {
            console.error("Error al obtener el espacio:", error);
            Swal.fire({
                title: "¡Error!",
                text: "Ha ocurrido un error al obtener la información del espacio. Por favor, inténtalo de nuevo o comunícate con el administrador.",
                icon: "error",
                confirmButtonText: "Aceptar"
            });
        });
    }

    // Función para alternar la visibilidad de la tabla resumen y cambiar el texto del botón
    function toggleTablaResumen() {
      var tabla = document.getElementById("tabla-resumen");
      var boton = document.getElementById("toggleTablaResumen");
      var estado = document.getElementById("tablaResumenEstado");
      if (tabla.style.display === "none") {
        tabla.style.display = "block";
        boton.textContent = "Ocultar tabla resumen";
        estado.style.display = "none";
      } else {
        tabla.style.display = "none";
        boton.textContent = "Mostrar tabla resumen";
        estado.style.display = "block";
      }
    }

    // Función para alternar la visibilidad del dashboard estadístico y cambiar el texto del botón
    function toggleDashboard() {
        var dashboard = document.getElementById("estadisticas-container");
        var boton = document.getElementById("toggleDashboard");
        var estado = document.getElementById("dashboardEstado");
        var porcentajesContainer = document.getElementById("porcentajes-container");
        var satisfaccionContainer = document.getElementById("satisfaccion-container");
        var fechaInicial = document.getElementById("fecha-inicial").value;
        var fechaFinal = document.getElementById("fecha-final").value;

        if (dashboard.style.display === "none") {
            dashboard.style.display = "block";
            boton.textContent = "Ocultar dashboard";
            estado.style.display = "none";
            porcentajesContainer.style.display = "block"; // Mostrar contenedor de porcentajes
            satisfaccionContainer.style.display = "block"; // Mostrar contenedor de satisfacciones
        } else {
            dashboard.style.display = "none";
            boton.textContent = "Mostrar dashboard";
            estado.style.display = "block";
            porcentajesContainer.style.display = "none"; // Ocultar contenedor de porcentajes
            satisfaccionContainer.style.display = "none"; // Ocultar contenedor de satisfacciones
        }
    }

    // Función para generar los gráficos y actualizarlos dentro del acordeón 5
    async function generarGraficos() {
        console.log("Empezamos el proceso de graficación de metas y satisfacción");

        try {
            // Obtener datos necesarios para los gráficos desde Firebase
            // Consulta para obtener los eventos del capítulo dentro del rango de fechas
            var fechaInicial = document.getElementById("fecha-inicial").value;
            var fechaFinal = document.getElementById("fecha-final").value;
            var fechaHoy = new Date().toISOString().slice(0, 10);
            var reservasRef = firebase.firestore().collection("reservas");
            var consultaEventos = reservasRef.where("capitulo", "==", capituloUsuario)
                .where("fechaEvento", ">=", fechaInicial)
                .where("fechaEvento", "<=", fechaFinal);

            // Consulta para obtener las metas del capítulo
            var cuentasRef = firebase.firestore().collection("cuentas");
            var consultaMetas = cuentasRef.where("capitulo", "==", capituloUsuario);

            // Variables para almacenar los resultados
            var metaVA = 0; // Meta de Valor Agregado
            var metaEI = 0; // Meta de Entrenamiento Interno
            var totalVA = 0; // Total de Valor Agregado
            var totalEI = 0; // Total de Entrenamiento Interno

            // Realizar consultas
            var metasSnapshot = await consultaMetas.get();
            metasSnapshot.forEach(doc => {
                metaVA = parseInt(doc.data().metaVA);
                metaEI = parseInt(doc.data().metaEI);
            });

            // Calcular meta general
            var metaGeneral = metaVA + metaEI;

            var eventosSnapshot = await consultaEventos.get();

            eventosSnapshot.forEach(doc => {
                var tipoEvento = doc.data().tipoEvento;
                if (tipoEvento === "valor-agregado") {
                    totalVA++;
                } else if (tipoEvento === "entrenamiento-interno") {
                    totalEI++;
                }
            });

            // Calcular total general
            var totalGeneral = totalVA + totalEI;

            // Calcular porcentajes de cumplimiento de metas
            var porcentajeVACumplido = (totalVA / metaVA) * 100;
            var porcentajeEICumplido = (totalEI / metaEI) * 100;
            var porcentajeGeneralCumplido = (totalGeneral / metaGeneral) * 100;

            // Formatear porcentajes
            var porcentajeVAFormateado = porcentajeVACumplido.toFixed(2) + "%";
            var porcentajeEIFormateado = porcentajeEICumplido.toFixed(2) + "%";
            var porcentajeGeneralFormateado = porcentajeGeneralCumplido.toFixed(2) + "%";

            // Obtener el contenedor de los porcentajes
            var porcentajesContainer = document.getElementById("porcentajes-container");

            // Actualizar el contenido con los porcentajes formateados
            porcentajesContainer.innerHTML = "Alcanzado VA: " + porcentajeVAFormateado + " | Alcanzado EI: " + porcentajeEIFormateado + " | Avance formación: " + porcentajeGeneralFormateado;

            // Llamar función para que el gráfico de metas se actualice
            actualizarGraficoMetas(metaVA, metaEI, totalVA, totalEI, metaGeneral, totalGeneral);

            // Calcular promedios de satisfacción por área de trabajo
            var satisfaccionesPromedio = await calcularPromediosSatisfaccion(consultaEventos);

            // Llamar función para que el gráfico de satisfacción se actualice
            actualizarGraficoSatisfaccion(...satisfaccionesPromedio);

            var satisfaccionContainer = document.getElementById("satisfaccion-container");
            satisfaccionContainer.textContent = "Total espacios: " +
            " 💚" + (await consultaEventos.where("areaTrabajo", "==", "academico").get()).size +
            "|🩵" + (await consultaEventos.where("areaTrabajo", "==", "comunicaciones").get()).size +
            "|💛" + (await consultaEventos.where("areaTrabajo", "==", "desarrollo").get()).size +
            "|💜" + (await consultaEventos.where("areaTrabajo", "==", "finanzas").get()).size +
            "|❤️" + (await consultaEventos.where("areaTrabajo", "==", "mercadeo").get()).size +
            "|🧠" + (await consultaEventos.where("areaTrabajo", "==", "habilidades-duras").get()).size +
            "|🫂" + (await consultaEventos.where("areaTrabajo", "==", "habilidades-blandas").get()).size +
            "|💚💙" + (await consultaEventos.where("areaTrabajo", "==", "conocimiento-aneiap").get()).size +
            "|➕" + (await consultaEventos.where("tipoEvento", "==", "valor-agregado").get()).size +
            "|🏋🏻" + (await consultaEventos.where("tipoEvento", "==", "entrenamiento-interno").get()).size +
            "|n/a " + (await consultaEventos.where("tipoEvento", "==", "ninguno").get()).size;

        } catch (error) {
            console.error("Error al generar gráficos:", error);
        }
    }

    // Función para calcular promedios de satisfacción por área de trabajo
    async function calcularPromediosSatisfaccion(consultaEventos) {
        var consultasSatisfaccion = [
            consultaEventos.where("areaTrabajo", "==", "academico"),
            consultaEventos.where("areaTrabajo", "==", "comunicaciones"),
            consultaEventos.where("areaTrabajo", "==", "desarrollo"),
            consultaEventos.where("areaTrabajo", "==", "finanzas"),
            consultaEventos.where("areaTrabajo", "==", "mercadeo"),
            consultaEventos.where("areaTrabajo", "==", "habilidades-duras"),
            consultaEventos.where("areaTrabajo", "==", "habilidades-blandas"),
            consultaEventos.where("areaTrabajo", "==", "conocimiento-aneiap"),
            consultaEventos.where("tipoEvento", "==", "valor-agregado"),
            consultaEventos.where("tipoEvento", "==", "entrenamiento-interno"),
            consultaEventos.where("tipoEvento", "==", "ninguno")
        ];

        var promesasSatisfaccion = consultasSatisfaccion.map(async consulta => {
            var querySnapshot = await consulta.get();
            var totalSatisfaccion = 0;
            var totalEventos = querySnapshot.size;

            if (totalEventos > 0) {
                querySnapshot.forEach(doc => {
                    totalSatisfaccion += doc.data().satisfaccion;
                });
                console.log(totalSatisfaccion / totalEventos)
                return totalSatisfaccion / totalEventos;
            } else {
                console.log("no hay")
                return 0; // Asignar cero si no hay eventos
            }
        });

        return Promise.all(promesasSatisfaccion);
    }

    // Función para actualizar el gráfico de satisfacción
    function actualizarGraficoSatisfaccion(satisfaccionPromedioAcademico, satisfaccionPromedioComunicaciones, 
        satisfaccionPromedioDesarrollo, satisfaccionPromedioFinanzas, satisfaccionPromedioMercadeo, 
        satisfaccionPromedioHabilidadesDuras, satisfaccionPromedioHabilidadesBlandas, satisfaccionPromedioConocimientoAneiap,
        satisfaccionPromedioValorAgregado, satisfaccionPromedioEntrenamientoInterno, satisfaccionPromedioNinguno) 
    {
      // Datos para el gráfico de satisfacción
      var datosSatisfaccion = {
          labels: ['AC💚', 'CO🩵', 'DE💛', 'FI💜', 'ME❤️', 'HD🧠', 'HB🫂', 'CA💚💙', 'VA➕', 'EI🏋🏻', 'n/a'],
          datasets: [
              {
                  label: 'Satisfacción promedio por área',
                  backgroundColor: '#76c04e', // Verde para áreas
                  borderColor: 'rgba(50, 150, 50, 1)', // Bordes un poco más oscuros
                  pointBackgroundColor: 'rgba(30, 100, 30, 1)', // Puntos más oscuros
                  borderWidth: 2,
                  pointRadius: 5, // Tamaño de los puntos aumentado
                  data: [
                    satisfaccionPromedioAcademico, satisfaccionPromedioComunicaciones, satisfaccionPromedioDesarrollo,
                    satisfaccionPromedioFinanzas, satisfaccionPromedioMercadeo, satisfaccionPromedioHabilidadesDuras,
                    satisfaccionPromedioHabilidadesBlandas, satisfaccionPromedioConocimientoAneiap,
                    satisfaccionPromedioValorAgregado, satisfaccionPromedioEntrenamientoInterno, satisfaccionPromedioNinguno
                  ]
              },
              {
                  label: 'Satisfacción general',
                  borderColor: '#0d62ad', // Azul para promedio general
                  borderWidth: 2,
                  type: 'line',
                  fill: false,
                  data: []
              }
          ]
      };

      // Calcular el promedio general solo con las satisfacciones diferentes de cero
      var satisfacciones = [
        satisfaccionPromedioAcademico, satisfaccionPromedioComunicaciones, satisfaccionPromedioDesarrollo,
        satisfaccionPromedioFinanzas, satisfaccionPromedioMercadeo, satisfaccionPromedioHabilidadesDuras,
        satisfaccionPromedioHabilidadesBlandas, satisfaccionPromedioConocimientoAneiap,
        satisfaccionPromedioValorAgregado, satisfaccionPromedioEntrenamientoInterno, satisfaccionPromedioNinguno
      ];
      satisfacciones = satisfacciones.filter(satisfaccion => satisfaccion !== 0);
      var promedioGeneral = satisfacciones.reduce((total, satisfaccion) => total + satisfaccion, 0) / satisfacciones.length;

      // Llenar los datos de la línea de meta general
      datosSatisfaccion.datasets[1].data = Array(datosSatisfaccion.labels.length).fill(promedioGeneral);

      // Opciones del gráfico de satisfacción
      var opcionesSatisfaccion = {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true,
                      fontColor: 'rgba(0, 0, 0, 0.8)', // Color del texto en negrita
                      fontWeight: 'bold' // Texto en negrita
                  }
              }],
              xAxes: [{
                  ticks: {
                      fontColor: 'rgba(0, 0, 0, 0.8)', // Color del texto en negrita
                      fontWeight: 'bold' // Texto en negrita
                  }
              }]
          }
      };

      var ctxSatisfaccion = document.getElementById('grafico-satisfaccion').getContext('2d');
      var graficoSatisfaccion = new Chart(ctxSatisfaccion, {
          type: 'line',
          data: datosSatisfaccion,
          options: opcionesSatisfaccion
      });

        // Actualizar el gráfico
        graficoSatisfaccion.update();
    }

    // Función para actualizar el gráfico de cumplimiento de metas
    function actualizarGraficoMetas(metaVA, metaEI, totalVA, totalEI, metaGeneral, totalGeneral) {
      // Datos para el gráfico de metas
      var datosMetas = {
          labels: ['VALOR AGREGADO', 'ENTRENAMIENTO INTERNO', 'GENERAL'],
          datasets: [
              {
                  label: 'Metas planeadas',
                  backgroundColor: ['#76c04e', '#76c04e', '#76c04e'],
                  borderColor: 'rgba(50, 150, 50, 1)', // Bordes un poco más oscuros
                  borderWidth: 2, // Grosor del borde aumentado
                  data: [metaVA, metaEI, metaGeneral]
              },
              {
                  label: 'Total ejecutado',
                  backgroundColor: ['#0d62ad', '#0d62ad', '#0d62ad'],
                  borderColor: 'rgba(0, 50, 100, 1)', // Bordes un poco más oscuros
                  borderWidth: 2, // Grosor del borde aumentado
                  data: [totalVA, totalEI, totalGeneral]
              }
          ]
      };

      // Opciones del gráfico de metas
      var opcionesMetas = {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
          }
      };

      // Renderizar gráfico de metas
      var ctxMetas = document.getElementById('grafico-metas').getContext('2d');
      var graficoMetas = new Chart(ctxMetas, {
          type: 'bar',
          data: datosMetas,
          options: opcionesMetas
      });

      // Actualizar datos del gráfico
      graficoMetas.update();
    }

    // Función para alternar la visibilidad de la tabla de evaluaciones y cambiar el texto del botón
    function toggleEvaluaciones() {
      var tabla = document.getElementById("tabla-evaluaciones");
      var boton = document.getElementById("toggleEvaluaciones");
      var estadoTabla = document.getElementById("estadoTablaEvaluaciones");
      if (tabla.style.display === "none") {
        tabla.style.display = "block";
        boton.textContent = "Ocultar tabla de evaluaciones";
        estadoTabla.style.display = "none"; // Oculta el mensaje de estado
        consultarEvaluaciones();
      } else {
        tabla.style.display = "none";
        boton.textContent = "Mostrar tabla de evaluaciones";
        estadoTabla.style.display = "block"; // Muestra el mensaje de estado
      }
    }

    // Obtener los elementos de fecha inicial y final y agregar eventos change a los campos de fecha
    var fechaInicialEvaluacionesInput = document.getElementById("fecha-inicial-evaluaciones");
    var fechaFinalEvaluacionesInput = document.getElementById("fecha-final-evaluaciones");
    var nombreEspacioSelect = document.getElementById("nombre-espacio-consultar-evaluaciones");
    fechaInicialEvaluacionesInput.addEventListener("change", actualizarNombresEspaciosEvaluaciones);
    fechaFinalEvaluacionesInput.addEventListener("change", actualizarNombresEspaciosEvaluaciones);
    nombreEspacioSelect.addEventListener("change", consultarEvaluaciones);

    // Función para actualizar los nombres de los espacios según las fechas seleccionadas
    function actualizarNombresEspaciosEvaluaciones() {
        // Obtener las fechas seleccionadas
        var fechaInicial = fechaInicialEvaluacionesInput.value;
        var fechaFinal = fechaFinalEvaluacionesInput.value;
        console.log(fechaInicial)
        console.log(fechaFinal)

        // Verificar que ambas fechas estén seleccionadas
        if (fechaInicial && fechaFinal) {
            // Obtener la referencia a la colección de reservas
            var reservasRef = firebase.firestore().collection("reservas");
            // Crear la consulta para obtener los nombres de los espacios dentro del rango de fechas
            var consulta = reservasRef.where("fechaEvento", ">=", fechaInicial)
                                      .where("fechaEvento", "<=", fechaFinal)
                                      .where("capitulo", "==", capituloUsuario);

            // Ejecutar la consulta
            consulta.get()
                .then(function(querySnapshot) {
                    // Array para almacenar los nombres de los espacios
                    var nombresEspacios = [];

                    // Iterar sobre los resultados de la consulta
                    querySnapshot.forEach(function(doc) {
                        // Obtener el nombre del espacio y agregarlo al array
                        nombresEspacios.push(doc.data().nombreEvento);
                    });

                    // Llamar a la función para actualizar el desplegable con los nombres de los espacios obtenidos
                    actualizarDesplegableNombresEspaciosEvaluaciones(nombresEspacios);
                })
                .catch(function(error) {
                    // Manejar errores
                    console.error("Error al obtener nombres de espacios:", error);
                });
        }
    }

    // Función para actualizar el desplegable con los nombres de los espacios
    function actualizarDesplegableNombresEspaciosEvaluaciones(nombresEspacios) {
        // Obtener el desplegable de nombres de espacios
        var nombreEspacioSelect = document.getElementById("nombre-espacio-consultar-evaluaciones");

        // Limpiar opciones anteriores
        nombreEspacioSelect.innerHTML = "";

        // Ordenar los nombres de los espacios alfabéticamente
        nombresEspacios.sort();

        // Si hay nombres de espacios disponibles, agregar cada uno como opción en el desplegable
        if (nombresEspacios.length > 0) {
            nombresEspacios.forEach(function(nombre) {
                var option = document.createElement("option");
                option.text = nombre;
                option.value = nombre;
                nombreEspacioSelect.add(option);
            });
        } else {
            // Si no hay nombres de espacios disponibles, mostrar un mensaje indicando que no se encontraron espacios en el rango de fechas seleccionado
            var option = document.createElement("option");
            option.text = "No hay espacios disponibles en el rango de fechas seleccionado.";
            option.value = "";
            option.disabled = true;
            option.selected = true;
            nombreEspacioSelect.add(option);
        }
    }

    // Función para consultar las evaluaciones del evento seleccionado
    function consultarEvaluaciones() {
    // Obtener el nombre del evento seleccionado
    var nombreEvento = document.getElementById("nombre-espacio-consultar-evaluaciones").value;
    // Obtener las fechas seleccionadas
    var fechaInicial = document.getElementById("fecha-inicial-evaluaciones").value;
    var fechaFinal = document.getElementById("fecha-final-evaluaciones").value;

    // Realizar la consulta a Firebase para obtener las evaluaciones del evento seleccionado
    var reservasRef = firebase.firestore().collection("reservas");
    var consultaEvaluaciones = reservasRef.where("nombreEvento", "==", nombreEvento)
        .where("fechaEvento", ">=", fechaInicial)
        .where("fechaEvento", "<=", fechaFinal)
        .where("capitulo", "==", capituloUsuario);

    consultaEvaluaciones.get().then(function(querySnapshot) {
        var tablaBody = document.getElementById("tabla-evaluaciones").getElementsByTagName("tbody")[0];
        tablaBody.innerHTML = ""; // Limpiar el contenido actual de la tabla

        if (querySnapshot.empty) {
            // Si no hay datos, mostrar mensaje en lugar de la tabla
            var mensaje = document.createElement("tr");
            var mensajeCell = document.createElement("td");
            mensajeCell.setAttribute("colspan", "7"); // Colspan para ocupar todas las columnas
            mensajeCell.textContent = "No hay respuestas en la evaluación de satisfacción en este momento para el evento.";
            mensaje.appendChild(mensajeCell);
            tablaBody.appendChild(mensaje);
            var estadoTabla = document.getElementById("estadoTablaEvaluaciones");
            estadoTabla.style.display = "none"; // Oculta el mensaje de estado
        } else {
            // Si hay datos, construir la tabla
            querySnapshot.forEach(function(doc) {
                var data = doc.data();
                // Dividir las respuestas que están separadas por "|"
                var asistentes = data.asistentes.split("|");
                var correosAsistentes = data.correosAsistentes.split("|");
                var telefonosAsistentes = data.telefonosAsistentes.split("|");
                var respuestas1 = data.respuestas1.split("|");
                var respuestas2 = data.respuestas2.split("|");
                var respuestas3 = data.respuestas3.split("|");
                var comentarios = data.comentarios.split("|");

                // Insertar cada respuesta en una fila de la tabla
                for (var i = 0; i < asistentes.length - 1; i++) {
                    var fila = tablaBody.insertRow();
                    fila.insertCell(0).textContent = asistentes[i];
                    fila.insertCell(1).textContent = correosAsistentes[i];
                    fila.insertCell(2).textContent = telefonosAsistentes[i];
                    fila.insertCell(3).textContent = respuestas1[i];
                    fila.insertCell(4).textContent = respuestas2[i];
                    fila.insertCell(5).textContent = respuestas3[i];
                    fila.insertCell(6).textContent = comentarios[i];
                }
            });
        }
    }).catch(function(error) {
        console.error("Error al consultar las evaluaciones:", error);
    });
}

    // la función que cambia entre la evaluación de espacio y la evaluación de evento
    function alternarEvaluacion() {
      // Decirle al usuario que está en construcción la parte del CRM del evento
      Swal.fire({
            title: '¡𝐂𝐎𝐌𝐈𝐍𝐆 𝐒𝐎𝐎𝐍... 🛠️⚙️🧰!',
            text: 'Esta funcionalidad de SIEA (Evaluar eventos magnos, SCC, nacionales, etc.) por medio del CRM (Antes era un formulario de google) estará disponible 𝐌𝐔𝐘 𝐏𝐑𝐎𝐍𝐓𝐎, por ahora disfruta de la evaluación de espacios capitulares (capacitaciones, integraciones, etc.)',
            icon: 'warning',
            confirmButtonText: 'Aceptar',
            imageUrl: 'https://i.ibb.co/kJ6gs4J/AVATAR-VALIDACIONDATOS-removebg-preview.png', // URL de la imagen
            imageWidth: 120, // Ancho de la imagen en píxeles
            imageHeight: 235, // Alto de la imagen en píxeles
            imagePosition: 'top-start' // Posición de la imagen ('top-start', 'top', 'top-end', 'center', 'center-start', 'center-end', 'bottom-start', 'bottom', 'bottom-end')
          });
          return; // Detener la edición de la reserva
      // Obtener el contenedor de la evaluación de espacio
      const evaluarEspacio = document.getElementById("evaluar-espacio");
      // Obtener el contenedor de la evaluación de evento
      const evaluarEvento = document.getElementById("evaluar-evento");
      // Obtener el botón de alternar consulta
      const alternarBoton = document.querySelector(".alternarConsulta");

      // Obtener el estilo computado de evaluarEspacio
      const estiloEspacio = window.getComputedStyle(evaluarEspacio);
      // Obtener el estilo computado de evaluarEvento
      const estiloEvento = window.getComputedStyle(evaluarEvento);

      // Verificar el estado actual de los contenedores
      if (estiloEspacio.display === "block") {
          // Si el modo actual es espacio, cambiar a evento
          evaluarEspacio.style.display = "none";
          evaluarEvento.style.display = "block";
          // Cambiar el texto del botón
          alternarBoton.textContent = "Volver a la evaluación de espacios";
          consultarEventosCRM()
      } else {
          // Si el modo actual es evento, cambiar a espacio
          evaluarEspacio.style.display = "block";
          evaluarEvento.style.display = "none";
          // Cambiar el texto del botón
          alternarBoton.textContent = "Click aquí para evaluar el CRM de un evento.";
          consultarEventosCRM()
        }
    }

    // Función para consultar eventos en Firebase y actualizar el desplegable del CRM
    function consultarEventosCRM() {
      // Realizar la consulta a Firebase para obtener los eventos
      var reservasRef = firebase.firestore().collection("reservas");
      var consultaEventos = reservasRef.where("crm", "==", "si");

      // Limpiar las opciones actuales del desplegable
      var selectEvento = document.getElementById("evento-crm");
      selectEvento.innerHTML = '<option value="" disabled selected hidden>Selecciona un evento capitular/nacional</option>';

      // Obtener los nombres de los eventos y agregarlos como opciones al desplegable
      consultaEventos.get().then((querySnapshot) => {
          if (querySnapshot.empty) {
              // Si no se encontraron eventos, agregar una opción indicando que no hay eventos con CRM pendiente
              selectEvento.innerHTML = '<option value="">No hay ningún evento con CRM pendiente</option>';
          } else if (querySnapshot.size === 1) {
              // Si solo hay un evento, asignar automáticamente su valor al campo
              querySnapshot.forEach((doc) => {
                  var nombreEvento = doc.data().nombreEvento;
                  selectEvento.innerHTML = `<option value="${nombreEvento}" selected>${nombreEvento}</option>`;
              });
          } else {
              // Si se encontraron varios eventos, agregar cada evento como una opción en el desplegable
              querySnapshot.forEach((doc) => {
                  var capitulo = doc.data().capitulo.toUpperCase(); // Capítulo en mayúsculas
                  var nombreEvento = doc.data().nombreEvento; // Ajusta este campo según la estructura de tu base de datos
                  var option = document.createElement("option");
                  option.text = capitulo + " || " + nombreEvento;
                  option.value = nombreEvento; // Asignar el valor del nombre del evento como valor de la opción
                  selectEvento.add(option);
              });
          }
      }).catch((error) => {
          console.log("Error obteniendo eventos:", error);
      });
    }

  </script>

</body>
</html>
